{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":193},"end":{"line":193}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":193},"end":{"line":196}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":193},"end":{"line":202}}},"property":{"type":"Identifier","name":"controller"},"loc":{"start":{"line":193},"end":{"line":210}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":231},"end":{"line":231}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":231},"end":{"line":235}}},"property":{"type":"Identifier","name":"Collection"},"loc":{"start":{"line":231},"end":{"line":240}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":260},"end":{"line":260}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":260},"end":{"line":265}}},"property":{"type":"Identifier","name":"ServletContext"},"loc":{"start":{"line":260},"end":{"line":273}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":297},"end":{"line":297}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":297},"end":{"line":302}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":297},"end":{"line":310}}},"property":{"type":"Identifier","name":"HttpServletRequest"},"loc":{"start":{"line":297},"end":{"line":315}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":343},"end":{"line":343}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":343},"end":{"line":348}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":343},"end":{"line":356}}},"property":{"type":"Identifier","name":"HttpSession"},"loc":{"start":{"line":343},"end":{"line":361}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":382},"end":{"line":382}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":382},"end":{"line":385}}},"property":{"type":"Identifier","name":"commons"},"loc":{"start":{"line":382},"end":{"line":392}}},"property":{"type":"Identifier","name":"lang3"},"loc":{"start":{"line":382},"end":{"line":400}}},"property":{"type":"Identifier","name":"StringUtils"},"loc":{"start":{"line":382},"end":{"line":406}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":427},"end":{"line":427}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":427},"end":{"line":430}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":427},"end":{"line":436}}},"property":{"type":"Identifier","name":"application"},"loc":{"start":{"line":427},"end":{"line":444}}},"property":{"type":"Identifier","name":"Application"},"loc":{"start":{"line":427},"end":{"line":456}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":477},"end":{"line":477}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":477},"end":{"line":480}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":477},"end":{"line":486}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":477},"end":{"line":494}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":477},"end":{"line":502}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":522},"end":{"line":522}}},"property":{"type":"Identifier","name":"slf4j"},"loc":{"start":{"line":522},"end":{"line":525}}},"property":{"type":"Identifier","name":"Logger"},"loc":{"start":{"line":522},"end":{"line":531}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":547},"end":{"line":547}}},"property":{"type":"Identifier","name":"slf4j"},"loc":{"start":{"line":547},"end":{"line":550}}},"property":{"type":"Identifier","name":"LoggerFactory"},"loc":{"start":{"line":547},"end":{"line":556}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":579},"end":{"line":579}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":579},"end":{"line":582}}},"property":{"type":"Identifier","name":"beans"},"loc":{"start":{"line":579},"end":{"line":598}}},"property":{"type":"Identifier","name":"factory"},"loc":{"start":{"line":579},"end":{"line":604}}},"property":{"type":"Identifier","name":"annotation"},"loc":{"start":{"line":579},"end":{"line":612}}},"property":{"type":"Identifier","name":"Autowired"},"loc":{"start":{"line":579},"end":{"line":623}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":642},"end":{"line":642}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":642},"end":{"line":645}}},"property":{"type":"Identifier","name":"security"},"loc":{"start":{"line":642},"end":{"line":661}}},"property":{"type":"Identifier","name":"core"},"loc":{"start":{"line":642},"end":{"line":670}}},"property":{"type":"Identifier","name":"GrantedAuthority"},"loc":{"start":{"line":642},"end":{"line":675}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":701},"end":{"line":701}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":701},"end":{"line":704}}},"property":{"type":"Identifier","name":"security"},"loc":{"start":{"line":701},"end":{"line":720}}},"property":{"type":"Identifier","name":"core"},"loc":{"start":{"line":701},"end":{"line":729}}},"property":{"type":"Identifier","name":"context"},"loc":{"start":{"line":701},"end":{"line":734}}},"property":{"type":"Identifier","name":"SecurityContextHolder"},"loc":{"start":{"line":701},"end":{"line":742}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":773},"end":{"line":773}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":773},"end":{"line":776}}},"property":{"type":"Identifier","name":"stereotype"},"loc":{"start":{"line":773},"end":{"line":792}}},"property":{"type":"Identifier","name":"Controller"},"loc":{"start":{"line":773},"end":{"line":803}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":823},"end":{"line":823}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":823},"end":{"line":826}}},"property":{"type":"Identifier","name":"web"},"loc":{"start":{"line":823},"end":{"line":842}}},"property":{"type":"Identifier","name":"bind"},"loc":{"start":{"line":823},"end":{"line":846}}},"property":{"type":"Identifier","name":"annotation"},"loc":{"start":{"line":823},"end":{"line":851}}},"property":{"type":"Identifier","name":"RequestMapping"},"loc":{"start":{"line":823},"end":{"line":862}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":886},"end":{"line":886}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":886},"end":{"line":889}}},"property":{"type":"Identifier","name":"web"},"loc":{"start":{"line":886},"end":{"line":905}}},"property":{"type":"Identifier","name":"bind"},"loc":{"start":{"line":886},"end":{"line":909}}},"property":{"type":"Identifier","name":"annotation"},"loc":{"start":{"line":886},"end":{"line":914}}},"property":{"type":"Identifier","name":"RequestMethod"},"loc":{"start":{"line":886},"end":{"line":925}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":948},"end":{"line":948}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":948},"end":{"line":951}}},"property":{"type":"Identifier","name":"web"},"loc":{"start":{"line":948},"end":{"line":967}}},"property":{"type":"Identifier","name":"bind"},"loc":{"start":{"line":948},"end":{"line":971}}},"property":{"type":"Identifier","name":"annotation"},"loc":{"start":{"line":948},"end":{"line":976}}},"property":{"type":"Identifier","name":"RequestParam"},"loc":{"start":{"line":948},"end":{"line":987}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1009},"end":{"line":1009}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":1009},"end":{"line":1012}}},"property":{"type":"Identifier","name":"web"},"loc":{"start":{"line":1009},"end":{"line":1028}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":1009},"end":{"line":1032}}},"property":{"type":"Identifier","name":"ModelAndView"},"loc":{"start":{"line":1009},"end":{"line":1040}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"Start"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Controller","loc":{"start":{"line":1131},"end":{"line":1131}}},"arguments":[]}]},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"logger","vartype":{"type":"Identifier","name":"Logger","loc":{"start":{"line":1174},"end":{"line":1174}}}},"modifiers":{"type":"Modifiers","modifiers":["final"],"annotations":[]},"vartype":{"type":"Identifier","name":"Logger","loc":{"start":{"line":1174},"end":{"line":1174}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"LoggerFactory","loc":{"start":{"line":1190},"end":{"line":1190}}},"property":{"type":"Identifier","name":"getLogger"},"loc":{"start":{"line":1190},"end":{"line":1203}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"Start","loc":{"start":{"line":1214},"end":{"line":1214}}},"property":{"type":"Identifier","name":"class"},"loc":{"start":{"line":1214},"end":{"line":1219}}}],"loc":{"start":{"line":1190},"end":{"line":1213}}},"loc":{"start":{"line":1168},"end":{"line":1181}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"WELCOMED","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1254},"end":{"line":1254}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1254},"end":{"line":1254}}},"init":{"type":"Literal","value":"welcomed","raw":"welcomed","loc":{"start":{"line":1272},"end":{"line":1272}}},"loc":{"start":{"line":1233},"end":{"line":1261}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"servletContext","vartype":{"type":"Identifier","name":"ServletContext","loc":{"start":{"line":1312},"end":{"line":1312}}}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Autowired","loc":{"start":{"line":1290},"end":{"line":1290}}},"arguments":[]}]},"vartype":{"type":"Identifier","name":"ServletContext","loc":{"start":{"line":1312},"end":{"line":1312}}},"loc":{"start":{"line":1289},"end":{"line":1327}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"start"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"RequestMapping","loc":{"start":{"line":1660},"end":{"line":1660}}},"arguments":[{"type":"AssignmentExpression","left":{"type":"Identifier","name":"value","loc":{"start":{"line":1675},"end":{"line":1675}}},"right":{"type":"Literal","value":"start.mvc","raw":"start.mvc","loc":{"start":{"line":1683},"end":{"line":1683}}},"loc":{"start":{"line":1675},"end":{"line":1681}}},{"type":"AssignmentExpression","left":{"type":"Identifier","name":"method","loc":{"start":{"line":1696},"end":{"line":1696}}},"right":{"type":"ArrayExpression","elements":[{"type":"MemberExpression","object":{"type":"Identifier","name":"RequestMethod","loc":{"start":{"line":1706},"end":{"line":1706}}},"property":{"type":"Identifier","name":"GET"},"loc":{"start":{"line":1706},"end":{"line":1719}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"RequestMethod","loc":{"start":{"line":1725},"end":{"line":1725}}},"property":{"type":"Identifier","name":"POST"},"loc":{"start":{"line":1725},"end":{"line":1738}}}],"loc":{"start":{"line":1705},"end":{"line":1705}}},"loc":{"start":{"line":1696},"end":{"line":1703}}}]}]},"restype":{"type":"Identifier","name":"ModelAndView","loc":{"start":{"line":1757},"end":{"line":1757}}},"typarams":[],"params":[{"type":"Identifier","name":"request","vartype":{"type":"Identifier","name":"HttpServletRequest","loc":{"start":{"line":1776},"end":{"line":1776}}}},{"type":"Identifier","name":"error","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1865},"end":{"line":1865}}}},{"type":"Identifier","name":"logout","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1941},"end":{"line":1941}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"model","vartype":{"type":"Identifier","name":"ModelAndView","loc":{"start":{"line":1967},"end":{"line":1967}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ModelAndView","loc":{"start":{"line":1967},"end":{"line":1967}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ModelAndView","loc":{"start":{"line":1992},"end":{"line":1992}}},"arguments":[],"loc":{"start":{"line":1988},"end":{"line":1988}}},"loc":{"start":{"line":1967},"end":{"line":1980}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"checkWebSession","loc":{"start":{"line":2110},"end":{"line":2110}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":2126},"end":{"line":2126}}},"property":{"type":"Identifier","name":"getSession"},"loc":{"start":{"line":2126},"end":{"line":2133}}},"arguments":[],"loc":{"start":{"line":2126},"end":{"line":2144}}}],"loc":{"start":{"line":2110},"end":{"line":2125}}},"right":{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":2151},"end":{"line":2151}}},"loc":{"start":{"line":2110},"end":{"line":2148}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"model","loc":{"start":{"line":2172},"end":{"line":2172}}},"property":{"type":"Identifier","name":"setViewName"},"loc":{"start":{"line":2172},"end":{"line":2177}}},"arguments":[{"type":"Literal","value":"redirect:/login.mvc","raw":"redirect:/login.mvc","loc":{"start":{"line":2190},"end":{"line":2190}}}],"loc":{"start":{"line":2172},"end":{"line":2189}}},"loc":{"start":{"line":2172},"end":{"line":2172}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"model","loc":{"start":{"line":2233},"end":{"line":2233}}},"loc":{"start":{"line":2226},"end":{"line":2226}}}],"loc":{"start":{"line":2158},"end":{"line":2248}}},"loc":{"start":{"line":2106},"end":{"line":2106}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"role","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2258},"end":{"line":2258}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2258},"end":{"line":2258}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getRole","loc":{"start":{"line":2272},"end":{"line":2272}}},"arguments":[],"loc":{"start":{"line":2272},"end":{"line":2279}}},"loc":{"start":{"line":2258},"end":{"line":2265}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"user","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2291},"end":{"line":2291}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2291},"end":{"line":2291}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":2305},"end":{"line":2305}}},"property":{"type":"Identifier","name":"getUserPrincipal"},"loc":{"start":{"line":2305},"end":{"line":2312}}},"arguments":[],"loc":{"start":{"line":2305},"end":{"line":2329}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":2305},"end":{"line":2331}}},"arguments":[],"loc":{"start":{"line":2305},"end":{"line":2339}}},"loc":{"start":{"line":2291},"end":{"line":2298}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"model","loc":{"start":{"line":2351},"end":{"line":2351}}},"property":{"type":"Identifier","name":"addObject"},"loc":{"start":{"line":2351},"end":{"line":2356}}},"arguments":[{"type":"Literal","value":"role","raw":"role","loc":{"start":{"line":2367},"end":{"line":2367}}},{"type":"Identifier","name":"role","loc":{"start":{"line":2375},"end":{"line":2375}}}],"loc":{"start":{"line":2351},"end":{"line":2366}}},"loc":{"start":{"line":2351},"end":{"line":2351}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"model","loc":{"start":{"line":2390},"end":{"line":2390}}},"property":{"type":"Identifier","name":"addObject"},"loc":{"start":{"line":2390},"end":{"line":2395}}},"arguments":[{"type":"Literal","value":"user","raw":"user","loc":{"start":{"line":2406},"end":{"line":2406}}},{"type":"Identifier","name":"user","loc":{"start":{"line":2414},"end":{"line":2414}}}],"loc":{"start":{"line":2390},"end":{"line":2405}}},"loc":{"start":{"line":2390},"end":{"line":2390}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"contactEmail","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2430},"end":{"line":2430}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2430},"end":{"line":2430}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"servletContext","loc":{"start":{"line":2452},"end":{"line":2452}}},"property":{"type":"Identifier","name":"getInitParameter"},"loc":{"start":{"line":2452},"end":{"line":2466}}},"arguments":[{"type":"Literal","value":"email","raw":"email","loc":{"start":{"line":2484},"end":{"line":2484}}}],"loc":{"start":{"line":2452},"end":{"line":2483}}},"loc":{"start":{"line":2430},"end":{"line":2437}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"model","loc":{"start":{"line":2502},"end":{"line":2502}}},"property":{"type":"Identifier","name":"addObject"},"loc":{"start":{"line":2502},"end":{"line":2507}}},"arguments":[{"type":"Literal","value":"contactEmail","raw":"contactEmail","loc":{"start":{"line":2518},"end":{"line":2518}}},{"type":"Identifier","name":"contactEmail","loc":{"start":{"line":2534},"end":{"line":2534}}}],"loc":{"start":{"line":2502},"end":{"line":2517}}},"loc":{"start":{"line":2502},"end":{"line":2502}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"emailList","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2557},"end":{"line":2557}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2557},"end":{"line":2557}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"servletContext","loc":{"start":{"line":2576},"end":{"line":2576}}},"property":{"type":"Identifier","name":"getInitParameter"},"loc":{"start":{"line":2576},"end":{"line":2590}}},"arguments":[{"type":"Literal","value":"emaillist","raw":"emaillist","loc":{"start":{"line":2608},"end":{"line":2608}}}],"loc":{"start":{"line":2576},"end":{"line":2607}}},"loc":{"start":{"line":2557},"end":{"line":2564}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"model","loc":{"start":{"line":2630},"end":{"line":2630}}},"property":{"type":"Identifier","name":"addObject"},"loc":{"start":{"line":2630},"end":{"line":2635}}},"arguments":[{"type":"Literal","value":"emailList","raw":"emailList","loc":{"start":{"line":2646},"end":{"line":2646}}},{"type":"Identifier","name":"emailList","loc":{"start":{"line":2659},"end":{"line":2659}}}],"loc":{"start":{"line":2630},"end":{"line":2645}}},"loc":{"start":{"line":2630},"end":{"line":2630}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"app","vartype":{"type":"Identifier","name":"Application","loc":{"start":{"line":2680},"end":{"line":2680}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Application","loc":{"start":{"line":2680},"end":{"line":2680}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Application","loc":{"start":{"line":2698},"end":{"line":2698}}},"property":{"type":"Identifier","name":"getInstance"},"loc":{"start":{"line":2698},"end":{"line":2709}}},"arguments":[],"loc":{"start":{"line":2698},"end":{"line":2721}}},"loc":{"start":{"line":2680},"end":{"line":2692}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"logger","loc":{"start":{"line":2733},"end":{"line":2733}}},"property":{"type":"Identifier","name":"info"},"loc":{"start":{"line":2733},"end":{"line":2739}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Setting application properties: ","raw":"Setting application properties: ","loc":{"start":{"line":2745},"end":{"line":2745}}},"right":{"type":"Identifier","name":"app","loc":{"start":{"line":2782},"end":{"line":2782}}},"loc":{"start":{"line":2745},"end":{"line":2780}}}],"loc":{"start":{"line":2733},"end":{"line":2744}}},"loc":{"start":{"line":2733},"end":{"line":2733}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"model","loc":{"start":{"line":2796},"end":{"line":2796}}},"property":{"type":"Identifier","name":"addObject"},"loc":{"start":{"line":2796},"end":{"line":2801}}},"arguments":[{"type":"Literal","value":"version","raw":"version","loc":{"start":{"line":2812},"end":{"line":2812}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"app","loc":{"start":{"line":2823},"end":{"line":2823}}},"property":{"type":"Identifier","name":"getVersion"},"loc":{"start":{"line":2823},"end":{"line":2826}}},"arguments":[],"loc":{"start":{"line":2823},"end":{"line":2837}}}],"loc":{"start":{"line":2796},"end":{"line":2811}}},"loc":{"start":{"line":2796},"end":{"line":2796}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"model","loc":{"start":{"line":2850},"end":{"line":2850}}},"property":{"type":"Identifier","name":"addObject"},"loc":{"start":{"line":2850},"end":{"line":2855}}},"arguments":[{"type":"Literal","value":"build","raw":"build","loc":{"start":{"line":2866},"end":{"line":2866}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"app","loc":{"start":{"line":2875},"end":{"line":2875}}},"property":{"type":"Identifier","name":"getBuild"},"loc":{"start":{"line":2875},"end":{"line":2878}}},"arguments":[],"loc":{"start":{"line":2875},"end":{"line":2887}}}],"loc":{"start":{"line":2850},"end":{"line":2865}}},"loc":{"start":{"line":2850},"end":{"line":2850}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"model","loc":{"start":{"line":2951},"end":{"line":2951}}},"property":{"type":"Identifier","name":"setViewName"},"loc":{"start":{"line":2951},"end":{"line":2956}}},"arguments":[{"type":"Literal","value":"main_new","raw":"main_new","loc":{"start":{"line":2969},"end":{"line":2969}}}],"loc":{"start":{"line":2951},"end":{"line":2968}}},"loc":{"start":{"line":2951},"end":{"line":2951}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"model","loc":{"start":{"line":2997},"end":{"line":2997}}},"loc":{"start":{"line":2990},"end":{"line":2990}}}],"loc":{"start":{"line":1956},"end":{"line":3008}}},"code":"\n@RequestMapping(value \u003d \"start.mvc\", method \u003d {RequestMethod.GET, RequestMethod.POST})\npublic ModelAndView start(HttpServletRequest request, @RequestParam(value \u003d \"error\", required \u003d false)\nString error, @RequestParam(value \u003d \"logout\", required \u003d false)\nString logout) {\n    ModelAndView model \u003d new ModelAndView();\n    if (checkWebSession(request.getSession()) \u003d\u003d false) {\n        model.setViewName(\"redirect:/login.mvc\");\n        return model;\n    }\n    String role \u003d getRole();\n    String user \u003d request.getUserPrincipal().getName();\n    model.addObject(\"role\", role);\n    model.addObject(\"user\", user);\n    String contactEmail \u003d servletContext.getInitParameter(\"email\");\n    model.addObject(\"contactEmail\", contactEmail);\n    String emailList \u003d servletContext.getInitParameter(\"emaillist\");\n    model.addObject(\"emailList\", emailList);\n    Application app \u003d Application.getInstance();\n    logger.info(\"Setting application properties: \" + app);\n    model.addObject(\"version\", app.getVersion());\n    model.addObject(\"build\", app.getBuild());\n    model.setViewName(\"main_new\");\n    return model;\n}","loc":{"start":{"line":1659},"end":{"line":1770}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getRole"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":3023},"end":{"line":3023}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"authorities","vartype":{"type":"Identifier","name":"Collection","loc":{"start":{"line":3050},"end":{"line":3050}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Collection","loc":{"start":{"line":3050},"end":{"line":3050}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"Collection","loc":{"start":{"line":3094},"end":{"line":3094}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"SecurityContextHolder","loc":{"start":{"line":3124},"end":{"line":3124}}},"property":{"type":"Identifier","name":"getContext"},"loc":{"start":{"line":3124},"end":{"line":3145}}},"arguments":[],"loc":{"start":{"line":3124},"end":{"line":3156}}},"property":{"type":"Identifier","name":"getAuthentication"},"loc":{"start":{"line":3124},"end":{"line":3158}}},"arguments":[],"loc":{"start":{"line":3124},"end":{"line":3176}}},"property":{"type":"Identifier","name":"getAuthorities"},"loc":{"start":{"line":3124},"end":{"line":3178}}},"arguments":[],"loc":{"start":{"line":3124},"end":{"line":3193}}},"loc":{"start":{"line":3093},"end":{"line":3093}}},"loc":{"start":{"line":3050},"end":{"line":3079}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"role","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":3205},"end":{"line":3205}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":3205},"end":{"line":3205}}},"init":{"type":"Literal","value":"N/A","raw":"N/A","loc":{"start":{"line":3219},"end":{"line":3219}}},"loc":{"start":{"line":3205},"end":{"line":3212}}},{"type":"ForInStatement","left":{"type":"VariableDeclarator","id":{"type":"Identifier","name":"authority","vartype":{"type":"Identifier","name":"GrantedAuthority","loc":{"start":{"line":3239},"end":{"line":3239}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"GrantedAuthority","loc":{"start":{"line":3239},"end":{"line":3239}}},"loc":{"start":{"line":3239},"end":{"line":3256}}},"right":{"type":"Identifier","name":"authorities","loc":{"start":{"line":3268},"end":{"line":3268}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"authority","loc":{"start":{"line":3295},"end":{"line":3295}}},"property":{"type":"Identifier","name":"getAuthority"},"loc":{"start":{"line":3295},"end":{"line":3304}}},"arguments":[],"loc":{"start":{"line":3295},"end":{"line":3317}}},"loc":{"start":{"line":3295},"end":{"line":3295}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"role","loc":{"start":{"line":3333},"end":{"line":3333}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"authority","loc":{"start":{"line":3340},"end":{"line":3340}}},"property":{"type":"Identifier","name":"getAuthority"},"loc":{"start":{"line":3340},"end":{"line":3349}}},"arguments":[],"loc":{"start":{"line":3340},"end":{"line":3362}}},"loc":{"start":{"line":3333},"end":{"line":3338}}},"loc":{"start":{"line":3333},"end":{"line":3333}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"role","loc":{"start":{"line":3378},"end":{"line":3378}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"StringUtils","loc":{"start":{"line":3385},"end":{"line":3385}}},"property":{"type":"Identifier","name":"lowerCase"},"loc":{"start":{"line":3385},"end":{"line":3396}}},"arguments":[{"type":"Identifier","name":"role","loc":{"start":{"line":3407},"end":{"line":3407}}}],"loc":{"start":{"line":3385},"end":{"line":3406}}},"loc":{"start":{"line":3378},"end":{"line":3383}}},"loc":{"start":{"line":3378},"end":{"line":3378}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"role","loc":{"start":{"line":3426},"end":{"line":3426}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"StringUtils","loc":{"start":{"line":3433},"end":{"line":3433}}},"property":{"type":"Identifier","name":"remove"},"loc":{"start":{"line":3433},"end":{"line":3444}}},"arguments":[{"type":"Identifier","name":"role","loc":{"start":{"line":3452},"end":{"line":3452}}},{"type":"Literal","value":"role_","raw":"role_","loc":{"start":{"line":3458},"end":{"line":3458}}}],"loc":{"start":{"line":3433},"end":{"line":3451}}},"loc":{"start":{"line":3426},"end":{"line":3431}}},"loc":{"start":{"line":3426},"end":{"line":3426}}},{"type":"BreakStatement","loc":{"start":{"line":3480},"end":{"line":3480}}}],"loc":{"start":{"line":3281},"end":{"line":3495}}},"loc":{"start":{"line":3234},"end":{"line":3234}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"role","loc":{"start":{"line":3512},"end":{"line":3512}}},"loc":{"start":{"line":3505},"end":{"line":3505}}}],"loc":{"start":{"line":3040},"end":{"line":3522}}},"code":"\nprivate String getRole() {\n    Collection\u003cGrantedAuthority\u003e authorities \u003d (Collection\u003cGrantedAuthority\u003e)SecurityContextHolder.getContext().getAuthentication().getAuthorities();\n    String role \u003d \"N/A\";\n    for (GrantedAuthority authority : authorities) {\n        authority.getAuthority();\n        role \u003d authority.getAuthority();\n        role \u003d StringUtils.lowerCase(role);\n        role \u003d StringUtils.remove(role, \"role_\");\n        break;\n    }\n    return role;\n}","loc":{"start":{"line":3015},"end":{"line":3030}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"checkWebSession"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"session","vartype":{"type":"Identifier","name":"HttpSession","loc":{"start":{"line":3711},"end":{"line":3711}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"o","vartype":{"type":"Identifier","name":"Object","loc":{"start":{"line":3742},"end":{"line":3742}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Object","loc":{"start":{"line":3742},"end":{"line":3742}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":3753},"end":{"line":3753}}},"property":{"type":"Identifier","name":"getAttribute"},"loc":{"start":{"line":3753},"end":{"line":3760}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":3774},"end":{"line":3774}}},"property":{"type":"Identifier","name":"SESSION"},"loc":{"start":{"line":3774},"end":{"line":3784}}}],"loc":{"start":{"line":3753},"end":{"line":3773}}},"loc":{"start":{"line":3742},"end":{"line":3749}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"o","loc":{"start":{"line":3807},"end":{"line":3807}}},"right":{"type":"Literal","loc":{"start":{"line":3812},"end":{"line":3812}}},"loc":{"start":{"line":3807},"end":{"line":3809}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"logger","loc":{"start":{"line":3832},"end":{"line":3832}}},"property":{"type":"Identifier","name":"error"},"loc":{"start":{"line":3832},"end":{"line":3838}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"No valid WebSession object found, has session timed out? [","raw":"No valid WebSession object found, has session timed out? [","loc":{"start":{"line":3845},"end":{"line":3845}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":3908},"end":{"line":3908}}},"property":{"type":"Identifier","name":"getId"},"loc":{"start":{"line":3908},"end":{"line":3915}}},"arguments":[],"loc":{"start":{"line":3908},"end":{"line":3921}}},"loc":{"start":{"line":3845},"end":{"line":3906}}},"right":{"type":"Literal","value":"]","raw":"]","loc":{"start":{"line":3926},"end":{"line":3926}}},"loc":{"start":{"line":3845},"end":{"line":3924}}}],"loc":{"start":{"line":3832},"end":{"line":3844}}},"loc":{"start":{"line":3832},"end":{"line":3832}}},{"type":"ReturnStatement","argument":{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":3951},"end":{"line":3951}}},"loc":{"start":{"line":3944},"end":{"line":3944}}}],"loc":{"start":{"line":3818},"end":{"line":3966}}},"loc":{"start":{"line":3803},"end":{"line":3803}}},{"type":"IfStatement","test":{"argument":{"type":"TypeTest","expression":{"type":"Identifier","name":"o","loc":{"start":{"line":3982},"end":{"line":3982}}},"clazz":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":3995},"end":{"line":3995}}},"loc":{"start":{"line":3982},"end":{"line":3984}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":3980},"end":{"line":3980}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"logger","loc":{"start":{"line":4022},"end":{"line":4022}}},"property":{"type":"Identifier","name":"error"},"loc":{"start":{"line":4022},"end":{"line":4028}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Invalid WebSession object found, this is probably a bug! [","raw":"Invalid WebSession object found, this is probably a bug! [","loc":{"start":{"line":4035},"end":{"line":4035}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"o","loc":{"start":{"line":4098},"end":{"line":4098}}},"property":{"type":"Identifier","name":"getClass"},"loc":{"start":{"line":4098},"end":{"line":4099}}},"arguments":[],"loc":{"start":{"line":4098},"end":{"line":4108}}},"loc":{"start":{"line":4035},"end":{"line":4096}}},"right":{"type":"Literal","value":" | ","raw":" | ","loc":{"start":{"line":4113},"end":{"line":4113}}},"loc":{"start":{"line":4035},"end":{"line":4111}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":4121},"end":{"line":4121}}},"property":{"type":"Identifier","name":"getId"},"loc":{"start":{"line":4121},"end":{"line":4128}}},"arguments":[],"loc":{"start":{"line":4121},"end":{"line":4134}}},"loc":{"start":{"line":4035},"end":{"line":4119}}},"right":{"type":"Literal","value":"]","raw":"]","loc":{"start":{"line":4139},"end":{"line":4139}}},"loc":{"start":{"line":4035},"end":{"line":4137}}}],"loc":{"start":{"line":4022},"end":{"line":4034}}},"loc":{"start":{"line":4022},"end":{"line":4022}}},{"type":"ReturnStatement","argument":{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":4164},"end":{"line":4164}}},"loc":{"start":{"line":4157},"end":{"line":4157}}}],"loc":{"start":{"line":4008},"end":{"line":4179}}},"loc":{"start":{"line":3976},"end":{"line":3976}}},{"type":"ReturnStatement","argument":{"type":"Literal","value":1,"raw":1,"loc":{"start":{"line":4196},"end":{"line":4196}}},"loc":{"start":{"line":4189},"end":{"line":4189}}}],"loc":{"start":{"line":3732},"end":{"line":4206}}},"code":"\npublic boolean checkWebSession(HttpSession session) {\n    Object o \u003d session.getAttribute(WebSession.SESSION);\n    if (o \u003d\u003d null) {\n        logger.error(\"No valid WebSession object found, has session timed out? [\" + session.getId() + \"]\");\n        return false;\n    }\n    if (!(o instanceof WebSession)) {\n        logger.error(\"Invalid WebSession object found, this is probably a bug! [\" + o.getClass() + \" | \" + session.getId() + \"]\");\n        return false;\n    }\n    return true;\n}","loc":{"start":{"line":3680},"end":{"line":3695}}}],"loc":{"start":{"line":1130},"end":{"line":1149}}}],"loc":{"start":{"line":185},"end":{"line":185}}}