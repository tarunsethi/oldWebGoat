{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":8},"end":{"line":11}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":8},"end":{"line":17}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":35},"end":{"line":35}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":35},"end":{"line":38}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":35},"end":{"line":44}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":35},"end":{"line":52}}},"property":{"type":"Identifier","name":"AbstractLesson"},"loc":{"start":{"line":35},"end":{"line":60}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":84},"end":{"line":84}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":84},"end":{"line":87}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":84},"end":{"line":93}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":84},"end":{"line":101}}},"property":{"type":"Identifier","name":"WelcomeScreen"},"loc":{"start":{"line":84},"end":{"line":109}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":132},"end":{"line":132}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":132},"end":{"line":135}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":132},"end":{"line":141}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":132},"end":{"line":149}}},"property":{"type":"Identifier","name":"admin"},"loc":{"start":{"line":132},"end":{"line":157}}},"property":{"type":"Identifier","name":"WelcomeAdminScreen"},"loc":{"start":{"line":132},"end":{"line":163}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":191},"end":{"line":191}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":191},"end":{"line":194}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":191},"end":{"line":200}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":191},"end":{"line":208}}},"property":{"type":"Identifier","name":"Course"},"loc":{"start":{"line":191},"end":{"line":216}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":232},"end":{"line":232}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":232},"end":{"line":235}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":232},"end":{"line":241}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":232},"end":{"line":249}}},"property":{"type":"Identifier","name":"ErrorScreen"},"loc":{"start":{"line":232},"end":{"line":257}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":278},"end":{"line":278}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":278},"end":{"line":281}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":278},"end":{"line":287}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":278},"end":{"line":295}}},"property":{"type":"Identifier","name":"Screen"},"loc":{"start":{"line":278},"end":{"line":303}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":319},"end":{"line":319}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":319},"end":{"line":322}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":319},"end":{"line":328}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":319},"end":{"line":336}}},"property":{"type":"Identifier","name":"UserTracker"},"loc":{"start":{"line":319},"end":{"line":344}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":365},"end":{"line":365}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":365},"end":{"line":368}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":365},"end":{"line":374}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":365},"end":{"line":382}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":365},"end":{"line":390}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":410},"end":{"line":410}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":410},"end":{"line":413}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":410},"end":{"line":419}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":410},"end":{"line":427}}},"property":{"type":"Identifier","name":"WebgoatContext"},"loc":{"start":{"line":410},"end":{"line":435}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":459},"end":{"line":459}}},"property":{"type":"Identifier","name":"slf4j"},"loc":{"start":{"line":459},"end":{"line":462}}},"property":{"type":"Identifier","name":"Logger"},"loc":{"start":{"line":459},"end":{"line":468}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":484},"end":{"line":484}}},"property":{"type":"Identifier","name":"slf4j"},"loc":{"start":{"line":484},"end":{"line":487}}},"property":{"type":"Identifier","name":"LoggerFactory"},"loc":{"start":{"line":484},"end":{"line":493}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":517},"end":{"line":517}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":517},"end":{"line":522}}},"property":{"type":"Identifier","name":"ServletContext"},"loc":{"start":{"line":517},"end":{"line":530}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":554},"end":{"line":554}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":554},"end":{"line":559}}},"property":{"type":"Identifier","name":"ServletException"},"loc":{"start":{"line":554},"end":{"line":567}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":593},"end":{"line":593}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":593},"end":{"line":598}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":593},"end":{"line":606}}},"property":{"type":"Identifier","name":"HttpServlet"},"loc":{"start":{"line":593},"end":{"line":611}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":632},"end":{"line":632}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":632},"end":{"line":637}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":632},"end":{"line":645}}},"property":{"type":"Identifier","name":"HttpServletRequest"},"loc":{"start":{"line":632},"end":{"line":650}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":678},"end":{"line":678}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":678},"end":{"line":683}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":678},"end":{"line":691}}},"property":{"type":"Identifier","name":"HttpServletResponse"},"loc":{"start":{"line":678},"end":{"line":696}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":725},"end":{"line":725}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":725},"end":{"line":730}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":725},"end":{"line":738}}},"property":{"type":"Identifier","name":"HttpSession"},"loc":{"start":{"line":725},"end":{"line":743}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":764},"end":{"line":764}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":764},"end":{"line":768}}},"property":{"type":"Identifier","name":"IOException"},"loc":{"start":{"line":764},"end":{"line":771}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":792},"end":{"line":792}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":792},"end":{"line":796}}},"property":{"type":"Identifier","name":"PrintWriter"},"loc":{"start":{"line":792},"end":{"line":799}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":820},"end":{"line":820}}},"property":{"type":"Identifier","name":"text"},"loc":{"start":{"line":820},"end":{"line":824}}},"property":{"type":"Identifier","name":"SimpleDateFormat"},"loc":{"start":{"line":820},"end":{"line":829}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":855},"end":{"line":855}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":855},"end":{"line":859}}},"property":{"type":"Identifier","name":"Date"},"loc":{"start":{"line":855},"end":{"line":864}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":878},"end":{"line":878}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":878},"end":{"line":882}}},"property":{"type":"Identifier","name":"Locale"},"loc":{"start":{"line":878},"end":{"line":887}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":903},"end":{"line":903}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":903},"end":{"line":907}}},"property":{"type":"Identifier","name":"TimeZone"},"loc":{"start":{"line":903},"end":{"line":912}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"HammerHead"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"HttpServlet","loc":{"start":{"line":2405},"end":{"line":2405}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"logger","vartype":{"type":"Identifier","name":"Logger","loc":{"start":{"line":2430},"end":{"line":2430}}}},"modifiers":{"type":"Modifiers","modifiers":["final"],"annotations":[]},"vartype":{"type":"Identifier","name":"Logger","loc":{"start":{"line":2430},"end":{"line":2430}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"LoggerFactory","loc":{"start":{"line":2446},"end":{"line":2446}}},"property":{"type":"Identifier","name":"getLogger"},"loc":{"start":{"line":2446},"end":{"line":2459}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"HammerHead","loc":{"start":{"line":2470},"end":{"line":2470}}},"property":{"type":"Identifier","name":"class"},"loc":{"start":{"line":2470},"end":{"line":2480}}}],"loc":{"start":{"line":2446},"end":{"line":2469}}},"loc":{"start":{"line":2424},"end":{"line":2437}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"WELCOMED","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2515},"end":{"line":2515}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2515},"end":{"line":2515}}},"init":{"type":"Literal","value":"welcomed","raw":"welcomed","loc":{"start":{"line":2533},"end":{"line":2533}}},"loc":{"start":{"line":2494},"end":{"line":2522}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"serialVersionUID","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"Literal","value":645640331343188020,"raw":645640331343188020,"loc":{"start":{"line":2618},"end":{"line":2618}}},"loc":{"start":{"line":2573},"end":{"line":2599}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"httpDateFormat","vartype":{"type":"Identifier","name":"SimpleDateFormat","loc":{"start":{"line":2709},"end":{"line":2709}}}},"modifiers":{"type":"Modifiers","modifiers":["protected","static"],"annotations":[]},"vartype":{"type":"Identifier","name":"SimpleDateFormat","loc":{"start":{"line":2709},"end":{"line":2709}}},"loc":{"start":{"line":2692},"end":{"line":2726}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"sessionTimeoutSeconds","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"BinaryExpression","operator":"MULTIPLY","left":{"type":"BinaryExpression","operator":"MULTIPLY","left":{"type":"BinaryExpression","operator":"MULTIPLY","left":{"type":"Literal","value":60,"raw":60,"loc":{"start":{"line":2856},"end":{"line":2856}}},"right":{"type":"Literal","value":60,"raw":60,"loc":{"start":{"line":2861},"end":{"line":2861}}},"loc":{"start":{"line":2856},"end":{"line":2859}}},"right":{"type":"Literal","value":24,"raw":24,"loc":{"start":{"line":2866},"end":{"line":2866}}},"loc":{"start":{"line":2856},"end":{"line":2864}}},"right":{"type":"Literal","value":2,"raw":2,"loc":{"start":{"line":2871},"end":{"line":2871}}},"loc":{"start":{"line":2856},"end":{"line":2869}}},"loc":{"start":{"line":2807},"end":{"line":2832}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"propertiesPath","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2996},"end":{"line":2996}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2996},"end":{"line":2996}}},"init":{"type":"Literal","loc":{"start":{"line":3020},"end":{"line":3020}}},"loc":{"start":{"line":2982},"end":{"line":3003}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"webgoatContext","vartype":{"type":"Identifier","name":"WebgoatContext","loc":{"start":{"line":3152},"end":{"line":3152}}}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"vartype":{"type":"Identifier","name":"WebgoatContext","loc":{"start":{"line":3152},"end":{"line":3152}}},"init":{"type":"Literal","loc":{"start":{"line":3184},"end":{"line":3184}}},"loc":{"start":{"line":3144},"end":{"line":3167}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"doGet"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Override","loc":{"start":{"line":3396},"end":{"line":3396}}},"arguments":[]}]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"request","vartype":{"type":"Identifier","name":"HttpServletRequest","loc":{"start":{"line":3427},"end":{"line":3427}}}},{"type":"Identifier","name":"response","vartype":{"type":"Identifier","name":"HttpServletResponse","loc":{"start":{"line":3455},"end":{"line":3455}}}}],"thrown":[{"type":"Identifier","name":"IOException","loc":{"start":{"line":3492},"end":{"line":3492}}},{"type":"Identifier","name":"ServletException","loc":{"start":{"line":3505},"end":{"line":3505}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"doPost","loc":{"start":{"line":3532},"end":{"line":3532}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":3539},"end":{"line":3539}}},{"type":"Identifier","name":"response","loc":{"start":{"line":3548},"end":{"line":3548}}}],"loc":{"start":{"line":3532},"end":{"line":3538}}},"loc":{"start":{"line":3532},"end":{"line":3532}}}],"loc":{"start":{"line":3522},"end":{"line":3563}}},"code":"\n@Override()\npublic void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {\n    doPost(request, response);\n}","loc":{"start":{"line":3395},"end":{"line":3421}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"doPost"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Override","loc":{"start":{"line":3771},"end":{"line":3771}}},"arguments":[]}]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"request","vartype":{"type":"Identifier","name":"HttpServletRequest","loc":{"start":{"line":3803},"end":{"line":3803}}}},{"type":"Identifier","name":"response","vartype":{"type":"Identifier","name":"HttpServletResponse","loc":{"start":{"line":3831},"end":{"line":3831}}}}],"thrown":[{"type":"Identifier","name":"IOException","loc":{"start":{"line":3868},"end":{"line":3868}}},{"type":"Identifier","name":"ServletException","loc":{"start":{"line":3881},"end":{"line":3881}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"screen","vartype":{"type":"Identifier","name":"Screen","loc":{"start":{"line":3908},"end":{"line":3908}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Screen","loc":{"start":{"line":3908},"end":{"line":3908}}},"init":{"type":"Literal","loc":{"start":{"line":3924},"end":{"line":3924}}},"loc":{"start":{"line":3908},"end":{"line":3915}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"mySession","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":3939},"end":{"line":3939}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":3939},"end":{"line":3939}}},"init":{"type":"Literal","loc":{"start":{"line":3962},"end":{"line":3962}}},"loc":{"start":{"line":3939},"end":{"line":3950}}},{"type":"TryStatement","finalizer":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"thr","vartype":{"type":"Identifier","name":"Throwable","loc":{"start":{"line":7800},"end":{"line":7800}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"logger","loc":{"start":{"line":7833},"end":{"line":7833}}},"property":{"type":"Identifier","name":"error"},"loc":{"start":{"line":7833},"end":{"line":7839}}},"arguments":[{"type":"Literal","value":"Could not write error screen","raw":"Could not write error screen","loc":{"start":{"line":7846},"end":{"line":7846}}},{"type":"Identifier","name":"thr","loc":{"start":{"line":7878},"end":{"line":7878}}}],"loc":{"start":{"line":7833},"end":{"line":7845}}},"loc":{"start":{"line":7833},"end":{"line":7833}}}],"loc":{"start":{"line":7815},"end":{"line":7896}}},"loc":{"start":{"line":7793},"end":{"line":7793}}}],"block":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"TypeTest","expression":{"type":"Identifier","name":"screen","loc":{"start":{"line":7661},"end":{"line":7661}}},"clazz":{"type":"Identifier","name":"ErrorScreen","loc":{"start":{"line":7679},"end":{"line":7679}}},"loc":{"start":{"line":7661},"end":{"line":7668}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"writeScreen"},"loc":{"start":{"line":7714},"end":{"line":7718}}},"arguments":[{"type":"Identifier","name":"mySession","loc":{"start":{"line":7731},"end":{"line":7731}}},{"type":"Identifier","name":"screen","loc":{"start":{"line":7742},"end":{"line":7742}}},{"type":"Identifier","name":"response","loc":{"start":{"line":7750},"end":{"line":7750}}}],"loc":{"start":{"line":7714},"end":{"line":7730}}},"loc":{"start":{"line":7714},"end":{"line":7714}}}],"loc":{"start":{"line":7692},"end":{"line":7777}}},"loc":{"start":{"line":7657},"end":{"line":7657}}}],"loc":{"start":{"line":7639},"end":{"line":7791}}},"loc":{"start":{"line":7635},"end":{"line":7896}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":7910},"end":{"line":7910}}},"property":{"type":"Identifier","name":"returnConnection"},"loc":{"start":{"line":7910},"end":{"line":7920}}},"arguments":[{"type":"Identifier","name":"mySession","loc":{"start":{"line":7938},"end":{"line":7938}}}],"loc":{"start":{"line":7910},"end":{"line":7937}}},"loc":{"start":{"line":7910},"end":{"line":7910}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"logger","loc":{"start":{"line":7962},"end":{"line":7962}}},"property":{"type":"Identifier","name":"debug"},"loc":{"start":{"line":7962},"end":{"line":7968}}},"arguments":[{"type":"Literal","value":"Leaving doPost: ","raw":"Leaving doPost: ","loc":{"start":{"line":7975},"end":{"line":7975}}}],"loc":{"start":{"line":7962},"end":{"line":7974}}},"loc":{"start":{"line":7962},"end":{"line":7962}}}],"loc":{"start":{"line":7621},"end":{"line":8004}}},"handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"t","vartype":{"type":"Identifier","name":"Throwable","loc":{"start":{"line":7493},"end":{"line":7493}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"logger","loc":{"start":{"line":7520},"end":{"line":7520}}},"property":{"type":"Identifier","name":"error"},"loc":{"start":{"line":7520},"end":{"line":7526}}},"arguments":[{"type":"Literal","value":"Error handling request","raw":"Error handling request","loc":{"start":{"line":7533},"end":{"line":7533}}},{"type":"Identifier","name":"t","loc":{"start":{"line":7559},"end":{"line":7559}}}],"loc":{"start":{"line":7520},"end":{"line":7532}}},"loc":{"start":{"line":7520},"end":{"line":7520}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"screen","loc":{"start":{"line":7563},"end":{"line":7563}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ErrorScreen","loc":{"start":{"line":7576},"end":{"line":7576}}},"arguments":[{"type":"Identifier","name":"mySession","loc":{"start":{"line":7588},"end":{"line":7588}}},{"type":"Identifier","name":"t","loc":{"start":{"line":7599},"end":{"line":7599}}}],"loc":{"start":{"line":7572},"end":{"line":7572}}},"loc":{"start":{"line":7563},"end":{"line":7570}}},"loc":{"start":{"line":7563},"end":{"line":7563}}}],"loc":{"start":{"line":7506},"end":{"line":7611}}},"loc":{"start":{"line":7486},"end":{"line":7486}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"logger","loc":{"start":{"line":3994},"end":{"line":3994}}},"property":{"type":"Identifier","name":"debug"},"loc":{"start":{"line":3994},"end":{"line":4000}}},"arguments":[{"type":"Literal","value":"Entering doPost","raw":"Entering doPost","loc":{"start":{"line":4007},"end":{"line":4007}}}],"loc":{"start":{"line":3994},"end":{"line":4006}}},"loc":{"start":{"line":3994},"end":{"line":3994}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"logger","loc":{"start":{"line":4039},"end":{"line":4039}}},"property":{"type":"Identifier","name":"debug"},"loc":{"start":{"line":4039},"end":{"line":4045}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"request: ","raw":"request: ","loc":{"start":{"line":4052},"end":{"line":4052}}},"right":{"type":"Identifier","name":"request","loc":{"start":{"line":4066},"end":{"line":4066}}},"loc":{"start":{"line":4052},"end":{"line":4064}}}],"loc":{"start":{"line":4039},"end":{"line":4051}}},"loc":{"start":{"line":4039},"end":{"line":4039}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"logger","loc":{"start":{"line":4088},"end":{"line":4088}}},"property":{"type":"Identifier","name":"debug"},"loc":{"start":{"line":4088},"end":{"line":4094}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"principle: ","raw":"principle: ","loc":{"start":{"line":4101},"end":{"line":4101}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":4117},"end":{"line":4117}}},"property":{"type":"Identifier","name":"getUserPrincipal"},"loc":{"start":{"line":4117},"end":{"line":4124}}},"arguments":[],"loc":{"start":{"line":4117},"end":{"line":4141}}},"loc":{"start":{"line":4101},"end":{"line":4115}}}],"loc":{"start":{"line":4088},"end":{"line":4100}}},"loc":{"start":{"line":4088},"end":{"line":4088}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"context","vartype":{"type":"Identifier","name":"ServletContext","loc":{"start":{"line":4203},"end":{"line":4203}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ServletContext","loc":{"start":{"line":4203},"end":{"line":4203}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getServletContext","loc":{"start":{"line":4228},"end":{"line":4228}}},"arguments":[],"loc":{"start":{"line":4228},"end":{"line":4245}}},"loc":{"start":{"line":4203},"end":{"line":4218}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"mySession","loc":{"start":{"line":4387},"end":{"line":4387}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"updateSession","loc":{"start":{"line":4399},"end":{"line":4399}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":4413},"end":{"line":4413}}},{"type":"Identifier","name":"response","loc":{"start":{"line":4422},"end":{"line":4422}}},{"type":"Identifier","name":"context","loc":{"start":{"line":4432},"end":{"line":4432}}}],"loc":{"start":{"line":4399},"end":{"line":4412}}},"loc":{"start":{"line":4387},"end":{"line":4397}}},"loc":{"start":{"line":4387},"end":{"line":4387}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":4471},"end":{"line":4471}}},"property":{"type":"Identifier","name":"isCommitted"},"loc":{"start":{"line":4471},"end":{"line":4479}}},"arguments":[],"loc":{"start":{"line":4471},"end":{"line":4491}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"logger","loc":{"start":{"line":4513},"end":{"line":4513}}},"property":{"type":"Identifier","name":"debug"},"loc":{"start":{"line":4513},"end":{"line":4519}}},"arguments":[{"type":"Literal","value":"Response already committed, exiting","raw":"Response already committed, exiting","loc":{"start":{"line":4526},"end":{"line":4526}}}],"loc":{"start":{"line":4513},"end":{"line":4525}}},"loc":{"start":{"line":4513},"end":{"line":4513}}},{"type":"ReturnStatement","loc":{"start":{"line":4582},"end":{"line":4582}}}],"loc":{"start":{"line":4495},"end":{"line":4602}}},"loc":{"start":{"line":4467},"end":{"line":4467}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Literal","value":"true","raw":"true","loc":{"start":{"line":4633},"end":{"line":4633}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":4633},"end":{"line":4639}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":4647},"end":{"line":4647}}},"property":{"type":"Identifier","name":"getParameter"},"loc":{"start":{"line":4647},"end":{"line":4654}}},"arguments":[{"type":"Literal","value":"start","raw":"start","loc":{"start":{"line":4668},"end":{"line":4668}}}],"loc":{"start":{"line":4647},"end":{"line":4667}}}],"loc":{"start":{"line":4633},"end":{"line":4646}}},"right":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":4681},"end":{"line":4681}}},"property":{"type":"Identifier","name":"getQueryString"},"loc":{"start":{"line":4681},"end":{"line":4688}}},"arguments":[],"loc":{"start":{"line":4681},"end":{"line":4703}}},"right":{"type":"Literal","loc":{"start":{"line":4709},"end":{"line":4709}}},"loc":{"start":{"line":4681},"end":{"line":4706}}},"loc":{"start":{"line":4633},"end":{"line":4678}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"logger","loc":{"start":{"line":4733},"end":{"line":4733}}},"property":{"type":"Identifier","name":"warn"},"loc":{"start":{"line":4733},"end":{"line":4739}}},"arguments":[{"type":"Literal","value":"Redirecting to first lesson","raw":"Redirecting to first lesson","loc":{"start":{"line":4745},"end":{"line":4745}}}],"loc":{"start":{"line":4733},"end":{"line":4744}}},"loc":{"start":{"line":4733},"end":{"line":4733}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":4793},"end":{"line":4793}}},"property":{"type":"Identifier","name":"sendRedirect"},"loc":{"start":{"line":4793},"end":{"line":4801}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"start.mvc","raw":"start.mvc","loc":{"start":{"line":4815},"end":{"line":4815}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"mySession","loc":{"start":{"line":4829},"end":{"line":4829}}},"property":{"type":"Identifier","name":"getCourse"},"loc":{"start":{"line":4829},"end":{"line":4838}}},"arguments":[],"loc":{"start":{"line":4829},"end":{"line":4848}}},"property":{"type":"Identifier","name":"getFirstLesson"},"loc":{"start":{"line":4829},"end":{"line":4850}}},"arguments":[],"loc":{"start":{"line":4829},"end":{"line":4865}}},"property":{"type":"Identifier","name":"getLink"},"loc":{"start":{"line":4829},"end":{"line":4867}}},"arguments":[],"loc":{"start":{"line":4829},"end":{"line":4875}}},"loc":{"start":{"line":4815},"end":{"line":4827}}}],"loc":{"start":{"line":4793},"end":{"line":4814}}},"loc":{"start":{"line":4793},"end":{"line":4793}}},{"type":"ReturnStatement","loc":{"start":{"line":4896},"end":{"line":4896}}}],"loc":{"start":{"line":4715},"end":{"line":4916}}},"loc":{"start":{"line":4629},"end":{"line":4629}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"screen","loc":{"start":{"line":5314},"end":{"line":5314}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"makeScreen","loc":{"start":{"line":5323},"end":{"line":5323}}},"arguments":[{"type":"Identifier","name":"mySession","loc":{"start":{"line":5334},"end":{"line":5334}}}],"loc":{"start":{"line":5323},"end":{"line":5333}}},"loc":{"start":{"line":5314},"end":{"line":5321}}},"loc":{"start":{"line":5314},"end":{"line":5314}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":5432},"end":{"line":5432}}},"property":{"type":"Identifier","name":"isCommitted"},"loc":{"start":{"line":5432},"end":{"line":5440}}},"arguments":[],"loc":{"start":{"line":5432},"end":{"line":5452}}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","loc":{"start":{"line":5474},"end":{"line":5474}}}],"loc":{"start":{"line":5456},"end":{"line":5494}}},"loc":{"start":{"line":5428},"end":{"line":5428}}},{"type":"IfStatement","test":{"type":"TypeTest","expression":{"type":"Identifier","name":"screen","loc":{"start":{"line":5572},"end":{"line":5572}}},"clazz":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":5590},"end":{"line":5590}}},"loc":{"start":{"line":5572},"end":{"line":5579}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":5624},"end":{"line":5624}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":5624},"end":{"line":5624}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":5649},"end":{"line":5649}}},"expression":{"type":"Identifier","name":"screen","loc":{"start":{"line":5665},"end":{"line":5665}}},"loc":{"start":{"line":5648},"end":{"line":5648}}},"loc":{"start":{"line":5624},"end":{"line":5639}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Literal","value":"GET","raw":"GET","loc":{"start":{"line":5781},"end":{"line":5781}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":5781},"end":{"line":5786}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":5794},"end":{"line":5794}}},"property":{"type":"Identifier","name":"getMethod"},"loc":{"start":{"line":5794},"end":{"line":5801}}},"arguments":[],"loc":{"start":{"line":5794},"end":{"line":5811}}}],"loc":{"start":{"line":5781},"end":{"line":5793}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uri","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":5838},"end":{"line":5838}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":5838},"end":{"line":5838}}},"init":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":5851},"end":{"line":5851}}},"property":{"type":"Identifier","name":"getRequestURI"},"loc":{"start":{"line":5851},"end":{"line":5858}}},"arguments":[],"loc":{"start":{"line":5851},"end":{"line":5872}}},"right":{"type":"Literal","value":"?","raw":"?","loc":{"start":{"line":5877},"end":{"line":5877}}},"loc":{"start":{"line":5851},"end":{"line":5875}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":5883},"end":{"line":5883}}},"property":{"type":"Identifier","name":"getQueryString"},"loc":{"start":{"line":5883},"end":{"line":5890}}},"arguments":[],"loc":{"start":{"line":5883},"end":{"line":5905}}},"loc":{"start":{"line":5851},"end":{"line":5881}}},"loc":{"start":{"line":5838},"end":{"line":5845}}},{"type":"IfStatement","test":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uri","loc":{"start":{"line":5934},"end":{"line":5934}}},"property":{"type":"Identifier","name":"endsWith"},"loc":{"start":{"line":5934},"end":{"line":5937}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":5947},"end":{"line":5947}}},"property":{"type":"Identifier","name":"getLink"},"loc":{"start":{"line":5947},"end":{"line":5953}}},"arguments":[],"loc":{"start":{"line":5947},"end":{"line":5961}}}],"loc":{"start":{"line":5934},"end":{"line":5946}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":5933},"end":{"line":5933}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"screen","loc":{"start":{"line":5992},"end":{"line":5992}}},"property":{"type":"Identifier","name":"getLessonTracker"},"loc":{"start":{"line":5992},"end":{"line":5998}}},"arguments":[{"type":"Identifier","name":"mySession","loc":{"start":{"line":6016},"end":{"line":6016}}}],"loc":{"start":{"line":5992},"end":{"line":6015}}},"property":{"type":"Identifier","name":"incrementNumVisits"},"loc":{"start":{"line":5992},"end":{"line":6026}}},"arguments":[],"loc":{"start":{"line":5992},"end":{"line":6045}}},"loc":{"start":{"line":5992},"end":{"line":5992}}}],"loc":{"start":{"line":5966},"end":{"line":6069}}},"loc":{"start":{"line":5929},"end":{"line":5929}}}],"loc":{"start":{"line":5816},"end":{"line":6087}}},"alternate":{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Literal","value":"POST","raw":"POST","loc":{"start":{"line":6098},"end":{"line":6098}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":6098},"end":{"line":6104}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":6112},"end":{"line":6112}}},"property":{"type":"Identifier","name":"getMethod"},"loc":{"start":{"line":6112},"end":{"line":6119}}},"arguments":[],"loc":{"start":{"line":6112},"end":{"line":6129}}}],"loc":{"start":{"line":6098},"end":{"line":6111}}},"right":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"mySession","loc":{"start":{"line":6160},"end":{"line":6160}}},"property":{"type":"Identifier","name":"getPreviousScreen"},"loc":{"start":{"line":6160},"end":{"line":6169}}},"arguments":[],"loc":{"start":{"line":6160},"end":{"line":6187}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"mySession","loc":{"start":{"line":6193},"end":{"line":6193}}},"property":{"type":"Identifier","name":"getCurrentScreen"},"loc":{"start":{"line":6193},"end":{"line":6202}}},"arguments":[],"loc":{"start":{"line":6193},"end":{"line":6219}}},"loc":{"start":{"line":6160},"end":{"line":6190}}},"loc":{"start":{"line":6098},"end":{"line":6157}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"screen","loc":{"start":{"line":6245},"end":{"line":6245}}},"property":{"type":"Identifier","name":"getLessonTracker"},"loc":{"start":{"line":6245},"end":{"line":6251}}},"arguments":[{"type":"Identifier","name":"mySession","loc":{"start":{"line":6269},"end":{"line":6269}}}],"loc":{"start":{"line":6245},"end":{"line":6268}}},"property":{"type":"Identifier","name":"incrementNumVisits"},"loc":{"start":{"line":6245},"end":{"line":6279}}},"arguments":[],"loc":{"start":{"line":6245},"end":{"line":6298}}},"loc":{"start":{"line":6245},"end":{"line":6245}}}],"loc":{"start":{"line":6223},"end":{"line":6318}}},"loc":{"start":{"line":6094},"end":{"line":6094}}},"loc":{"start":{"line":5777},"end":{"line":5777}}}],"loc":{"start":{"line":5606},"end":{"line":6332}}},"loc":{"start":{"line":5568},"end":{"line":5568}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"userTracker","vartype":{"type":"Identifier","name":"UserTracker","loc":{"start":{"line":6406},"end":{"line":6406}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"UserTracker","loc":{"start":{"line":6406},"end":{"line":6406}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"UserTracker","loc":{"start":{"line":6432},"end":{"line":6432}}},"property":{"type":"Identifier","name":"instance"},"loc":{"start":{"line":6432},"end":{"line":6443}}},"arguments":[],"loc":{"start":{"line":6432},"end":{"line":6452}}},"loc":{"start":{"line":6406},"end":{"line":6418}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"userTracker","loc":{"start":{"line":6468},"end":{"line":6468}}},"property":{"type":"Identifier","name":"update"},"loc":{"start":{"line":6468},"end":{"line":6479}}},"arguments":[{"type":"Identifier","name":"mySession","loc":{"start":{"line":6487},"end":{"line":6487}}},{"type":"Identifier","name":"screen","loc":{"start":{"line":6498},"end":{"line":6498}}}],"loc":{"start":{"line":6468},"end":{"line":6486}}},"loc":{"start":{"line":6468},"end":{"line":6468}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"log","loc":{"start":{"line":6519},"end":{"line":6519}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":6523},"end":{"line":6523}}},{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"screen","loc":{"start":{"line":6532},"end":{"line":6532}}},"property":{"type":"Identifier","name":"getClass"},"loc":{"start":{"line":6532},"end":{"line":6538}}},"arguments":[],"loc":{"start":{"line":6532},"end":{"line":6547}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":6532},"end":{"line":6549}}},"arguments":[],"loc":{"start":{"line":6532},"end":{"line":6557}}},"right":{"type":"Literal","value":" | ","raw":" | ","loc":{"start":{"line":6562},"end":{"line":6562}}},"loc":{"start":{"line":6532},"end":{"line":6560}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"mySession","loc":{"start":{"line":6570},"end":{"line":6570}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":6570},"end":{"line":6579}}},"arguments":[],"loc":{"start":{"line":6570},"end":{"line":6589}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":6570},"end":{"line":6591}}},"arguments":[],"loc":{"start":{"line":6570},"end":{"line":6600}}},"loc":{"start":{"line":6532},"end":{"line":6568}}}],"loc":{"start":{"line":6519},"end":{"line":6522}}},"loc":{"start":{"line":6519},"end":{"line":6519}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"userAgent","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":6674},"end":{"line":6674}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":6674},"end":{"line":6674}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":6693},"end":{"line":6693}}},"property":{"type":"Identifier","name":"getHeader"},"loc":{"start":{"line":6693},"end":{"line":6700}}},"arguments":[{"type":"Literal","value":"user-agent","raw":"user-agent","loc":{"start":{"line":6711},"end":{"line":6711}}}],"loc":{"start":{"line":6693},"end":{"line":6710}}},"loc":{"start":{"line":6674},"end":{"line":6681}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"clientBrowser","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":6738},"end":{"line":6738}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":6738},"end":{"line":6738}}},"init":{"type":"Literal","value":"Not known!","raw":"Not known!","loc":{"start":{"line":6761},"end":{"line":6761}}},"loc":{"start":{"line":6738},"end":{"line":6745}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"userAgent","loc":{"start":{"line":6791},"end":{"line":6791}}},"right":{"type":"Literal","loc":{"start":{"line":6804},"end":{"line":6804}}},"loc":{"start":{"line":6791},"end":{"line":6801}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"clientBrowser","loc":{"start":{"line":6828},"end":{"line":6828}}},"right":{"type":"Identifier","name":"userAgent","loc":{"start":{"line":6844},"end":{"line":6844}}},"loc":{"start":{"line":6828},"end":{"line":6842}}},"loc":{"start":{"line":6828},"end":{"line":6828}}}],"loc":{"start":{"line":6810},"end":{"line":6867}}},"loc":{"start":{"line":6787},"end":{"line":6787}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":6881},"end":{"line":6881}}},"property":{"type":"Identifier","name":"setAttribute"},"loc":{"start":{"line":6881},"end":{"line":6888}}},"arguments":[{"type":"Literal","value":"client.browser","raw":"client.browser","loc":{"start":{"line":6902},"end":{"line":6902}}},{"type":"Identifier","name":"clientBrowser","loc":{"start":{"line":6920},"end":{"line":6920}}}],"loc":{"start":{"line":6881},"end":{"line":6901}}},"loc":{"start":{"line":6881},"end":{"line":6881}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"viewPage","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":7247},"end":{"line":7247}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":7247},"end":{"line":7247}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getViewPage","loc":{"start":{"line":7265},"end":{"line":7265}}},"arguments":[{"type":"Identifier","name":"mySession","loc":{"start":{"line":7277},"end":{"line":7277}}}],"loc":{"start":{"line":7265},"end":{"line":7276}}},"loc":{"start":{"line":7247},"end":{"line":7254}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"logger","loc":{"start":{"line":7301},"end":{"line":7301}}},"property":{"type":"Identifier","name":"debug"},"loc":{"start":{"line":7301},"end":{"line":7307}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Forwarding to view: ","raw":"Forwarding to view: ","loc":{"start":{"line":7314},"end":{"line":7314}}},"right":{"type":"Identifier","name":"viewPage","loc":{"start":{"line":7339},"end":{"line":7339}}},"loc":{"start":{"line":7314},"end":{"line":7337}}}],"loc":{"start":{"line":7301},"end":{"line":7313}}},"loc":{"start":{"line":7301},"end":{"line":7301}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"logger","loc":{"start":{"line":7362},"end":{"line":7362}}},"property":{"type":"Identifier","name":"debug"},"loc":{"start":{"line":7362},"end":{"line":7368}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Screen: ","raw":"Screen: ","loc":{"start":{"line":7375},"end":{"line":7375}}},"right":{"type":"Identifier","name":"screen","loc":{"start":{"line":7388},"end":{"line":7388}}},"loc":{"start":{"line":7375},"end":{"line":7386}}}],"loc":{"start":{"line":7362},"end":{"line":7374}}},"loc":{"start":{"line":7362},"end":{"line":7362}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":7409},"end":{"line":7409}}},"property":{"type":"Identifier","name":"getRequestDispatcher"},"loc":{"start":{"line":7409},"end":{"line":7416}}},"arguments":[{"type":"Identifier","name":"viewPage","loc":{"start":{"line":7438},"end":{"line":7438}}}],"loc":{"start":{"line":7409},"end":{"line":7437}}},"property":{"type":"Identifier","name":"forward"},"loc":{"start":{"line":7409},"end":{"line":7447}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":7456},"end":{"line":7456}}},{"type":"Identifier","name":"response","loc":{"start":{"line":7465},"end":{"line":7465}}}],"loc":{"start":{"line":7409},"end":{"line":7455}}},"loc":{"start":{"line":7409},"end":{"line":7409}}}],"loc":{"start":{"line":3980},"end":{"line":7484}}},"loc":{"start":{"line":3976},"end":{"line":8004}}}],"loc":{"start":{"line":3898},"end":{"line":8010}}},"code":"\n@Override()\npublic void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {\n    Screen screen \u003d null;\n    WebSession mySession \u003d null;\n    try {\n        logger.debug(\"Entering doPost\");\n        logger.debug(\"request: \" + request);\n        logger.debug(\"principle: \" + request.getUserPrincipal());\n        ServletContext context \u003d getServletContext();\n        mySession \u003d updateSession(request, response, context);\n        if (response.isCommitted()) {\n            logger.debug(\"Response already committed, exiting\");\n            return;\n        }\n        if (\"true\".equals(request.getParameter(\"start\")) || request.getQueryString() \u003d\u003d null) {\n            logger.warn(\"Redirecting to first lesson\");\n            response.sendRedirect(\"start.mvc\" + mySession.getCourse().getFirstLesson().getLink());\n            return;\n        }\n        screen \u003d makeScreen(mySession);\n        if (response.isCommitted()) {\n            return;\n        }\n        if (screen instanceof AbstractLesson) {\n            AbstractLesson lesson \u003d (AbstractLesson)screen;\n            if (\"GET\".equals(request.getMethod())) {\n                String uri \u003d request.getRequestURI() + \"?\" + request.getQueryString();\n                if (!uri.endsWith(lesson.getLink())) {\n                    screen.getLessonTracker(mySession).incrementNumVisits();\n                }\n            } else if (\"POST\".equals(request.getMethod()) \u0026\u0026 mySession.getPreviousScreen() \u003d\u003d mySession.getCurrentScreen()) {\n                screen.getLessonTracker(mySession).incrementNumVisits();\n            }\n        }\n        UserTracker userTracker \u003d UserTracker.instance();\n        userTracker.update(mySession, screen);\n        log(request, screen.getClass().getName() + \" | \" + mySession.getParser().toString());\n        String userAgent \u003d request.getHeader(\"user-agent\");\n        String clientBrowser \u003d \"Not known!\";\n        if (userAgent !\u003d null) {\n            clientBrowser \u003d userAgent;\n        }\n        request.setAttribute(\"client.browser\", clientBrowser);\n        String viewPage \u003d getViewPage(mySession);\n        logger.debug(\"Forwarding to view: \" + viewPage);\n        logger.debug(\"Screen: \" + screen);\n        request.getRequestDispatcher(viewPage).forward(request, response);\n    } catch (Throwable t) {\n        logger.error(\"Error handling request\", t);\n        screen \u003d new ErrorScreen(mySession, t);\n    } finally {\n        try {\n            if (screen instanceof ErrorScreen) {\n                this.writeScreen(mySession, screen, response);\n            }\n        } catch (Throwable thr) {\n            logger.error(\"Could not write error screen\", thr);\n        }\n        WebSession.returnConnection(mySession);\n        logger.debug(\"Leaving doPost: \");\n    }\n}","loc":{"start":{"line":3770},"end":{"line":3796}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getViewPage"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":8025},"end":{"line":8025}}},"typarams":[],"params":[{"type":"Identifier","name":"webSession","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":8044},"end":{"line":8044}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"page","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":8126},"end":{"line":8126}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":8126},"end":{"line":8126}}},"init":{"type":"Literal","value":"/lesson_content.jsp","raw":"/lesson_content.jsp","loc":{"start":{"line":8140},"end":{"line":8140}}},"loc":{"start":{"line":8126},"end":{"line":8133}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"page","loc":{"start":{"line":8208},"end":{"line":8208}}},"loc":{"start":{"line":8201},"end":{"line":8201}}}],"loc":{"start":{"line":8067},"end":{"line":8218}}},"code":"\nprivate String getViewPage(WebSession webSession) {\n    String page \u003d \"/lesson_content.jsp\";\n    return page;\n}","loc":{"start":{"line":8017},"end":{"line":8032}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"formatHttpDate"},"modifiers":{"type":"Modifiers","modifiers":["protected","static"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":8387},"end":{"line":8387}}},"typarams":[],"params":[{"type":"Identifier","name":"date","vartype":{"type":"Identifier","name":"Date","loc":{"start":{"line":8409},"end":{"line":8409}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"SynchronizedStatement","lock":{"type":"Identifier","name":"httpDateFormat","loc":{"start":{"line":8444},"end":{"line":8444}}},"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"httpDateFormat","loc":{"start":{"line":8481},"end":{"line":8481}}},"property":{"type":"Identifier","name":"format"},"loc":{"start":{"line":8481},"end":{"line":8495}}},"arguments":[{"type":"Identifier","name":"date","loc":{"start":{"line":8503},"end":{"line":8503}}}],"loc":{"start":{"line":8481},"end":{"line":8502}}},"loc":{"start":{"line":8474},"end":{"line":8474}}}],"loc":{"start":{"line":8460},"end":{"line":8518}}},"loc":{"start":{"line":8430},"end":{"line":8518}}}],"loc":{"start":{"line":8420},"end":{"line":8524}}},"code":"\nprotected static String formatHttpDate(Date date) {\n    synchronized (httpDateFormat) {\n        return httpDateFormat.format(date);\n    }\n}","loc":{"start":{"line":8370},"end":{"line":8394}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getServletInfo"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Override","loc":{"start":{"line":8621},"end":{"line":8621}}},"arguments":[]}]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":8641},"end":{"line":8641}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Literal","value":"WebGoat is sponsored by Aspect Security.","raw":"WebGoat is sponsored by Aspect Security.","loc":{"start":{"line":8682},"end":{"line":8682}}},"loc":{"start":{"line":8675},"end":{"line":8675}}}],"loc":{"start":{"line":8665},"end":{"line":8730}}},"code":"\n@Override()\npublic String getServletInfo() {\n    return \"WebGoat is sponsored by Aspect Security.\";\n}","loc":{"start":{"line":8620},"end":{"line":8648}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"init"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Override","loc":{"start":{"line":8812},"end":{"line":8812}}},"arguments":[]}]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[],"thrown":[{"type":"Identifier","name":"ServletException","loc":{"start":{"line":8851},"end":{"line":8851}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"logger","loc":{"start":{"line":8878},"end":{"line":8878}}},"property":{"type":"Identifier","name":"info"},"loc":{"start":{"line":8878},"end":{"line":8884}}},"arguments":[{"type":"Literal","value":"Initializing main webgoat servlet","raw":"Initializing main webgoat servlet","loc":{"start":{"line":8890},"end":{"line":8890}}}],"loc":{"start":{"line":8878},"end":{"line":8889}}},"loc":{"start":{"line":8878},"end":{"line":8878}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"httpDateFormat","loc":{"start":{"line":8936},"end":{"line":8936}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"SimpleDateFormat","loc":{"start":{"line":8957},"end":{"line":8957}}},"arguments":[{"type":"Literal","value":"EEE, dd MMM yyyyy HH:mm:ss z","raw":"EEE, dd MMM yyyyy HH:mm:ss z","loc":{"start":{"line":8974},"end":{"line":8974}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"Locale","loc":{"start":{"line":9006},"end":{"line":9006}}},"property":{"type":"Identifier","name":"US"},"loc":{"start":{"line":9006},"end":{"line":9012}}}],"loc":{"start":{"line":8953},"end":{"line":8953}}},"loc":{"start":{"line":8936},"end":{"line":8951}}},"loc":{"start":{"line":8936},"end":{"line":8936}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"httpDateFormat","loc":{"start":{"line":9026},"end":{"line":9026}}},"property":{"type":"Identifier","name":"setTimeZone"},"loc":{"start":{"line":9026},"end":{"line":9040}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"TimeZone","loc":{"start":{"line":9053},"end":{"line":9053}}},"property":{"type":"Identifier","name":"getTimeZone"},"loc":{"start":{"line":9053},"end":{"line":9061}}},"arguments":[{"type":"Literal","value":"GMT","raw":"GMT","loc":{"start":{"line":9074},"end":{"line":9074}}}],"loc":{"start":{"line":9053},"end":{"line":9073}}}],"loc":{"start":{"line":9026},"end":{"line":9052}}},"loc":{"start":{"line":9026},"end":{"line":9026}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"propertiesPath","loc":{"start":{"line":9091},"end":{"line":9091}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getServletContext","loc":{"start":{"line":9108},"end":{"line":9108}}},"arguments":[],"loc":{"start":{"line":9108},"end":{"line":9125}}},"property":{"type":"Identifier","name":"getRealPath"},"loc":{"start":{"line":9108},"end":{"line":9127}}},"arguments":[{"type":"Literal","value":"/WEB-INF/webgoat.properties","raw":"/WEB-INF/webgoat.properties","loc":{"start":{"line":9140},"end":{"line":9140}}}],"loc":{"start":{"line":9108},"end":{"line":9139}}},"loc":{"start":{"line":9091},"end":{"line":9106}}},"loc":{"start":{"line":9091},"end":{"line":9091}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"webgoatContext","loc":{"start":{"line":9180},"end":{"line":9180}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"WebgoatContext","loc":{"start":{"line":9201},"end":{"line":9201}}},"arguments":[{"type":"ThisExpression"}],"loc":{"start":{"line":9197},"end":{"line":9197}}},"loc":{"start":{"line":9180},"end":{"line":9195}}},"loc":{"start":{"line":9180},"end":{"line":9180}}}],"loc":{"start":{"line":8868},"end":{"line":9227}}},"code":"\n@Override()\npublic void init() throws ServletException {\n    logger.info(\"Initializing main webgoat servlet\");\n    httpDateFormat \u003d new SimpleDateFormat(\"EEE, dd MMM yyyyy HH:mm:ss z\", Locale.US);\n    httpDateFormat.setTimeZone(TimeZone.getTimeZone(\"GMT\"));\n    propertiesPath \u003d getServletContext().getRealPath(\"/WEB-INF/webgoat.properties\");\n    webgoatContext \u003d new WebgoatContext(this);\n}","loc":{"start":{"line":8811},"end":{"line":8837}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"log"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"request","vartype":{"type":"Identifier","name":"HttpServletRequest","loc":{"start":{"line":9408},"end":{"line":9408}}}},{"type":"Identifier","name":"message","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":9436},"end":{"line":9436}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"output","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":9462},"end":{"line":9462}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":9462},"end":{"line":9462}}},"init":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Date","loc":{"start":{"line":9482},"end":{"line":9482}}},"arguments":[],"loc":{"start":{"line":9478},"end":{"line":9478}}},"right":{"type":"Literal","value":" | ","raw":" | ","loc":{"start":{"line":9491},"end":{"line":9491}}},"loc":{"start":{"line":9478},"end":{"line":9489}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":9499},"end":{"line":9499}}},"property":{"type":"Identifier","name":"getRemoteHost"},"loc":{"start":{"line":9499},"end":{"line":9506}}},"arguments":[],"loc":{"start":{"line":9499},"end":{"line":9520}}},"loc":{"start":{"line":9478},"end":{"line":9497}}},"right":{"type":"Literal","value":":","raw":":","loc":{"start":{"line":9525},"end":{"line":9525}}},"loc":{"start":{"line":9478},"end":{"line":9523}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":9531},"end":{"line":9531}}},"property":{"type":"Identifier","name":"getRemoteAddr"},"loc":{"start":{"line":9531},"end":{"line":9538}}},"arguments":[],"loc":{"start":{"line":9531},"end":{"line":9552}}},"loc":{"start":{"line":9478},"end":{"line":9529}}},"right":{"type":"Literal","value":" | ","raw":" | ","loc":{"start":{"line":9557},"end":{"line":9557}}},"loc":{"start":{"line":9478},"end":{"line":9555}}},"right":{"type":"Identifier","name":"message","loc":{"start":{"line":9565},"end":{"line":9565}}},"loc":{"start":{"line":9478},"end":{"line":9563}}},"loc":{"start":{"line":9462},"end":{"line":9469}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"log","loc":{"start":{"line":9582},"end":{"line":9582}}},"arguments":[{"type":"Identifier","name":"output","loc":{"start":{"line":9586},"end":{"line":9586}}}],"loc":{"start":{"line":9582},"end":{"line":9585}}},"loc":{"start":{"line":9582},"end":{"line":9582}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"logger","loc":{"start":{"line":9603},"end":{"line":9603}}},"property":{"type":"Identifier","name":"debug"},"loc":{"start":{"line":9603},"end":{"line":9609}}},"arguments":[{"type":"Identifier","name":"output","loc":{"start":{"line":9616},"end":{"line":9616}}}],"loc":{"start":{"line":9603},"end":{"line":9615}}},"loc":{"start":{"line":9603},"end":{"line":9603}}}],"loc":{"start":{"line":9452},"end":{"line":9629}}},"code":"\npublic void log(HttpServletRequest request, String message) {\n    String output \u003d new Date() + \" | \" + request.getRemoteHost() + \":\" + request.getRemoteAddr() + \" | \" + message;\n    log(output);\n    logger.debug(output);\n}","loc":{"start":{"line":9392},"end":{"line":9404}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"makeScreen"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Screen","loc":{"start":{"line":10080},"end":{"line":10080}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":10098},"end":{"line":10098}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"screen","vartype":{"type":"Identifier","name":"Screen","loc":{"start":{"line":10122},"end":{"line":10122}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Screen","loc":{"start":{"line":10122},"end":{"line":10122}}},"init":{"type":"Literal","loc":{"start":{"line":10138},"end":{"line":10138}}},"loc":{"start":{"line":10122},"end":{"line":10129}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"scr","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":10162},"end":{"line":10162}}},"property":{"type":"Identifier","name":"getCurrentScreen"},"loc":{"start":{"line":10162},"end":{"line":10163}}},"arguments":[],"loc":{"start":{"line":10162},"end":{"line":10180}}},"loc":{"start":{"line":10152},"end":{"line":10156}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"course","vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":10192},"end":{"line":10192}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":10192},"end":{"line":10192}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":10208},"end":{"line":10208}}},"property":{"type":"Identifier","name":"getCourse"},"loc":{"start":{"line":10208},"end":{"line":10209}}},"arguments":[],"loc":{"start":{"line":10208},"end":{"line":10219}}},"loc":{"start":{"line":10192},"end":{"line":10199}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":10236},"end":{"line":10236}}},"property":{"type":"Identifier","name":"isUser"},"loc":{"start":{"line":10236},"end":{"line":10237}}},"arguments":[],"loc":{"start":{"line":10236},"end":{"line":10244}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":10250},"end":{"line":10250}}},"property":{"type":"Identifier","name":"isChallenge"},"loc":{"start":{"line":10250},"end":{"line":10251}}},"arguments":[],"loc":{"start":{"line":10250},"end":{"line":10263}}},"loc":{"start":{"line":10236},"end":{"line":10247}}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"scr","loc":{"start":{"line":10285},"end":{"line":10285}}},"right":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":10292},"end":{"line":10292}}},"property":{"type":"Identifier","name":"WELCOME"},"loc":{"start":{"line":10292},"end":{"line":10302}}},"loc":{"start":{"line":10285},"end":{"line":10289}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"screen","loc":{"start":{"line":10330},"end":{"line":10330}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"WelcomeScreen","loc":{"start":{"line":10343},"end":{"line":10343}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":10357},"end":{"line":10357}}}],"loc":{"start":{"line":10339},"end":{"line":10339}}},"loc":{"start":{"line":10330},"end":{"line":10337}}},"loc":{"start":{"line":10330},"end":{"line":10330}}}],"loc":{"start":{"line":10312},"end":{"line":10373}}},"alternate":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":10398},"end":{"line":10398}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":10398},"end":{"line":10398}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"course","loc":{"start":{"line":10422},"end":{"line":10422}}},"property":{"type":"Identifier","name":"getLesson"},"loc":{"start":{"line":10422},"end":{"line":10428}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":10439},"end":{"line":10439}}},{"type":"Identifier","name":"scr","loc":{"start":{"line":10442},"end":{"line":10442}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":10447},"end":{"line":10447}}},"property":{"type":"Identifier","name":"USER_ROLE"},"loc":{"start":{"line":10447},"end":{"line":10461}}}],"loc":{"start":{"line":10422},"end":{"line":10438}}},"loc":{"start":{"line":10398},"end":{"line":10413}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":10494},"end":{"line":10494}}},"right":{"type":"Literal","loc":{"start":{"line":10504},"end":{"line":10504}}},"loc":{"start":{"line":10494},"end":{"line":10501}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":10512},"end":{"line":10512}}},"property":{"type":"Identifier","name":"isHackedAdmin"},"loc":{"start":{"line":10512},"end":{"line":10513}}},"arguments":[],"loc":{"start":{"line":10512},"end":{"line":10527}}},"loc":{"start":{"line":10494},"end":{"line":10509}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":10663},"end":{"line":10663}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"course","loc":{"start":{"line":10672},"end":{"line":10672}}},"property":{"type":"Identifier","name":"getLesson"},"loc":{"start":{"line":10672},"end":{"line":10678}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":10689},"end":{"line":10689}}},{"type":"Identifier","name":"scr","loc":{"start":{"line":10692},"end":{"line":10692}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":10697},"end":{"line":10697}}},"property":{"type":"Identifier","name":"HACKED_ADMIN_ROLE"},"loc":{"start":{"line":10697},"end":{"line":10711}}}],"loc":{"start":{"line":10672},"end":{"line":10688}}},"loc":{"start":{"line":10663},"end":{"line":10670}}},"loc":{"start":{"line":10663},"end":{"line":10663}}}],"loc":{"start":{"line":10531},"end":{"line":10748}}},"loc":{"start":{"line":10490},"end":{"line":10490}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":10771},"end":{"line":10771}}},"right":{"type":"Literal","loc":{"start":{"line":10781},"end":{"line":10781}}},"loc":{"start":{"line":10771},"end":{"line":10778}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"screen","loc":{"start":{"line":10809},"end":{"line":10809}}},"right":{"type":"Identifier","name":"lesson","loc":{"start":{"line":10818},"end":{"line":10818}}},"loc":{"start":{"line":10809},"end":{"line":10816}}},"loc":{"start":{"line":10809},"end":{"line":10809}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":11283},"end":{"line":11283}}},"property":{"type":"Identifier","name":"setHasHackableAdmin"},"loc":{"start":{"line":11283},"end":{"line":11284}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"screen","loc":{"start":{"line":11305},"end":{"line":11305}}},"property":{"type":"Identifier","name":"getRole"},"loc":{"start":{"line":11305},"end":{"line":11311}}},"arguments":[],"loc":{"start":{"line":11305},"end":{"line":11319}}}],"loc":{"start":{"line":11283},"end":{"line":11304}}},"loc":{"start":{"line":11283},"end":{"line":11283}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":11345},"end":{"line":11345}}},"property":{"type":"Identifier","name":"handleRequest"},"loc":{"start":{"line":11345},"end":{"line":11351}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":11366},"end":{"line":11366}}}],"loc":{"start":{"line":11345},"end":{"line":11365}}},"loc":{"start":{"line":11345},"end":{"line":11345}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":11390},"end":{"line":11390}}},"property":{"type":"Identifier","name":"setCurrentMenu"},"loc":{"start":{"line":11390},"end":{"line":11391}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":11407},"end":{"line":11407}}},"property":{"type":"Identifier","name":"getCategory"},"loc":{"start":{"line":11407},"end":{"line":11413}}},"arguments":[],"loc":{"start":{"line":11407},"end":{"line":11425}}},"property":{"type":"Identifier","name":"getRanking"},"loc":{"start":{"line":11407},"end":{"line":11427}}},"arguments":[],"loc":{"start":{"line":11407},"end":{"line":11438}}}],"loc":{"start":{"line":11390},"end":{"line":11406}}},"loc":{"start":{"line":11390},"end":{"line":11390}}}],"loc":{"start":{"line":10787},"end":{"line":11459}}},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"screen","loc":{"start":{"line":11488},"end":{"line":11488}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ErrorScreen","loc":{"start":{"line":11501},"end":{"line":11501}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":11513},"end":{"line":11513}}},{"type":"Literal","value":"Invalid screen requested.  Try: http://localhost/WebGoat/attack","raw":"Invalid screen requested.  Try: http://localhost/WebGoat/attack","loc":{"start":{"line":11516},"end":{"line":11516}}}],"loc":{"start":{"line":11497},"end":{"line":11497}}},"loc":{"start":{"line":11488},"end":{"line":11495}}},"loc":{"start":{"line":11488},"end":{"line":11488}}}],"loc":{"start":{"line":11466},"end":{"line":11600}}},"loc":{"start":{"line":10767},"end":{"line":10767}}}],"loc":{"start":{"line":10380},"end":{"line":11614}}},"loc":{"start":{"line":10281},"end":{"line":10281}}}],"loc":{"start":{"line":10267},"end":{"line":11624}}},"alternate":{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":11635},"end":{"line":11635}}},"property":{"type":"Identifier","name":"isAdmin"},"loc":{"start":{"line":11635},"end":{"line":11636}}},"arguments":[],"loc":{"start":{"line":11635},"end":{"line":11644}}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"scr","loc":{"start":{"line":11666},"end":{"line":11666}}},"right":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":11673},"end":{"line":11673}}},"property":{"type":"Identifier","name":"WELCOME"},"loc":{"start":{"line":11673},"end":{"line":11683}}},"loc":{"start":{"line":11666},"end":{"line":11670}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"screen","loc":{"start":{"line":11711},"end":{"line":11711}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"WelcomeAdminScreen","loc":{"start":{"line":11724},"end":{"line":11724}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":11743},"end":{"line":11743}}}],"loc":{"start":{"line":11720},"end":{"line":11720}}},"loc":{"start":{"line":11711},"end":{"line":11718}}},"loc":{"start":{"line":11711},"end":{"line":11711}}}],"loc":{"start":{"line":11693},"end":{"line":11759}}},"alternate":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":11894},"end":{"line":11894}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":11894},"end":{"line":11894}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"course","loc":{"start":{"line":11918},"end":{"line":11918}}},"property":{"type":"Identifier","name":"getLesson"},"loc":{"start":{"line":11918},"end":{"line":11924}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":11935},"end":{"line":11935}}},{"type":"Identifier","name":"scr","loc":{"start":{"line":11938},"end":{"line":11938}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":11943},"end":{"line":11943}}},"property":{"type":"Identifier","name":"ADMIN_ROLE"},"loc":{"start":{"line":11943},"end":{"line":11957}}}],"loc":{"start":{"line":11918},"end":{"line":11934}}},"loc":{"start":{"line":11894},"end":{"line":11909}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":11991},"end":{"line":11991}}},"right":{"type":"Literal","loc":{"start":{"line":12001},"end":{"line":12001}}},"loc":{"start":{"line":11991},"end":{"line":11998}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":12029},"end":{"line":12029}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"course","loc":{"start":{"line":12038},"end":{"line":12038}}},"property":{"type":"Identifier","name":"getLesson"},"loc":{"start":{"line":12038},"end":{"line":12044}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":12055},"end":{"line":12055}}},{"type":"Identifier","name":"scr","loc":{"start":{"line":12058},"end":{"line":12058}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":12063},"end":{"line":12063}}},"property":{"type":"Identifier","name":"HACKED_ADMIN_ROLE"},"loc":{"start":{"line":12063},"end":{"line":12077}}}],"loc":{"start":{"line":12038},"end":{"line":12054}}},"loc":{"start":{"line":12029},"end":{"line":12036}}},"loc":{"start":{"line":12029},"end":{"line":12029}}}],"loc":{"start":{"line":12007},"end":{"line":12114}}},"loc":{"start":{"line":11987},"end":{"line":11987}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":12136},"end":{"line":12136}}},"right":{"type":"Literal","loc":{"start":{"line":12146},"end":{"line":12146}}},"loc":{"start":{"line":12136},"end":{"line":12143}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":12174},"end":{"line":12174}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"course","loc":{"start":{"line":12183},"end":{"line":12183}}},"property":{"type":"Identifier","name":"getLesson"},"loc":{"start":{"line":12183},"end":{"line":12189}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":12200},"end":{"line":12200}}},{"type":"Identifier","name":"scr","loc":{"start":{"line":12203},"end":{"line":12203}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":12208},"end":{"line":12208}}},"property":{"type":"Identifier","name":"USER_ROLE"},"loc":{"start":{"line":12208},"end":{"line":12222}}}],"loc":{"start":{"line":12183},"end":{"line":12199}}},"loc":{"start":{"line":12174},"end":{"line":12181}}},"loc":{"start":{"line":12174},"end":{"line":12174}}}],"loc":{"start":{"line":12152},"end":{"line":12251}}},"loc":{"start":{"line":12132},"end":{"line":12132}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":12274},"end":{"line":12274}}},"right":{"type":"Literal","loc":{"start":{"line":12284},"end":{"line":12284}}},"loc":{"start":{"line":12274},"end":{"line":12281}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"screen","loc":{"start":{"line":12312},"end":{"line":12312}}},"right":{"type":"Identifier","name":"lesson","loc":{"start":{"line":12321},"end":{"line":12321}}},"loc":{"start":{"line":12312},"end":{"line":12319}}},"loc":{"start":{"line":12312},"end":{"line":12312}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":12786},"end":{"line":12786}}},"property":{"type":"Identifier","name":"setHasHackableAdmin"},"loc":{"start":{"line":12786},"end":{"line":12787}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"screen","loc":{"start":{"line":12808},"end":{"line":12808}}},"property":{"type":"Identifier","name":"getRole"},"loc":{"start":{"line":12808},"end":{"line":12814}}},"arguments":[],"loc":{"start":{"line":12808},"end":{"line":12822}}}],"loc":{"start":{"line":12786},"end":{"line":12807}}},"loc":{"start":{"line":12786},"end":{"line":12786}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":12848},"end":{"line":12848}}},"property":{"type":"Identifier","name":"handleRequest"},"loc":{"start":{"line":12848},"end":{"line":12854}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":12869},"end":{"line":12869}}}],"loc":{"start":{"line":12848},"end":{"line":12868}}},"loc":{"start":{"line":12848},"end":{"line":12848}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":12893},"end":{"line":12893}}},"property":{"type":"Identifier","name":"setCurrentMenu"},"loc":{"start":{"line":12893},"end":{"line":12894}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":12910},"end":{"line":12910}}},"property":{"type":"Identifier","name":"getCategory"},"loc":{"start":{"line":12910},"end":{"line":12916}}},"arguments":[],"loc":{"start":{"line":12910},"end":{"line":12928}}},"property":{"type":"Identifier","name":"getRanking"},"loc":{"start":{"line":12910},"end":{"line":12930}}},"arguments":[],"loc":{"start":{"line":12910},"end":{"line":12941}}}],"loc":{"start":{"line":12893},"end":{"line":12909}}},"loc":{"start":{"line":12893},"end":{"line":12893}}}],"loc":{"start":{"line":12290},"end":{"line":12962}}},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"screen","loc":{"start":{"line":12991},"end":{"line":12991}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ErrorScreen","loc":{"start":{"line":13004},"end":{"line":13004}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":13016},"end":{"line":13016}}},{"type":"Literal","value":"Invalid screen requested.  Try Setting Admin to false or Try: http://localhost/WebGoat/attack","raw":"Invalid screen requested.  Try Setting Admin to false or Try: http://localhost/WebGoat/attack","loc":{"start":{"line":13047},"end":{"line":13047}}}],"loc":{"start":{"line":13000},"end":{"line":13000}}},"loc":{"start":{"line":12991},"end":{"line":12998}}},"loc":{"start":{"line":12991},"end":{"line":12991}}}],"loc":{"start":{"line":12969},"end":{"line":13161}}},"loc":{"start":{"line":12270},"end":{"line":12270}}}],"loc":{"start":{"line":11766},"end":{"line":13175}}},"loc":{"start":{"line":11662},"end":{"line":11662}}}],"loc":{"start":{"line":11648},"end":{"line":13185}}},"loc":{"start":{"line":11631},"end":{"line":11631}}},"loc":{"start":{"line":10232},"end":{"line":10232}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"screen","loc":{"start":{"line":13204},"end":{"line":13204}}},"loc":{"start":{"line":13196},"end":{"line":13196}}}],"loc":{"start":{"line":10112},"end":{"line":13217}}},"code":"\nprotected Screen makeScreen(WebSession s) {\n    Screen screen \u003d null;\n    int scr \u003d s.getCurrentScreen();\n    Course course \u003d s.getCourse();\n    if (s.isUser() || s.isChallenge()) {\n        if (scr \u003d\u003d WebSession.WELCOME) {\n            screen \u003d new WelcomeScreen(s);\n        } else {\n            AbstractLesson lesson \u003d course.getLesson(s, scr, AbstractLesson.USER_ROLE);\n            if (lesson \u003d\u003d null \u0026\u0026 s.isHackedAdmin()) {\n                lesson \u003d course.getLesson(s, scr, AbstractLesson.HACKED_ADMIN_ROLE);\n            }\n            if (lesson !\u003d null) {\n                screen \u003d lesson;\n                s.setHasHackableAdmin(screen.getRole());\n                lesson.handleRequest(s);\n                s.setCurrentMenu(lesson.getCategory().getRanking());\n            } else {\n                screen \u003d new ErrorScreen(s, \"Invalid screen requested.  Try: http://localhost/WebGoat/attack\");\n            }\n        }\n    } else if (s.isAdmin()) {\n        if (scr \u003d\u003d WebSession.WELCOME) {\n            screen \u003d new WelcomeAdminScreen(s);\n        } else {\n            AbstractLesson lesson \u003d course.getLesson(s, scr, AbstractLesson.ADMIN_ROLE);\n            if (lesson \u003d\u003d null) {\n                lesson \u003d course.getLesson(s, scr, AbstractLesson.HACKED_ADMIN_ROLE);\n            }\n            if (lesson \u003d\u003d null) {\n                lesson \u003d course.getLesson(s, scr, AbstractLesson.USER_ROLE);\n            }\n            if (lesson !\u003d null) {\n                screen \u003d lesson;\n                s.setHasHackableAdmin(screen.getRole());\n                lesson.handleRequest(s);\n                s.setCurrentMenu(lesson.getCategory().getRanking());\n            } else {\n                screen \u003d new ErrorScreen(s, \"Invalid screen requested.  Try Setting Admin to false or Try: http://localhost/WebGoat/attack\");\n            }\n        }\n    }\n    return (screen);\n}","loc":{"start":{"line":10070},"end":{"line":10087}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"setCacheHeaders"},"modifiers":{"type":"Modifiers","modifiers":["protected","static"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"response","vartype":{"type":"Identifier","name":"HttpServletResponse","loc":{"start":{"line":13579},"end":{"line":13579}}}},{"type":"Identifier","name":"expiry","vartype":{"type":"PrimitiveType"}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"expiry","loc":{"start":{"line":13635},"end":{"line":13635}}},"right":{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":13645},"end":{"line":13645}}},"loc":{"start":{"line":13635},"end":{"line":13642}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":13662},"end":{"line":13662}}},"property":{"type":"Identifier","name":"setHeader"},"loc":{"start":{"line":13662},"end":{"line":13670}}},"arguments":[{"type":"Literal","value":"Pragma","raw":"Pragma","loc":{"start":{"line":13681},"end":{"line":13681}}},{"type":"Literal","value":"no-cache","raw":"no-cache","loc":{"start":{"line":13691},"end":{"line":13691}}}],"loc":{"start":{"line":13662},"end":{"line":13680}}},"loc":{"start":{"line":13662},"end":{"line":13662}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":13716},"end":{"line":13716}}},"property":{"type":"Identifier","name":"setHeader"},"loc":{"start":{"line":13716},"end":{"line":13724}}},"arguments":[{"type":"Literal","value":"Cache-Control","raw":"Cache-Control","loc":{"start":{"line":13735},"end":{"line":13735}}},{"type":"Literal","value":"no-cache","raw":"no-cache","loc":{"start":{"line":13752},"end":{"line":13752}}}],"loc":{"start":{"line":13716},"end":{"line":13734}}},"loc":{"start":{"line":13716},"end":{"line":13716}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":13777},"end":{"line":13777}}},"property":{"type":"Identifier","name":"setHeader"},"loc":{"start":{"line":13777},"end":{"line":13785}}},"arguments":[{"type":"Literal","value":"Expires","raw":"Expires","loc":{"start":{"line":13796},"end":{"line":13796}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"formatHttpDate","loc":{"start":{"line":13807},"end":{"line":13807}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Date","loc":{"start":{"line":13826},"end":{"line":13826}}},"arguments":[],"loc":{"start":{"line":13822},"end":{"line":13822}}}],"loc":{"start":{"line":13807},"end":{"line":13821}}}],"loc":{"start":{"line":13777},"end":{"line":13795}}},"loc":{"start":{"line":13777},"end":{"line":13777}}}],"loc":{"start":{"line":13648},"end":{"line":13844}}},"alternate":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"expiryDate","vartype":{"type":"Identifier","name":"Date","loc":{"start":{"line":13865},"end":{"line":13865}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Date","loc":{"start":{"line":13865},"end":{"line":13865}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Date","loc":{"start":{"line":13887},"end":{"line":13887}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":13892},"end":{"line":13892}}},"property":{"type":"Identifier","name":"currentTimeMillis"},"loc":{"start":{"line":13892},"end":{"line":13898}}},"arguments":[],"loc":{"start":{"line":13892},"end":{"line":13916}}},"right":{"type":"Identifier","name":"expiry","loc":{"start":{"line":13921},"end":{"line":13921}}},"loc":{"start":{"line":13892},"end":{"line":13919}}}],"loc":{"start":{"line":13883},"end":{"line":13883}}},"loc":{"start":{"line":13865},"end":{"line":13870}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":13942},"end":{"line":13942}}},"property":{"type":"Identifier","name":"setHeader"},"loc":{"start":{"line":13942},"end":{"line":13950}}},"arguments":[{"type":"Literal","value":"Expires","raw":"Expires","loc":{"start":{"line":13961},"end":{"line":13961}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"formatHttpDate","loc":{"start":{"line":13972},"end":{"line":13972}}},"arguments":[{"type":"Identifier","name":"expiryDate","loc":{"start":{"line":13987},"end":{"line":13987}}}],"loc":{"start":{"line":13972},"end":{"line":13986}}}],"loc":{"start":{"line":13942},"end":{"line":13960}}},"loc":{"start":{"line":13942},"end":{"line":13942}}}],"loc":{"start":{"line":13851},"end":{"line":14009}}},"loc":{"start":{"line":13631},"end":{"line":13631}}}],"loc":{"start":{"line":13621},"end":{"line":14015}}},"code":"\nprotected static void setCacheHeaders(HttpServletResponse response, int expiry) {\n    if (expiry \u003d\u003d 0) {\n        response.setHeader(\"Pragma\", \"no-cache\");\n        response.setHeader(\"Cache-Control\", \"no-cache\");\n        response.setHeader(\"Expires\", formatHttpDate(new Date()));\n    } else {\n        Date expiryDate \u003d new Date(System.currentTimeMillis() + expiry);\n        response.setHeader(\"Expires\", formatHttpDate(expiryDate));\n    }\n}","loc":{"start":{"line":13541},"end":{"line":13563}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"updateSession"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":14332},"end":{"line":14332}}},"typarams":[],"params":[{"type":"Identifier","name":"request","vartype":{"type":"Identifier","name":"HttpServletRequest","loc":{"start":{"line":14357},"end":{"line":14357}}}},{"type":"Identifier","name":"response","vartype":{"type":"Identifier","name":"HttpServletResponse","loc":{"start":{"line":14385},"end":{"line":14385}}}},{"type":"Identifier","name":"context","vartype":{"type":"Identifier","name":"ServletContext","loc":{"start":{"line":14415},"end":{"line":14415}}}}],"thrown":[{"type":"Identifier","name":"IOException","loc":{"start":{"line":14458},"end":{"line":14458}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"hs","vartype":{"type":"Identifier","name":"HttpSession","loc":{"start":{"line":14480},"end":{"line":14480}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"HttpSession","loc":{"start":{"line":14480},"end":{"line":14480}}},"loc":{"start":{"line":14480},"end":{"line":14492}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"hs","loc":{"start":{"line":14568},"end":{"line":14568}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":14573},"end":{"line":14573}}},"property":{"type":"Identifier","name":"getSession"},"loc":{"start":{"line":14573},"end":{"line":14580}}},"arguments":[{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":14592},"end":{"line":14592}}}],"loc":{"start":{"line":14573},"end":{"line":14591}}},"loc":{"start":{"line":14568},"end":{"line":14571}}},"loc":{"start":{"line":14568},"end":{"line":14568}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"logger","loc":{"start":{"line":14609},"end":{"line":14609}}},"property":{"type":"Identifier","name":"debug"},"loc":{"start":{"line":14609},"end":{"line":14615}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"HH Entering Session_id: ","raw":"HH Entering Session_id: ","loc":{"start":{"line":14622},"end":{"line":14622}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hs","loc":{"start":{"line":14651},"end":{"line":14651}}},"property":{"type":"Identifier","name":"getId"},"loc":{"start":{"line":14651},"end":{"line":14653}}},"arguments":[],"loc":{"start":{"line":14651},"end":{"line":14659}}},"loc":{"start":{"line":14622},"end":{"line":14649}}}],"loc":{"start":{"line":14609},"end":{"line":14621}}},"loc":{"start":{"line":14609},"end":{"line":14609}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"session","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":14760},"end":{"line":14760}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":14760},"end":{"line":14760}}},"init":{"type":"Literal","loc":{"start":{"line":14781},"end":{"line":14781}}},"loc":{"start":{"line":14760},"end":{"line":14771}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"o","vartype":{"type":"Identifier","name":"Object","loc":{"start":{"line":14795},"end":{"line":14795}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Object","loc":{"start":{"line":14795},"end":{"line":14795}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hs","loc":{"start":{"line":14806},"end":{"line":14806}}},"property":{"type":"Identifier","name":"getAttribute"},"loc":{"start":{"line":14806},"end":{"line":14808}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":14822},"end":{"line":14822}}},"property":{"type":"Identifier","name":"SESSION"},"loc":{"start":{"line":14822},"end":{"line":14832}}}],"loc":{"start":{"line":14806},"end":{"line":14821}}},"loc":{"start":{"line":14795},"end":{"line":14802}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"o","loc":{"start":{"line":14857},"end":{"line":14857}}},"right":{"type":"Literal","loc":{"start":{"line":14862},"end":{"line":14862}}},"loc":{"start":{"line":14857},"end":{"line":14859}}},"right":{"type":"TypeTest","expression":{"type":"Identifier","name":"o","loc":{"start":{"line":14871},"end":{"line":14871}}},"clazz":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":14884},"end":{"line":14884}}},"loc":{"start":{"line":14871},"end":{"line":14873}}},"loc":{"start":{"line":14856},"end":{"line":14868}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"session","loc":{"start":{"line":14910},"end":{"line":14910}}},"right":{"type":"TypeCast","clazz":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":14921},"end":{"line":14921}}},"expression":{"type":"Identifier","name":"o","loc":{"start":{"line":14933},"end":{"line":14933}}},"loc":{"start":{"line":14920},"end":{"line":14920}}},"loc":{"start":{"line":14910},"end":{"line":14918}}},"loc":{"start":{"line":14910},"end":{"line":14910}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hs","loc":{"start":{"line":14948},"end":{"line":14948}}},"property":{"type":"Identifier","name":"setAttribute"},"loc":{"start":{"line":14948},"end":{"line":14950}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":14964},"end":{"line":14964}}},"property":{"type":"Identifier","name":"COURSE"},"loc":{"start":{"line":14964},"end":{"line":14974}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":14983},"end":{"line":14983}}},"property":{"type":"Identifier","name":"getCourse"},"loc":{"start":{"line":14983},"end":{"line":14990}}},"arguments":[],"loc":{"start":{"line":14983},"end":{"line":15000}}}],"loc":{"start":{"line":14948},"end":{"line":14963}}},"loc":{"start":{"line":14948},"end":{"line":14948}}}],"loc":{"start":{"line":14896},"end":{"line":15013}}},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"logger","loc":{"start":{"line":15107},"end":{"line":15107}}},"property":{"type":"Identifier","name":"warn"},"loc":{"start":{"line":15107},"end":{"line":15113}}},"arguments":[{"type":"Literal","value":"HH Creating new WebSession","raw":"HH Creating new WebSession","loc":{"start":{"line":15119},"end":{"line":15119}}}],"loc":{"start":{"line":15107},"end":{"line":15118}}},"loc":{"start":{"line":15107},"end":{"line":15107}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"session","loc":{"start":{"line":15162},"end":{"line":15162}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":15176},"end":{"line":15176}}},"arguments":[{"type":"Identifier","name":"webgoatContext","loc":{"start":{"line":15187},"end":{"line":15187}}},{"type":"Identifier","name":"context","loc":{"start":{"line":15203},"end":{"line":15203}}}],"loc":{"start":{"line":15172},"end":{"line":15172}}},"loc":{"start":{"line":15162},"end":{"line":15170}}},"loc":{"start":{"line":15162},"end":{"line":15162}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hs","loc":{"start":{"line":15405},"end":{"line":15405}}},"property":{"type":"Identifier","name":"setAttribute"},"loc":{"start":{"line":15405},"end":{"line":15407}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":15421},"end":{"line":15421}}},"property":{"type":"Identifier","name":"SESSION"},"loc":{"start":{"line":15421},"end":{"line":15431}}},{"type":"Identifier","name":"session","loc":{"start":{"line":15441},"end":{"line":15441}}}],"loc":{"start":{"line":15405},"end":{"line":15420}}},"loc":{"start":{"line":15405},"end":{"line":15405}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hs","loc":{"start":{"line":15492},"end":{"line":15492}}},"property":{"type":"Identifier","name":"setMaxInactiveInterval"},"loc":{"start":{"line":15492},"end":{"line":15494}}},"arguments":[{"type":"Identifier","name":"sessionTimeoutSeconds","loc":{"start":{"line":15518},"end":{"line":15518}}}],"loc":{"start":{"line":15492},"end":{"line":15517}}},"loc":{"start":{"line":15492},"end":{"line":15492}}}],"loc":{"start":{"line":15020},"end":{"line":15550}}},"loc":{"start":{"line":14852},"end":{"line":14852}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":15561},"end":{"line":15561}}},"property":{"type":"Identifier","name":"update"},"loc":{"start":{"line":15561},"end":{"line":15568}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":15576},"end":{"line":15576}}},{"type":"Identifier","name":"response","loc":{"start":{"line":15585},"end":{"line":15585}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"getServletName"},"loc":{"start":{"line":15595},"end":{"line":15599}}},"arguments":[],"loc":{"start":{"line":15595},"end":{"line":15614}}}],"loc":{"start":{"line":15561},"end":{"line":15575}}},"loc":{"start":{"line":15561},"end":{"line":15561}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":15768},"end":{"line":15768}}},"property":{"type":"Identifier","name":"updateLastAttackRequestInfo"},"loc":{"start":{"line":15768},"end":{"line":15775}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":15804},"end":{"line":15804}}}],"loc":{"start":{"line":15768},"end":{"line":15803}}},"loc":{"start":{"line":15768},"end":{"line":15768}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"logger","loc":{"start":{"line":15850},"end":{"line":15850}}},"property":{"type":"Identifier","name":"debug"},"loc":{"start":{"line":15850},"end":{"line":15856}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"HH Leaving Session_id: ","raw":"HH Leaving Session_id: ","loc":{"start":{"line":15863},"end":{"line":15863}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hs","loc":{"start":{"line":15891},"end":{"line":15891}}},"property":{"type":"Identifier","name":"getId"},"loc":{"start":{"line":15891},"end":{"line":15893}}},"arguments":[],"loc":{"start":{"line":15891},"end":{"line":15899}}},"loc":{"start":{"line":15863},"end":{"line":15889}}}],"loc":{"start":{"line":15850},"end":{"line":15862}}},"loc":{"start":{"line":15850},"end":{"line":15850}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"session","loc":{"start":{"line":15949},"end":{"line":15949}}},"loc":{"start":{"line":15941},"end":{"line":15941}}}],"loc":{"start":{"line":14470},"end":{"line":15963}}},"code":"\nprotected WebSession updateSession(HttpServletRequest request, HttpServletResponse response, ServletContext context) throws IOException {\n    HttpSession hs;\n    hs \u003d request.getSession(false);\n    logger.debug(\"HH Entering Session_id: \" + hs.getId());\n    WebSession session \u003d null;\n    Object o \u003d hs.getAttribute(WebSession.SESSION);\n    if ((o !\u003d null) \u0026\u0026 o instanceof WebSession) {\n        session \u003d (WebSession)o;\n        hs.setAttribute(WebSession.COURSE, session.getCourse());\n    } else {\n        logger.warn(\"HH Creating new WebSession\");\n        session \u003d new WebSession(webgoatContext, context);\n        hs.setAttribute(WebSession.SESSION, session);\n        hs.setMaxInactiveInterval(sessionTimeoutSeconds);\n    }\n    session.update(request, response, this.getServletName());\n    session.updateLastAttackRequestInfo(request);\n    logger.debug(\"HH Leaving Session_id: \" + hs.getId());\n    return (session);\n}","loc":{"start":{"line":14322},"end":{"line":14343}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"writeScreen"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":16324},"end":{"line":16324}}}},{"type":"Identifier","name":"screen","vartype":{"type":"Identifier","name":"Screen","loc":{"start":{"line":16338},"end":{"line":16338}}}},{"type":"Identifier","name":"response","vartype":{"type":"Identifier","name":"HttpServletResponse","loc":{"start":{"line":16353},"end":{"line":16353}}}}],"thrown":[{"type":"Identifier","name":"IOException","loc":{"start":{"line":16390},"end":{"line":16390}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":16412},"end":{"line":16412}}},"property":{"type":"Identifier","name":"setContentType"},"loc":{"start":{"line":16412},"end":{"line":16420}}},"arguments":[{"type":"Literal","value":"text/html","raw":"text/html","loc":{"start":{"line":16436},"end":{"line":16436}}}],"loc":{"start":{"line":16412},"end":{"line":16435}}},"loc":{"start":{"line":16412},"end":{"line":16412}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"out","vartype":{"type":"Identifier","name":"PrintWriter","loc":{"start":{"line":16459},"end":{"line":16459}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"PrintWriter","loc":{"start":{"line":16459},"end":{"line":16459}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":16477},"end":{"line":16477}}},"property":{"type":"Identifier","name":"getWriter"},"loc":{"start":{"line":16477},"end":{"line":16485}}},"arguments":[],"loc":{"start":{"line":16477},"end":{"line":16495}}},"loc":{"start":{"line":16459},"end":{"line":16471}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"s","loc":{"start":{"line":16512},"end":{"line":16512}}},"right":{"type":"Literal","loc":{"start":{"line":16517},"end":{"line":16517}}},"loc":{"start":{"line":16512},"end":{"line":16514}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"screen","loc":{"start":{"line":16537},"end":{"line":16537}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ErrorScreen","loc":{"start":{"line":16550},"end":{"line":16550}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":16562},"end":{"line":16562}}},{"type":"Literal","value":"Page to display was null","raw":"Page to display was null","loc":{"start":{"line":16565},"end":{"line":16565}}}],"loc":{"start":{"line":16546},"end":{"line":16546}}},"loc":{"start":{"line":16537},"end":{"line":16544}}},"loc":{"start":{"line":16537},"end":{"line":16537}}}],"loc":{"start":{"line":16523},"end":{"line":16602}}},"loc":{"start":{"line":16508},"end":{"line":16508}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":16727},"end":{"line":16727}}},"property":{"type":"Identifier","name":"setContentLength"},"loc":{"start":{"line":16727},"end":{"line":16735}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"screen","loc":{"start":{"line":16753},"end":{"line":16753}}},"property":{"type":"Identifier","name":"getContentLength"},"loc":{"start":{"line":16753},"end":{"line":16759}}},"arguments":[],"loc":{"start":{"line":16753},"end":{"line":16776}}}],"loc":{"start":{"line":16727},"end":{"line":16752}}},"loc":{"start":{"line":16727},"end":{"line":16727}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":16789},"end":{"line":16789}}},"property":{"type":"Identifier","name":"setHeader"},"loc":{"start":{"line":16789},"end":{"line":16797}}},"arguments":[{"type":"Literal","value":"Content-Length","raw":"Content-Length","loc":{"start":{"line":16808},"end":{"line":16808}}},{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"screen","loc":{"start":{"line":16826},"end":{"line":16826}}},"property":{"type":"Identifier","name":"getContentLength"},"loc":{"start":{"line":16826},"end":{"line":16832}}},"arguments":[],"loc":{"start":{"line":16826},"end":{"line":16849}}},"right":{"type":"Literal","value":"","raw":"","loc":{"start":{"line":16854},"end":{"line":16854}}},"loc":{"start":{"line":16826},"end":{"line":16852}}}],"loc":{"start":{"line":16789},"end":{"line":16807}}},"loc":{"start":{"line":16789},"end":{"line":16789}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"screen","loc":{"start":{"line":16868},"end":{"line":16868}}},"property":{"type":"Identifier","name":"output"},"loc":{"start":{"line":16868},"end":{"line":16874}}},"arguments":[{"type":"Identifier","name":"out","loc":{"start":{"line":16882},"end":{"line":16882}}}],"loc":{"start":{"line":16868},"end":{"line":16881}}},"loc":{"start":{"line":16868},"end":{"line":16868}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"out","loc":{"start":{"line":16896},"end":{"line":16896}}},"property":{"type":"Identifier","name":"flush"},"loc":{"start":{"line":16896},"end":{"line":16899}}},"arguments":[],"loc":{"start":{"line":16896},"end":{"line":16905}}},"loc":{"start":{"line":16896},"end":{"line":16896}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"out","loc":{"start":{"line":16917},"end":{"line":16917}}},"property":{"type":"Identifier","name":"close"},"loc":{"start":{"line":16917},"end":{"line":16920}}},"arguments":[],"loc":{"start":{"line":16917},"end":{"line":16926}}},"loc":{"start":{"line":16917},"end":{"line":16917}}}],"loc":{"start":{"line":16402},"end":{"line":16934}}},"code":"\nprotected void writeScreen(WebSession s, Screen screen, HttpServletResponse response) throws IOException {\n    response.setContentType(\"text/html\");\n    PrintWriter out \u003d response.getWriter();\n    if (s \u003d\u003d null) {\n        screen \u003d new ErrorScreen(s, \"Page to display was null\");\n    }\n    response.setContentLength(screen.getContentLength());\n    response.setHeader(\"Content-Length\", screen.getContentLength() + \"\");\n    screen.output(out);\n    out.flush();\n    out.close();\n}","loc":{"start":{"line":16297},"end":{"line":16312}}}],"loc":{"start":{"line":2373},"end":{"line":2380}}}],"loc":{"start":{"line":0},"end":{"line":0}}}