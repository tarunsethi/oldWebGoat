{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":8},"end":{"line":11}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":8},"end":{"line":17}}},"property":{"type":"Identifier","name":"servlets"},"loc":{"start":{"line":8},"end":{"line":25}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":44},"end":{"line":44}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":44},"end":{"line":48}}},"property":{"type":"Identifier","name":"IOException"},"loc":{"start":{"line":44},"end":{"line":51}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":72},"end":{"line":72}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":72},"end":{"line":77}}},"property":{"type":"Identifier","name":"ServletException"},"loc":{"start":{"line":72},"end":{"line":85}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":111},"end":{"line":111}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":111},"end":{"line":116}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":111},"end":{"line":124}}},"property":{"type":"Identifier","name":"HttpServlet"},"loc":{"start":{"line":111},"end":{"line":129}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":150},"end":{"line":150}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":150},"end":{"line":155}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":150},"end":{"line":163}}},"property":{"type":"Identifier","name":"HttpServletRequest"},"loc":{"start":{"line":150},"end":{"line":168}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":196},"end":{"line":196}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":196},"end":{"line":201}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":196},"end":{"line":209}}},"property":{"type":"Identifier","name":"HttpServletResponse"},"loc":{"start":{"line":196},"end":{"line":214}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"Controller"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"HttpServlet","loc":{"start":{"line":1524},"end":{"line":1524}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"serialVersionUID","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"Literal","value":1,"raw":1,"loc":{"start":{"line":1588},"end":{"line":1588}}},"loc":{"start":{"line":1543},"end":{"line":1569}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"doGet"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"request","vartype":{"type":"Identifier","name":"HttpServletRequest","loc":{"start":{"line":1643},"end":{"line":1643}}}},{"type":"Identifier","name":"response","vartype":{"type":"Identifier","name":"HttpServletResponse","loc":{"start":{"line":1671},"end":{"line":1671}}}}],"thrown":[{"type":"Identifier","name":"ServletException","loc":{"start":{"line":1708},"end":{"line":1708}}},{"type":"Identifier","name":"IOException","loc":{"start":{"line":1726},"end":{"line":1726}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"doPost","loc":{"start":{"line":1749},"end":{"line":1749}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":1756},"end":{"line":1756}}},{"type":"Identifier","name":"response","loc":{"start":{"line":1765},"end":{"line":1765}}}],"loc":{"start":{"line":1749},"end":{"line":1755}}},"loc":{"start":{"line":1749},"end":{"line":1749}}}],"loc":{"start":{"line":1738},"end":{"line":1781}}},"code":"\nprotected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n    doPost(request, response);\n}","loc":{"start":{"line":1622},"end":{"line":1637}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"doPost"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"request","vartype":{"type":"Identifier","name":"HttpServletRequest","loc":{"start":{"line":1835},"end":{"line":1835}}}},{"type":"Identifier","name":"response","vartype":{"type":"Identifier","name":"HttpServletResponse","loc":{"start":{"line":1863},"end":{"line":1863}}}}],"thrown":[{"type":"Identifier","name":"ServletException","loc":{"start":{"line":1900},"end":{"line":1900}}},{"type":"Identifier","name":"IOException","loc":{"start":{"line":1930},"end":{"line":1930}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"userAgent","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1953},"end":{"line":1953}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1953},"end":{"line":1953}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":1972},"end":{"line":1972}}},"property":{"type":"Identifier","name":"getHeader"},"loc":{"start":{"line":1972},"end":{"line":1979}}},"arguments":[{"type":"Literal","value":"user-agent","raw":"user-agent","loc":{"start":{"line":1990},"end":{"line":1990}}}],"loc":{"start":{"line":1972},"end":{"line":1989}}},"loc":{"start":{"line":1953},"end":{"line":1960}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"clientBrowser","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2014},"end":{"line":2014}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2014},"end":{"line":2014}}},"init":{"type":"Literal","value":"Not known!","raw":"Not known!","loc":{"start":{"line":2037},"end":{"line":2037}}},"loc":{"start":{"line":2014},"end":{"line":2021}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"userAgent","loc":{"start":{"line":2064},"end":{"line":2064}}},"right":{"type":"Literal","loc":{"start":{"line":2077},"end":{"line":2077}}},"loc":{"start":{"line":2064},"end":{"line":2074}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"clientBrowser","loc":{"start":{"line":2098},"end":{"line":2098}}},"right":{"type":"Identifier","name":"userAgent","loc":{"start":{"line":2114},"end":{"line":2114}}},"loc":{"start":{"line":2098},"end":{"line":2112}}},"loc":{"start":{"line":2098},"end":{"line":2098}}}],"loc":{"start":{"line":2083},"end":{"line":2134}}},"loc":{"start":{"line":2060},"end":{"line":2060}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":2145},"end":{"line":2145}}},"property":{"type":"Identifier","name":"setAttribute"},"loc":{"start":{"line":2145},"end":{"line":2152}}},"arguments":[{"type":"Literal","value":"client.browser","raw":"client.browser","loc":{"start":{"line":2166},"end":{"line":2166}}},{"type":"Identifier","name":"clientBrowser","loc":{"start":{"line":2184},"end":{"line":2184}}}],"loc":{"start":{"line":2145},"end":{"line":2165}}},"loc":{"start":{"line":2145},"end":{"line":2145}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":2209},"end":{"line":2209}}},"property":{"type":"Identifier","name":"getRequestDispatcher"},"loc":{"start":{"line":2209},"end":{"line":2216}}},"arguments":[{"type":"Literal","value":"/view.jsp","raw":"/view.jsp","loc":{"start":{"line":2238},"end":{"line":2238}}}],"loc":{"start":{"line":2209},"end":{"line":2237}}},"property":{"type":"Identifier","name":"forward"},"loc":{"start":{"line":2209},"end":{"line":2250}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":2259},"end":{"line":2259}}},{"type":"Identifier","name":"response","loc":{"start":{"line":2268},"end":{"line":2268}}}],"loc":{"start":{"line":2209},"end":{"line":2258}}},"loc":{"start":{"line":2209},"end":{"line":2209}}}],"loc":{"start":{"line":1942},"end":{"line":2284}}},"code":"\nprotected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n    String userAgent \u003d request.getHeader(\"user-agent\");\n    String clientBrowser \u003d \"Not known!\";\n    if (userAgent !\u003d null) {\n        clientBrowser \u003d userAgent;\n    }\n    request.setAttribute(\"client.browser\", clientBrowser);\n    request.getRequestDispatcher(\"/view.jsp\").forward(request, response);\n}","loc":{"start":{"line":1813},"end":{"line":1828}}}],"loc":{"start":{"line":1492},"end":{"line":1499}}}],"loc":{"start":{"line":0},"end":{"line":0}}}