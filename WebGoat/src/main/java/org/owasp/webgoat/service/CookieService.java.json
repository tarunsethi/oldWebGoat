{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1239},"end":{"line":1239}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1239},"end":{"line":1242}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1239},"end":{"line":1248}}},"property":{"type":"Identifier","name":"service"},"loc":{"start":{"line":1239},"end":{"line":1256}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":1274},"end":{"line":1274}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":1274},"end":{"line":1278}}},"property":{"type":"Identifier","name":"Collections"},"loc":{"start":{"line":1274},"end":{"line":1283}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":1304},"end":{"line":1304}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":1304},"end":{"line":1308}}},"property":{"type":"Identifier","name":"List"},"loc":{"start":{"line":1304},"end":{"line":1313}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":1327},"end":{"line":1327}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":1327},"end":{"line":1332}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":1327},"end":{"line":1340}}},"property":{"type":"Identifier","name":"Cookie"},"loc":{"start":{"line":1327},"end":{"line":1345}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":1361},"end":{"line":1361}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":1361},"end":{"line":1366}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":1361},"end":{"line":1374}}},"property":{"type":"Identifier","name":"HttpSession"},"loc":{"start":{"line":1361},"end":{"line":1379}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1400},"end":{"line":1400}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1400},"end":{"line":1403}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1400},"end":{"line":1409}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":1400},"end":{"line":1417}}},"property":{"type":"Identifier","name":"model"},"loc":{"start":{"line":1400},"end":{"line":1425}}},"property":{"type":"Identifier","name":"RequestParameter"},"loc":{"start":{"line":1400},"end":{"line":1431}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1457},"end":{"line":1457}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1457},"end":{"line":1460}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1457},"end":{"line":1466}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":1457},"end":{"line":1474}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":1457},"end":{"line":1482}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1502},"end":{"line":1502}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":1502},"end":{"line":1505}}},"property":{"type":"Identifier","name":"stereotype"},"loc":{"start":{"line":1502},"end":{"line":1521}}},"property":{"type":"Identifier","name":"Controller"},"loc":{"start":{"line":1502},"end":{"line":1532}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1552},"end":{"line":1552}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":1552},"end":{"line":1555}}},"property":{"type":"Identifier","name":"web"},"loc":{"start":{"line":1552},"end":{"line":1571}}},"property":{"type":"Identifier","name":"bind"},"loc":{"start":{"line":1552},"end":{"line":1575}}},"property":{"type":"Identifier","name":"annotation"},"loc":{"start":{"line":1552},"end":{"line":1580}}},"property":{"type":"Identifier","name":"RequestMapping"},"loc":{"start":{"line":1552},"end":{"line":1591}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1615},"end":{"line":1615}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":1615},"end":{"line":1618}}},"property":{"type":"Identifier","name":"web"},"loc":{"start":{"line":1615},"end":{"line":1634}}},"property":{"type":"Identifier","name":"bind"},"loc":{"start":{"line":1615},"end":{"line":1638}}},"property":{"type":"Identifier","name":"annotation"},"loc":{"start":{"line":1615},"end":{"line":1643}}},"property":{"type":"Identifier","name":"ResponseBody"},"loc":{"start":{"line":1615},"end":{"line":1654}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1676},"end":{"line":1676}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":1676},"end":{"line":1679}}},"property":{"type":"Identifier","name":"web"},"loc":{"start":{"line":1676},"end":{"line":1695}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":1676},"end":{"line":1699}}},"property":{"type":"Identifier","name":"ModelAndView"},"loc":{"start":{"line":1676},"end":{"line":1707}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"CookieService"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Controller","loc":{"start":{"line":1806},"end":{"line":1806}}},"arguments":[]}]},"extending":{"type":"Identifier","name":"BaseService","loc":{"start":{"line":1852},"end":{"line":1852}}},"definitions":[{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"showCookies"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"RequestMapping","loc":{"start":{"line":2053},"end":{"line":2053}}},"arguments":[{"type":"AssignmentExpression","left":{"type":"Identifier","name":"value","loc":{"start":{"line":2068},"end":{"line":2068}}},"right":{"type":"Literal","value":"/cookie.mvc","raw":"/cookie.mvc","loc":{"start":{"line":2076},"end":{"line":2076}}},"loc":{"start":{"line":2068},"end":{"line":2074}}},{"type":"AssignmentExpression","left":{"type":"Identifier","name":"produces","loc":{"start":{"line":2091},"end":{"line":2091}}},"right":{"type":"Literal","value":"application/json","raw":"application/json","loc":{"start":{"line":2102},"end":{"line":2102}}},"loc":{"start":{"line":2091},"end":{"line":2100}}}]},{"type":"Annotation","annotationType":{"type":"Identifier","name":"ResponseBody","loc":{"start":{"line":2134},"end":{"line":2134}}},"arguments":[]}]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":2151},"end":{"line":2151}}},"typarams":[],"params":[{"type":"Identifier","name":"session","vartype":{"type":"Identifier","name":"HttpSession","loc":{"start":{"line":2176},"end":{"line":2176}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ws","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":2207},"end":{"line":2207}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":2207},"end":{"line":2207}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getWebSession","loc":{"start":{"line":2223},"end":{"line":2223}}},"arguments":[{"type":"Identifier","name":"session","loc":{"start":{"line":2237},"end":{"line":2237}}}],"loc":{"start":{"line":2223},"end":{"line":2236}}},"loc":{"start":{"line":2207},"end":{"line":2218}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"cookies","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":2255},"end":{"line":2255}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":2255},"end":{"line":2255}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ws","loc":{"start":{"line":2278},"end":{"line":2278}}},"property":{"type":"Identifier","name":"getCookiesOnLastRequest"},"loc":{"start":{"line":2278},"end":{"line":2280}}},"arguments":[],"loc":{"start":{"line":2278},"end":{"line":2304}}},"loc":{"start":{"line":2255},"end":{"line":2268}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"cookies","loc":{"start":{"line":2323},"end":{"line":2323}}},"loc":{"start":{"line":2316},"end":{"line":2316}}}],"loc":{"start":{"line":2197},"end":{"line":2336}}},"code":"\n@RequestMapping(value \u003d \"/cookie.mvc\", produces \u003d \"application/json\")\n@ResponseBody()\npublic List\u003cCookie\u003e showCookies(HttpSession session) {\n    WebSession ws \u003d getWebSession(session);\n    List\u003cCookie\u003e cookies \u003d ws.getCookiesOnLastRequest();\n    return cookies;\n}","loc":{"start":{"line":2052},"end":{"line":2164}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"showCookiesAndParamsAsHtml"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"RequestMapping","loc":{"start":{"line":2569},"end":{"line":2569}}},"arguments":[{"type":"AssignmentExpression","left":{"type":"Identifier","name":"value","loc":{"start":{"line":2584},"end":{"line":2584}}},"right":{"type":"Literal","value":"/cookies_widget.mvc","raw":"/cookies_widget.mvc","loc":{"start":{"line":2592},"end":{"line":2592}}},"loc":{"start":{"line":2584},"end":{"line":2590}}},{"type":"AssignmentExpression","left":{"type":"Identifier","name":"produces","loc":{"start":{"line":2615},"end":{"line":2615}}},"right":{"type":"Literal","value":"text/html","raw":"text/html","loc":{"start":{"line":2626},"end":{"line":2626}}},"loc":{"start":{"line":2615},"end":{"line":2624}}}]}]},"restype":{"type":"Identifier","name":"ModelAndView","loc":{"start":{"line":2650},"end":{"line":2650}}},"typarams":[],"params":[{"type":"Identifier","name":"session","vartype":{"type":"Identifier","name":"HttpSession","loc":{"start":{"line":2690},"end":{"line":2690}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"model","vartype":{"type":"Identifier","name":"ModelAndView","loc":{"start":{"line":2721},"end":{"line":2721}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ModelAndView","loc":{"start":{"line":2721},"end":{"line":2721}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ModelAndView","loc":{"start":{"line":2746},"end":{"line":2746}}},"arguments":[],"loc":{"start":{"line":2742},"end":{"line":2742}}},"loc":{"start":{"line":2721},"end":{"line":2734}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ws","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":2770},"end":{"line":2770}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":2770},"end":{"line":2770}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getWebSession","loc":{"start":{"line":2786},"end":{"line":2786}}},"arguments":[{"type":"Identifier","name":"session","loc":{"start":{"line":2800},"end":{"line":2800}}}],"loc":{"start":{"line":2786},"end":{"line":2799}}},"loc":{"start":{"line":2770},"end":{"line":2781}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"cookies","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":2818},"end":{"line":2818}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":2818},"end":{"line":2818}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ws","loc":{"start":{"line":2841},"end":{"line":2841}}},"property":{"type":"Identifier","name":"getCookiesOnLastRequest"},"loc":{"start":{"line":2841},"end":{"line":2843}}},"arguments":[],"loc":{"start":{"line":2841},"end":{"line":2867}}},"loc":{"start":{"line":2818},"end":{"line":2831}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"listParms","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":2879},"end":{"line":2879}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":2879},"end":{"line":2879}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ws","loc":{"start":{"line":2914},"end":{"line":2914}}},"property":{"type":"Identifier","name":"getParmsOnLastRequest"},"loc":{"start":{"line":2914},"end":{"line":2916}}},"arguments":[],"loc":{"start":{"line":2914},"end":{"line":2938}}},"loc":{"start":{"line":2879},"end":{"line":2902}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Collections","loc":{"start":{"line":2950},"end":{"line":2950}}},"property":{"type":"Identifier","name":"sort"},"loc":{"start":{"line":2950},"end":{"line":2961}}},"arguments":[{"type":"Identifier","name":"listParms","loc":{"start":{"line":2967},"end":{"line":2967}}}],"loc":{"start":{"line":2950},"end":{"line":2966}}},"loc":{"start":{"line":2950},"end":{"line":2950}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"model","loc":{"start":{"line":2987},"end":{"line":2987}}},"property":{"type":"Identifier","name":"addObject"},"loc":{"start":{"line":2987},"end":{"line":2992}}},"arguments":[{"type":"Literal","value":"wgcookies","raw":"wgcookies","loc":{"start":{"line":3003},"end":{"line":3003}}},{"type":"Identifier","name":"cookies","loc":{"start":{"line":3016},"end":{"line":3016}}}],"loc":{"start":{"line":2987},"end":{"line":3002}}},"loc":{"start":{"line":2987},"end":{"line":2987}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"model","loc":{"start":{"line":3034},"end":{"line":3034}}},"property":{"type":"Identifier","name":"addObject"},"loc":{"start":{"line":3034},"end":{"line":3039}}},"arguments":[{"type":"Literal","value":"wgparams","raw":"wgparams","loc":{"start":{"line":3050},"end":{"line":3050}}},{"type":"Identifier","name":"listParms","loc":{"start":{"line":3062},"end":{"line":3062}}}],"loc":{"start":{"line":3034},"end":{"line":3049}}},"loc":{"start":{"line":3034},"end":{"line":3034}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"model","loc":{"start":{"line":3082},"end":{"line":3082}}},"property":{"type":"Identifier","name":"setViewName"},"loc":{"start":{"line":3082},"end":{"line":3087}}},"arguments":[{"type":"Literal","value":"widgets/cookies_and_params","raw":"widgets/cookies_and_params","loc":{"start":{"line":3100},"end":{"line":3100}}}],"loc":{"start":{"line":3082},"end":{"line":3099}}},"loc":{"start":{"line":3082},"end":{"line":3082}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"model","loc":{"start":{"line":3146},"end":{"line":3146}}},"loc":{"start":{"line":3139},"end":{"line":3139}}}],"loc":{"start":{"line":2711},"end":{"line":3157}}},"code":"\n@RequestMapping(value \u003d \"/cookies_widget.mvc\", produces \u003d \"text/html\")\npublic ModelAndView showCookiesAndParamsAsHtml(HttpSession session) {\n    ModelAndView model \u003d new ModelAndView();\n    WebSession ws \u003d getWebSession(session);\n    List\u003cCookie\u003e cookies \u003d ws.getCookiesOnLastRequest();\n    List\u003cRequestParameter\u003e listParms \u003d ws.getParmsOnLastRequest();\n    Collections.sort(listParms);\n    model.addObject(\"wgcookies\", cookies);\n    model.addObject(\"wgparams\", listParms);\n    model.setViewName(\"widgets/cookies_and_params\");\n    return model;\n}","loc":{"start":{"line":2568},"end":{"line":2663}}}],"loc":{"start":{"line":1805},"end":{"line":1824}}}],"loc":{"start":{"line":1231},"end":{"line":1231}}}