{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1239},"end":{"line":1239}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1239},"end":{"line":1242}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1239},"end":{"line":1248}}},"property":{"type":"Identifier","name":"service"},"loc":{"start":{"line":1239},"end":{"line":1256}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1274},"end":{"line":1274}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1274},"end":{"line":1277}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1274},"end":{"line":1283}}},"property":{"type":"Identifier","name":"plugins"},"loc":{"start":{"line":1274},"end":{"line":1291}}},"property":{"type":"Identifier","name":"PluginsLoader"},"loc":{"start":{"line":1274},"end":{"line":1299}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1322},"end":{"line":1322}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1322},"end":{"line":1325}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1322},"end":{"line":1331}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":1322},"end":{"line":1339}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":1322},"end":{"line":1347}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1367},"end":{"line":1367}}},"property":{"type":"Identifier","name":"slf4j"},"loc":{"start":{"line":1367},"end":{"line":1370}}},"property":{"type":"Identifier","name":"Logger"},"loc":{"start":{"line":1367},"end":{"line":1376}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1392},"end":{"line":1392}}},"property":{"type":"Identifier","name":"slf4j"},"loc":{"start":{"line":1392},"end":{"line":1395}}},"property":{"type":"Identifier","name":"LoggerFactory"},"loc":{"start":{"line":1392},"end":{"line":1401}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1424},"end":{"line":1424}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":1424},"end":{"line":1427}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":1424},"end":{"line":1443}}},"property":{"type":"Identifier","name":"HttpStatus"},"loc":{"start":{"line":1424},"end":{"line":1448}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1468},"end":{"line":1468}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":1468},"end":{"line":1471}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":1468},"end":{"line":1487}}},"property":{"type":"Identifier","name":"ResponseEntity"},"loc":{"start":{"line":1468},"end":{"line":1492}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1516},"end":{"line":1516}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":1516},"end":{"line":1519}}},"property":{"type":"Identifier","name":"stereotype"},"loc":{"start":{"line":1516},"end":{"line":1535}}},"property":{"type":"Identifier","name":"Controller"},"loc":{"start":{"line":1516},"end":{"line":1546}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1566},"end":{"line":1566}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":1566},"end":{"line":1569}}},"property":{"type":"Identifier","name":"web"},"loc":{"start":{"line":1566},"end":{"line":1585}}},"property":{"type":"Identifier","name":"bind"},"loc":{"start":{"line":1566},"end":{"line":1589}}},"property":{"type":"Identifier","name":"annotation"},"loc":{"start":{"line":1566},"end":{"line":1594}}},"property":{"type":"Identifier","name":"RequestMapping"},"loc":{"start":{"line":1566},"end":{"line":1605}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1629},"end":{"line":1629}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":1629},"end":{"line":1632}}},"property":{"type":"Identifier","name":"web"},"loc":{"start":{"line":1629},"end":{"line":1648}}},"property":{"type":"Identifier","name":"bind"},"loc":{"start":{"line":1629},"end":{"line":1652}}},"property":{"type":"Identifier","name":"annotation"},"loc":{"start":{"line":1629},"end":{"line":1657}}},"property":{"type":"Identifier","name":"ResponseBody"},"loc":{"start":{"line":1629},"end":{"line":1668}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":1691},"end":{"line":1691}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":1691},"end":{"line":1696}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":1691},"end":{"line":1704}}},"property":{"type":"Identifier","name":"HttpSession"},"loc":{"start":{"line":1691},"end":{"line":1709}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":1730},"end":{"line":1730}}},"property":{"type":"Identifier","name":"nio"},"loc":{"start":{"line":1730},"end":{"line":1734}}},"property":{"type":"Identifier","name":"file"},"loc":{"start":{"line":1730},"end":{"line":1738}}},"property":{"type":"Identifier","name":"Paths"},"loc":{"start":{"line":1730},"end":{"line":1743}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"PluginReloadService"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Controller","loc":{"start":{"line":1840},"end":{"line":1840}}},"arguments":[]}]},"extending":{"type":"Identifier","name":"BaseService","loc":{"start":{"line":1892},"end":{"line":1892}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"logger","vartype":{"type":"Identifier","name":"Logger","loc":{"start":{"line":1932},"end":{"line":1932}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"Logger","loc":{"start":{"line":1932},"end":{"line":1932}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"LoggerFactory","loc":{"start":{"line":1948},"end":{"line":1948}}},"property":{"type":"Identifier","name":"getLogger"},"loc":{"start":{"line":1948},"end":{"line":1961}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"PluginReloadService","loc":{"start":{"line":1972},"end":{"line":1972}}},"property":{"type":"Identifier","name":"class"},"loc":{"start":{"line":1972},"end":{"line":1991}}}],"loc":{"start":{"line":1948},"end":{"line":1971}}},"loc":{"start":{"line":1911},"end":{"line":1939}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"reloadPlugins"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"RequestMapping","loc":{"start":{"line":2111},"end":{"line":2111}}},"arguments":[{"type":"AssignmentExpression","left":{"type":"Identifier","name":"value","loc":{"start":{"line":2126},"end":{"line":2126}}},"right":{"type":"Literal","value":"/reloadplugins.mvc","raw":"/reloadplugins.mvc","loc":{"start":{"line":2134},"end":{"line":2134}}},"loc":{"start":{"line":2126},"end":{"line":2132}}}]},{"type":"Annotation","annotationType":{"type":"Identifier","name":"ResponseBody","loc":{"start":{"line":2168},"end":{"line":2168}}},"arguments":[]}]},"restype":{"type":"Identifier","name":"ResponseEntity","loc":{"start":{"line":2185},"end":{"line":2185}}},"typarams":[],"params":[{"type":"Identifier","name":"session","vartype":{"type":"Identifier","name":"HttpSession","loc":{"start":{"line":2222},"end":{"line":2222}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"webSession","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":2253},"end":{"line":2253}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":2253},"end":{"line":2253}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":2278},"end":{"line":2278}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":2290},"end":{"line":2290}}},"property":{"type":"Identifier","name":"getAttribute"},"loc":{"start":{"line":2290},"end":{"line":2297}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":2311},"end":{"line":2311}}},"property":{"type":"Identifier","name":"SESSION"},"loc":{"start":{"line":2311},"end":{"line":2321}}}],"loc":{"start":{"line":2290},"end":{"line":2310}}},"loc":{"start":{"line":2277},"end":{"line":2277}}},"loc":{"start":{"line":2253},"end":{"line":2264}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"logger","loc":{"start":{"line":2340},"end":{"line":2340}}},"property":{"type":"Identifier","name":"debug"},"loc":{"start":{"line":2340},"end":{"line":2346}}},"arguments":[{"type":"Literal","value":"Loading plugins into cache","raw":"Loading plugins into cache","loc":{"start":{"line":2353},"end":{"line":2353}}}],"loc":{"start":{"line":2340},"end":{"line":2352}}},"loc":{"start":{"line":2340},"end":{"line":2340}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"pluginPath","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2392},"end":{"line":2392}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2392},"end":{"line":2392}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":2412},"end":{"line":2412}}},"property":{"type":"Identifier","name":"getServletContext"},"loc":{"start":{"line":2412},"end":{"line":2419}}},"arguments":[],"loc":{"start":{"line":2412},"end":{"line":2437}}},"property":{"type":"Identifier","name":"getRealPath"},"loc":{"start":{"line":2412},"end":{"line":2439}}},"arguments":[{"type":"Literal","value":"plugin_lessons","raw":"plugin_lessons","loc":{"start":{"line":2452},"end":{"line":2452}}}],"loc":{"start":{"line":2412},"end":{"line":2451}}},"loc":{"start":{"line":2392},"end":{"line":2399}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"targetPath","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2479},"end":{"line":2479}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2479},"end":{"line":2479}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":2499},"end":{"line":2499}}},"property":{"type":"Identifier","name":"getServletContext"},"loc":{"start":{"line":2499},"end":{"line":2506}}},"arguments":[],"loc":{"start":{"line":2499},"end":{"line":2524}}},"property":{"type":"Identifier","name":"getRealPath"},"loc":{"start":{"line":2499},"end":{"line":2526}}},"arguments":[{"type":"Literal","value":"plugin_extracted","raw":"plugin_extracted","loc":{"start":{"line":2539},"end":{"line":2539}}}],"loc":{"start":{"line":2499},"end":{"line":2538}}},"loc":{"start":{"line":2479},"end":{"line":2486}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"PluginsLoader","loc":{"start":{"line":2572},"end":{"line":2572}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Paths","loc":{"start":{"line":2586},"end":{"line":2586}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":2586},"end":{"line":2591}}},"arguments":[{"type":"Identifier","name":"pluginPath","loc":{"start":{"line":2596},"end":{"line":2596}}}],"loc":{"start":{"line":2586},"end":{"line":2595}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Paths","loc":{"start":{"line":2609},"end":{"line":2609}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":2609},"end":{"line":2614}}},"arguments":[{"type":"Identifier","name":"targetPath","loc":{"start":{"line":2619},"end":{"line":2619}}}],"loc":{"start":{"line":2609},"end":{"line":2618}}}],"loc":{"start":{"line":2568},"end":{"line":2568}}},"property":{"type":"Identifier","name":"copyJars"},"loc":{"start":{"line":2568},"end":{"line":2631}}},"arguments":[],"loc":{"start":{"line":2568},"end":{"line":2640}}},"loc":{"start":{"line":2568},"end":{"line":2568}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"webSession","loc":{"start":{"line":2653},"end":{"line":2653}}},"property":{"type":"Identifier","name":"getCourse"},"loc":{"start":{"line":2653},"end":{"line":2663}}},"arguments":[],"loc":{"start":{"line":2653},"end":{"line":2673}}},"property":{"type":"Identifier","name":"loadLessonFromPlugin"},"loc":{"start":{"line":2653},"end":{"line":2675}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":2697},"end":{"line":2697}}},"property":{"type":"Identifier","name":"getServletContext"},"loc":{"start":{"line":2697},"end":{"line":2704}}},"arguments":[],"loc":{"start":{"line":2697},"end":{"line":2722}}}],"loc":{"start":{"line":2653},"end":{"line":2696}}},"loc":{"start":{"line":2653},"end":{"line":2653}}},{"type":"ReturnStatement","argument":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ResponseEntity","loc":{"start":{"line":2746},"end":{"line":2746}}},"arguments":[{"type":"Literal","value":"Plugins reload refresh the WebGoat page!","raw":"Plugins reload refresh the WebGoat page!","loc":{"start":{"line":2761},"end":{"line":2761}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"HttpStatus","loc":{"start":{"line":2804},"end":{"line":2804}}},"property":{"type":"Identifier","name":"OK"},"loc":{"start":{"line":2804},"end":{"line":2814}}}],"loc":{"start":{"line":2742},"end":{"line":2742}}},"loc":{"start":{"line":2735},"end":{"line":2735}}}],"loc":{"start":{"line":2243},"end":{"line":2824}}},"code":"\n@RequestMapping(value \u003d \"/reloadplugins.mvc\")\n@ResponseBody()\npublic ResponseEntity\u003cString\u003e reloadPlugins(HttpSession session) {\n    WebSession webSession \u003d (WebSession)session.getAttribute(WebSession.SESSION);\n    logger.debug(\"Loading plugins into cache\");\n    String pluginPath \u003d session.getServletContext().getRealPath(\"plugin_lessons\");\n    String targetPath \u003d session.getServletContext().getRealPath(\"plugin_extracted\");\n    new PluginsLoader(Paths.get(pluginPath), Paths.get(targetPath)).copyJars();\n    webSession.getCourse().loadLessonFromPlugin(session.getServletContext());\n    return new ResponseEntity(\"Plugins reload refresh the WebGoat page!\", HttpStatus.OK);\n}","loc":{"start":{"line":2110},"end":{"line":2208}}}],"loc":{"start":{"line":1839},"end":{"line":1858}}}],"loc":{"start":{"line":1231},"end":{"line":1231}}}