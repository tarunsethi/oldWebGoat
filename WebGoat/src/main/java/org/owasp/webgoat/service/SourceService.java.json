{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1239},"end":{"line":1239}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1239},"end":{"line":1242}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1239},"end":{"line":1248}}},"property":{"type":"Identifier","name":"service"},"loc":{"start":{"line":1239},"end":{"line":1256}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1274},"end":{"line":1274}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":1274},"end":{"line":1277}}},"property":{"type":"Identifier","name":"commons"},"loc":{"start":{"line":1274},"end":{"line":1284}}},"property":{"type":"Identifier","name":"lang3"},"loc":{"start":{"line":1274},"end":{"line":1292}}},"property":{"type":"Identifier","name":"StringEscapeUtils"},"loc":{"start":{"line":1274},"end":{"line":1298}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1325},"end":{"line":1325}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1325},"end":{"line":1328}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1325},"end":{"line":1334}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":1325},"end":{"line":1342}}},"property":{"type":"Identifier","name":"AbstractLesson"},"loc":{"start":{"line":1325},"end":{"line":1350}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1374},"end":{"line":1374}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1374},"end":{"line":1377}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1374},"end":{"line":1383}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":1374},"end":{"line":1391}}},"property":{"type":"Identifier","name":"Course"},"loc":{"start":{"line":1374},"end":{"line":1399}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1415},"end":{"line":1415}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1415},"end":{"line":1418}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1415},"end":{"line":1424}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":1415},"end":{"line":1432}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":1415},"end":{"line":1440}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1460},"end":{"line":1460}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":1460},"end":{"line":1463}}},"property":{"type":"Identifier","name":"stereotype"},"loc":{"start":{"line":1460},"end":{"line":1479}}},"property":{"type":"Identifier","name":"Controller"},"loc":{"start":{"line":1460},"end":{"line":1490}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1510},"end":{"line":1510}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":1510},"end":{"line":1513}}},"property":{"type":"Identifier","name":"web"},"loc":{"start":{"line":1510},"end":{"line":1529}}},"property":{"type":"Identifier","name":"bind"},"loc":{"start":{"line":1510},"end":{"line":1533}}},"property":{"type":"Identifier","name":"annotation"},"loc":{"start":{"line":1510},"end":{"line":1538}}},"property":{"type":"Identifier","name":"RequestMapping"},"loc":{"start":{"line":1510},"end":{"line":1549}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1573},"end":{"line":1573}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":1573},"end":{"line":1576}}},"property":{"type":"Identifier","name":"web"},"loc":{"start":{"line":1573},"end":{"line":1592}}},"property":{"type":"Identifier","name":"bind"},"loc":{"start":{"line":1573},"end":{"line":1596}}},"property":{"type":"Identifier","name":"annotation"},"loc":{"start":{"line":1573},"end":{"line":1601}}},"property":{"type":"Identifier","name":"ResponseBody"},"loc":{"start":{"line":1573},"end":{"line":1612}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":1635},"end":{"line":1635}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":1635},"end":{"line":1640}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":1635},"end":{"line":1648}}},"property":{"type":"Identifier","name":"HttpSession"},"loc":{"start":{"line":1635},"end":{"line":1653}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1682},"end":{"line":1682}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1682},"end":{"line":1685}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1682},"end":{"line":1691}}},"property":{"type":"Identifier","name":"LessonSource"},"loc":{"start":{"line":1682},"end":{"line":1699}}},"property":{"type":"Identifier","name":"END_SOURCE_SKIP"},"loc":{"start":{"line":1682},"end":{"line":1712}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1744},"end":{"line":1744}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1744},"end":{"line":1747}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1744},"end":{"line":1753}}},"property":{"type":"Identifier","name":"LessonSource"},"loc":{"start":{"line":1744},"end":{"line":1761}}},"property":{"type":"Identifier","name":"START_SOURCE_SKIP"},"loc":{"start":{"line":1744},"end":{"line":1774}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"SourceService"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Controller","loc":{"start":{"line":1878},"end":{"line":1878}}},"arguments":[]}]},"extending":{"type":"Identifier","name":"BaseService","loc":{"start":{"line":1924},"end":{"line":1924}}},"definitions":[{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"showSource"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"RequestMapping","loc":{"start":{"line":2129},"end":{"line":2129}}},"arguments":[{"type":"AssignmentExpression","left":{"type":"Identifier","name":"value","loc":{"start":{"line":2144},"end":{"line":2144}}},"right":{"type":"Literal","value":"/source.mvc","raw":"/source.mvc","loc":{"start":{"line":2152},"end":{"line":2152}}},"loc":{"start":{"line":2144},"end":{"line":2150}}},{"type":"AssignmentExpression","left":{"type":"Identifier","name":"produces","loc":{"start":{"line":2167},"end":{"line":2167}}},"right":{"type":"Literal","value":"application/text","raw":"application/text","loc":{"start":{"line":2178},"end":{"line":2178}}},"loc":{"start":{"line":2167},"end":{"line":2176}}}]},{"type":"Annotation","annotationType":{"type":"Identifier","name":"ResponseBody","loc":{"start":{"line":2210},"end":{"line":2210}}},"arguments":[]}]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":2227},"end":{"line":2227}}},"typarams":[],"params":[{"type":"Identifier","name":"session","vartype":{"type":"Identifier","name":"HttpSession","loc":{"start":{"line":2245},"end":{"line":2245}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ws","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":2276},"end":{"line":2276}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":2276},"end":{"line":2276}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getWebSession","loc":{"start":{"line":2292},"end":{"line":2292}}},"arguments":[{"type":"Identifier","name":"session","loc":{"start":{"line":2306},"end":{"line":2306}}}],"loc":{"start":{"line":2292},"end":{"line":2305}}},"loc":{"start":{"line":2276},"end":{"line":2287}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"source","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2324},"end":{"line":2324}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2324},"end":{"line":2324}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getSource","loc":{"start":{"line":2340},"end":{"line":2340}}},"arguments":[{"type":"Identifier","name":"ws","loc":{"start":{"line":2350},"end":{"line":2350}}}],"loc":{"start":{"line":2340},"end":{"line":2349}}},"loc":{"start":{"line":2324},"end":{"line":2331}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"source","loc":{"start":{"line":2367},"end":{"line":2367}}},"right":{"type":"Literal","loc":{"start":{"line":2377},"end":{"line":2377}}},"loc":{"start":{"line":2367},"end":{"line":2374}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"source","loc":{"start":{"line":2397},"end":{"line":2397}}},"right":{"type":"Literal","value":"No source listing found","raw":"No source listing found","loc":{"start":{"line":2406},"end":{"line":2406}}},"loc":{"start":{"line":2397},"end":{"line":2404}}},"loc":{"start":{"line":2397},"end":{"line":2397}}}],"loc":{"start":{"line":2383},"end":{"line":2441}}},"loc":{"start":{"line":2363},"end":{"line":2363}}},{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"StringEscapeUtils","loc":{"start":{"line":2458},"end":{"line":2458}}},"property":{"type":"Identifier","name":"escapeHtml4"},"loc":{"start":{"line":2458},"end":{"line":2475}}},"arguments":[{"type":"Identifier","name":"source","loc":{"start":{"line":2488},"end":{"line":2488}}}],"loc":{"start":{"line":2458},"end":{"line":2487}}},"loc":{"start":{"line":2451},"end":{"line":2451}}}],"loc":{"start":{"line":2266},"end":{"line":2501}}},"code":"\n@RequestMapping(value \u003d \"/source.mvc\", produces \u003d \"application/text\")\n@ResponseBody()\npublic String showSource(HttpSession session) {\n    WebSession ws \u003d getWebSession(session);\n    String source \u003d getSource(ws);\n    if (source \u003d\u003d null) {\n        source \u003d \"No source listing found\";\n    }\n    return StringEscapeUtils.escapeHtml4(source);\n}","loc":{"start":{"line":2128},"end":{"line":2234}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getSource"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":2666},"end":{"line":2666}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":2683},"end":{"line":2683}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"source","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2708},"end":{"line":2708}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2708},"end":{"line":2708}}},"init":{"type":"Literal","loc":{"start":{"line":2724},"end":{"line":2724}}},"loc":{"start":{"line":2708},"end":{"line":2715}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"scr","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":2748},"end":{"line":2748}}},"property":{"type":"Identifier","name":"getCurrentScreen"},"loc":{"start":{"line":2748},"end":{"line":2749}}},"arguments":[],"loc":{"start":{"line":2748},"end":{"line":2766}}},"loc":{"start":{"line":2738},"end":{"line":2742}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"course","vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":2778},"end":{"line":2778}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":2778},"end":{"line":2778}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":2794},"end":{"line":2794}}},"property":{"type":"Identifier","name":"getCourse"},"loc":{"start":{"line":2794},"end":{"line":2795}}},"arguments":[],"loc":{"start":{"line":2794},"end":{"line":2805}}},"loc":{"start":{"line":2778},"end":{"line":2785}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":2822},"end":{"line":2822}}},"property":{"type":"Identifier","name":"isUser"},"loc":{"start":{"line":2822},"end":{"line":2823}}},"arguments":[],"loc":{"start":{"line":2822},"end":{"line":2830}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":2836},"end":{"line":2836}}},"property":{"type":"Identifier","name":"isChallenge"},"loc":{"start":{"line":2836},"end":{"line":2837}}},"arguments":[],"loc":{"start":{"line":2836},"end":{"line":2849}}},"loc":{"start":{"line":2822},"end":{"line":2833}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":2868},"end":{"line":2868}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":2868},"end":{"line":2868}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"course","loc":{"start":{"line":2892},"end":{"line":2892}}},"property":{"type":"Identifier","name":"getLesson"},"loc":{"start":{"line":2892},"end":{"line":2898}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":2909},"end":{"line":2909}}},{"type":"Identifier","name":"scr","loc":{"start":{"line":2912},"end":{"line":2912}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":2917},"end":{"line":2917}}},"property":{"type":"Identifier","name":"USER_ROLE"},"loc":{"start":{"line":2917},"end":{"line":2931}}}],"loc":{"start":{"line":2892},"end":{"line":2908}}},"loc":{"start":{"line":2868},"end":{"line":2883}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":2961},"end":{"line":2961}}},"right":{"type":"Literal","loc":{"start":{"line":2971},"end":{"line":2971}}},"loc":{"start":{"line":2961},"end":{"line":2968}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"source","loc":{"start":{"line":2995},"end":{"line":2995}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":3004},"end":{"line":3004}}},"property":{"type":"Identifier","name":"getRawSource"},"loc":{"start":{"line":3004},"end":{"line":3010}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":3024},"end":{"line":3024}}}],"loc":{"start":{"line":3004},"end":{"line":3023}}},"loc":{"start":{"line":2995},"end":{"line":3002}}},"loc":{"start":{"line":2995},"end":{"line":2995}}}],"loc":{"start":{"line":2977},"end":{"line":3040}}},"loc":{"start":{"line":2957},"end":{"line":2957}}}],"loc":{"start":{"line":2853},"end":{"line":3050}}},"loc":{"start":{"line":2818},"end":{"line":2818}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"source","loc":{"start":{"line":3064},"end":{"line":3064}}},"right":{"type":"Literal","loc":{"start":{"line":3074},"end":{"line":3074}}},"loc":{"start":{"line":3064},"end":{"line":3071}}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Literal","value":"Source code is not available for this lesson.","raw":"Source code is not available for this lesson.","loc":{"start":{"line":3101},"end":{"line":3101}}},"loc":{"start":{"line":3094},"end":{"line":3094}}}],"loc":{"start":{"line":3080},"end":{"line":3158}}},"loc":{"start":{"line":3060},"end":{"line":3060}}},{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"source","loc":{"start":{"line":3176},"end":{"line":3176}}},"property":{"type":"Identifier","name":"replaceAll"},"loc":{"start":{"line":3176},"end":{"line":3182}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"(?s)","raw":"(?s)","loc":{"start":{"line":3194},"end":{"line":3194}}},"right":{"type":"Identifier","name":"START_SOURCE_SKIP","loc":{"start":{"line":3203},"end":{"line":3203}}},"loc":{"start":{"line":3194},"end":{"line":3201}}},"right":{"type":"Literal","value":".*","raw":".*","loc":{"start":{"line":3223},"end":{"line":3223}}},"loc":{"start":{"line":3194},"end":{"line":3221}}},"right":{"type":"Identifier","name":"END_SOURCE_SKIP","loc":{"start":{"line":3230},"end":{"line":3230}}},"loc":{"start":{"line":3194},"end":{"line":3228}}},{"type":"Literal","value":"Code Section Deliberately Omitted","raw":"Code Section Deliberately Omitted","loc":{"start":{"line":3263},"end":{"line":3263}}}],"loc":{"start":{"line":3176},"end":{"line":3193}}},"loc":{"start":{"line":3168},"end":{"line":3168}}}],"loc":{"start":{"line":2697},"end":{"line":3306}}},"code":"\nprotected String getSource(WebSession s) {\n    String source \u003d null;\n    int scr \u003d s.getCurrentScreen();\n    Course course \u003d s.getCourse();\n    if (s.isUser() || s.isChallenge()) {\n        AbstractLesson lesson \u003d course.getLesson(s, scr, AbstractLesson.USER_ROLE);\n        if (lesson !\u003d null) {\n            source \u003d lesson.getRawSource(s);\n        }\n    }\n    if (source \u003d\u003d null) {\n        return \"Source code is not available for this lesson.\";\n    }\n    return (source.replaceAll(\"(?s)\" + START_SOURCE_SKIP + \".*\" + END_SOURCE_SKIP, \"Code Section Deliberately Omitted\"));\n}","loc":{"start":{"line":2656},"end":{"line":2673}}}],"loc":{"start":{"line":1877},"end":{"line":1896}}}],"loc":{"start":{"line":1231},"end":{"line":1231}}}