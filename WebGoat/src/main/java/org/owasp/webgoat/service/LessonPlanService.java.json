{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1239},"end":{"line":1239}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1239},"end":{"line":1242}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1239},"end":{"line":1248}}},"property":{"type":"Identifier","name":"service"},"loc":{"start":{"line":1239},"end":{"line":1256}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":1274},"end":{"line":1274}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":1274},"end":{"line":1279}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":1274},"end":{"line":1287}}},"property":{"type":"Identifier","name":"HttpSession"},"loc":{"start":{"line":1274},"end":{"line":1292}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1320},"end":{"line":1320}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1320},"end":{"line":1323}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1320},"end":{"line":1329}}},"property":{"type":"Identifier","name":"LessonSource"},"loc":{"start":{"line":1320},"end":{"line":1337}}},"property":{"type":"Identifier","name":"END_SOURCE_SKIP"},"loc":{"start":{"line":1320},"end":{"line":1350}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1382},"end":{"line":1382}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1382},"end":{"line":1385}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1382},"end":{"line":1391}}},"property":{"type":"Identifier","name":"LessonSource"},"loc":{"start":{"line":1382},"end":{"line":1399}}},"property":{"type":"Identifier","name":"START_SOURCE_SKIP"},"loc":{"start":{"line":1382},"end":{"line":1412}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1439},"end":{"line":1439}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1439},"end":{"line":1442}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1439},"end":{"line":1448}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":1439},"end":{"line":1456}}},"property":{"type":"Identifier","name":"AbstractLesson"},"loc":{"start":{"line":1439},"end":{"line":1464}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1488},"end":{"line":1488}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1488},"end":{"line":1491}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1488},"end":{"line":1497}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":1488},"end":{"line":1505}}},"property":{"type":"Identifier","name":"model"},"loc":{"start":{"line":1488},"end":{"line":1513}}},"property":{"type":"Identifier","name":"SourceListing"},"loc":{"start":{"line":1488},"end":{"line":1519}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1542},"end":{"line":1542}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1542},"end":{"line":1545}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1542},"end":{"line":1551}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":1542},"end":{"line":1559}}},"property":{"type":"Identifier","name":"Course"},"loc":{"start":{"line":1542},"end":{"line":1567}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1583},"end":{"line":1583}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1583},"end":{"line":1586}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1583},"end":{"line":1592}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":1583},"end":{"line":1600}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":1583},"end":{"line":1608}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1628},"end":{"line":1628}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":1628},"end":{"line":1631}}},"property":{"type":"Identifier","name":"stereotype"},"loc":{"start":{"line":1628},"end":{"line":1647}}},"property":{"type":"Identifier","name":"Controller"},"loc":{"start":{"line":1628},"end":{"line":1658}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1678},"end":{"line":1678}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":1678},"end":{"line":1681}}},"property":{"type":"Identifier","name":"web"},"loc":{"start":{"line":1678},"end":{"line":1697}}},"property":{"type":"Identifier","name":"bind"},"loc":{"start":{"line":1678},"end":{"line":1701}}},"property":{"type":"Identifier","name":"annotation"},"loc":{"start":{"line":1678},"end":{"line":1706}}},"property":{"type":"Identifier","name":"RequestMapping"},"loc":{"start":{"line":1678},"end":{"line":1717}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1741},"end":{"line":1741}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":1741},"end":{"line":1744}}},"property":{"type":"Identifier","name":"web"},"loc":{"start":{"line":1741},"end":{"line":1760}}},"property":{"type":"Identifier","name":"bind"},"loc":{"start":{"line":1741},"end":{"line":1764}}},"property":{"type":"Identifier","name":"annotation"},"loc":{"start":{"line":1741},"end":{"line":1769}}},"property":{"type":"Identifier","name":"ResponseBody"},"loc":{"start":{"line":1741},"end":{"line":1780}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"LessonPlanService"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Controller","loc":{"start":{"line":1883},"end":{"line":1883}}},"arguments":[]}]},"extending":{"type":"Identifier","name":"BaseService","loc":{"start":{"line":1933},"end":{"line":1933}}},"definitions":[{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"showPlan"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"RequestMapping","loc":{"start":{"line":2138},"end":{"line":2138}}},"arguments":[{"type":"AssignmentExpression","left":{"type":"Identifier","name":"value","loc":{"start":{"line":2153},"end":{"line":2153}}},"right":{"type":"Literal","value":"/lessonplan.mvc","raw":"/lessonplan.mvc","loc":{"start":{"line":2161},"end":{"line":2161}}},"loc":{"start":{"line":2153},"end":{"line":2159}}},{"type":"AssignmentExpression","left":{"type":"Identifier","name":"produces","loc":{"start":{"line":2180},"end":{"line":2180}}},"right":{"type":"Literal","value":"application/html","raw":"application/html","loc":{"start":{"line":2191},"end":{"line":2191}}},"loc":{"start":{"line":2180},"end":{"line":2189}}}]},{"type":"Annotation","annotationType":{"type":"Identifier","name":"ResponseBody","loc":{"start":{"line":2223},"end":{"line":2223}}},"arguments":[]}]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":2240},"end":{"line":2240}}},"typarams":[],"params":[{"type":"Identifier","name":"session","vartype":{"type":"Identifier","name":"HttpSession","loc":{"start":{"line":2256},"end":{"line":2256}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ws","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":2287},"end":{"line":2287}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":2287},"end":{"line":2287}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getWebSession","loc":{"start":{"line":2303},"end":{"line":2303}}},"arguments":[{"type":"Identifier","name":"session","loc":{"start":{"line":2317},"end":{"line":2317}}}],"loc":{"start":{"line":2303},"end":{"line":2316}}},"loc":{"start":{"line":2287},"end":{"line":2298}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"plan","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2335},"end":{"line":2335}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2335},"end":{"line":2335}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getPlan","loc":{"start":{"line":2349},"end":{"line":2349}}},"arguments":[{"type":"Identifier","name":"ws","loc":{"start":{"line":2357},"end":{"line":2357}}}],"loc":{"start":{"line":2349},"end":{"line":2356}}},"loc":{"start":{"line":2335},"end":{"line":2342}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"plan","loc":{"start":{"line":2377},"end":{"line":2377}}},"loc":{"start":{"line":2370},"end":{"line":2370}}}],"loc":{"start":{"line":2277},"end":{"line":2490}}},"code":"\n@RequestMapping(value \u003d \"/lessonplan.mvc\", produces \u003d \"application/html\")\n@ResponseBody()\npublic String showPlan(HttpSession session) {\n    WebSession ws \u003d getWebSession(session);\n    String plan \u003d getPlan(ws);\n    return plan;\n}","loc":{"start":{"line":2137},"end":{"line":2247}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getPlan"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":2655},"end":{"line":2655}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":2670},"end":{"line":2670}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"plan","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2695},"end":{"line":2695}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2695},"end":{"line":2695}}},"init":{"type":"Literal","loc":{"start":{"line":2709},"end":{"line":2709}}},"loc":{"start":{"line":2695},"end":{"line":2702}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"scr","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":2733},"end":{"line":2733}}},"property":{"type":"Identifier","name":"getCurrentScreen"},"loc":{"start":{"line":2733},"end":{"line":2734}}},"arguments":[],"loc":{"start":{"line":2733},"end":{"line":2751}}},"loc":{"start":{"line":2723},"end":{"line":2727}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"course","vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":2763},"end":{"line":2763}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":2763},"end":{"line":2763}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":2779},"end":{"line":2779}}},"property":{"type":"Identifier","name":"getCourse"},"loc":{"start":{"line":2779},"end":{"line":2780}}},"arguments":[],"loc":{"start":{"line":2779},"end":{"line":2790}}},"loc":{"start":{"line":2763},"end":{"line":2770}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":2807},"end":{"line":2807}}},"property":{"type":"Identifier","name":"isUser"},"loc":{"start":{"line":2807},"end":{"line":2808}}},"arguments":[],"loc":{"start":{"line":2807},"end":{"line":2815}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":2821},"end":{"line":2821}}},"property":{"type":"Identifier","name":"isChallenge"},"loc":{"start":{"line":2821},"end":{"line":2822}}},"arguments":[],"loc":{"start":{"line":2821},"end":{"line":2834}}},"loc":{"start":{"line":2807},"end":{"line":2818}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":2853},"end":{"line":2853}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":2853},"end":{"line":2853}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"course","loc":{"start":{"line":2877},"end":{"line":2877}}},"property":{"type":"Identifier","name":"getLesson"},"loc":{"start":{"line":2877},"end":{"line":2883}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":2894},"end":{"line":2894}}},{"type":"Identifier","name":"scr","loc":{"start":{"line":2897},"end":{"line":2897}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":2902},"end":{"line":2902}}},"property":{"type":"Identifier","name":"USER_ROLE"},"loc":{"start":{"line":2902},"end":{"line":2916}}}],"loc":{"start":{"line":2877},"end":{"line":2893}}},"loc":{"start":{"line":2853},"end":{"line":2868}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":2946},"end":{"line":2946}}},"right":{"type":"Literal","loc":{"start":{"line":2956},"end":{"line":2956}}},"loc":{"start":{"line":2946},"end":{"line":2953}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"plan","loc":{"start":{"line":2980},"end":{"line":2980}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":2987},"end":{"line":2987}}},"property":{"type":"Identifier","name":"getLessonPlan"},"loc":{"start":{"line":2987},"end":{"line":2993}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":3008},"end":{"line":3008}}}],"loc":{"start":{"line":2987},"end":{"line":3007}}},"loc":{"start":{"line":2980},"end":{"line":2985}}},"loc":{"start":{"line":2980},"end":{"line":2980}}}],"loc":{"start":{"line":2962},"end":{"line":3024}}},"loc":{"start":{"line":2942},"end":{"line":2942}}}],"loc":{"start":{"line":2838},"end":{"line":3034}}},"loc":{"start":{"line":2803},"end":{"line":2803}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"plan","loc":{"start":{"line":3048},"end":{"line":3048}}},"right":{"type":"Literal","loc":{"start":{"line":3056},"end":{"line":3056}}},"loc":{"start":{"line":3048},"end":{"line":3053}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"plan","loc":{"start":{"line":3076},"end":{"line":3076}}},"right":{"type":"Literal","value":"Plan is not available for this lesson.","raw":"Plan is not available for this lesson.","loc":{"start":{"line":3083},"end":{"line":3083}}},"loc":{"start":{"line":3076},"end":{"line":3081}}},"loc":{"start":{"line":3076},"end":{"line":3076}}}],"loc":{"start":{"line":3062},"end":{"line":3133}}},"loc":{"start":{"line":3044},"end":{"line":3044}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"plan","loc":{"start":{"line":3150},"end":{"line":3150}}},"loc":{"start":{"line":3143},"end":{"line":3143}}}],"loc":{"start":{"line":2684},"end":{"line":3160}}},"code":"\nprotected String getPlan(WebSession s) {\n    String plan \u003d null;\n    int scr \u003d s.getCurrentScreen();\n    Course course \u003d s.getCourse();\n    if (s.isUser() || s.isChallenge()) {\n        AbstractLesson lesson \u003d course.getLesson(s, scr, AbstractLesson.USER_ROLE);\n        if (lesson !\u003d null) {\n            plan \u003d lesson.getLessonPlan(s);\n        }\n    }\n    if (plan \u003d\u003d null) {\n        plan \u003d \"Plan is not available for this lesson.\";\n    }\n    return plan;\n}","loc":{"start":{"line":2645},"end":{"line":2662}}}],"loc":{"start":{"line":1882},"end":{"line":1901}}}],"loc":{"start":{"line":1231},"end":{"line":1231}}}