{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":8},"end":{"line":11}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":8},"end":{"line":17}}},"property":{"type":"Identifier","name":"service"},"loc":{"start":{"line":8},"end":{"line":25}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":43},"end":{"line":43}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":43},"end":{"line":48}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":43},"end":{"line":56}}},"property":{"type":"Identifier","name":"HttpSession"},"loc":{"start":{"line":43},"end":{"line":61}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":83},"end":{"line":83}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":83},"end":{"line":86}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":83},"end":{"line":92}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":83},"end":{"line":100}}},"property":{"type":"Identifier","name":"AbstractLesson"},"loc":{"start":{"line":83},"end":{"line":108}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":132},"end":{"line":132}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":132},"end":{"line":135}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":132},"end":{"line":141}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":132},"end":{"line":149}}},"property":{"type":"Identifier","name":"Course"},"loc":{"start":{"line":132},"end":{"line":157}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":173},"end":{"line":173}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":173},"end":{"line":176}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":173},"end":{"line":182}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":173},"end":{"line":190}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":173},"end":{"line":198}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":218},"end":{"line":218}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":218},"end":{"line":221}}},"property":{"type":"Identifier","name":"stereotype"},"loc":{"start":{"line":218},"end":{"line":237}}},"property":{"type":"Identifier","name":"Controller"},"loc":{"start":{"line":218},"end":{"line":248}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":268},"end":{"line":268}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":268},"end":{"line":271}}},"property":{"type":"Identifier","name":"web"},"loc":{"start":{"line":268},"end":{"line":287}}},"property":{"type":"Identifier","name":"bind"},"loc":{"start":{"line":268},"end":{"line":291}}},"property":{"type":"Identifier","name":"annotation"},"loc":{"start":{"line":268},"end":{"line":296}}},"property":{"type":"Identifier","name":"RequestMapping"},"loc":{"start":{"line":268},"end":{"line":307}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":331},"end":{"line":331}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":331},"end":{"line":334}}},"property":{"type":"Identifier","name":"web"},"loc":{"start":{"line":331},"end":{"line":350}}},"property":{"type":"Identifier","name":"bind"},"loc":{"start":{"line":331},"end":{"line":354}}},"property":{"type":"Identifier","name":"annotation"},"loc":{"start":{"line":331},"end":{"line":359}}},"property":{"type":"Identifier","name":"ResponseBody"},"loc":{"start":{"line":331},"end":{"line":370}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"LessonTitleService"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Controller","loc":{"start":{"line":387},"end":{"line":387}}},"arguments":[]}]},"extending":{"type":"Identifier","name":"BaseService","loc":{"start":{"line":506},"end":{"line":506}}},"definitions":[{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"showPlan"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"RequestMapping","loc":{"start":{"line":719},"end":{"line":719}}},"arguments":[{"type":"AssignmentExpression","left":{"type":"Identifier","name":"value","loc":{"start":{"line":734},"end":{"line":734}}},"right":{"type":"Literal","value":"/lessontitle.mvc","raw":"/lessontitle.mvc","loc":{"start":{"line":742},"end":{"line":742}}},"loc":{"start":{"line":734},"end":{"line":740}}},{"type":"AssignmentExpression","left":{"type":"Identifier","name":"produces","loc":{"start":{"line":762},"end":{"line":762}}},"right":{"type":"Literal","value":"application/html","raw":"application/html","loc":{"start":{"line":773},"end":{"line":773}}},"loc":{"start":{"line":762},"end":{"line":771}}}]},{"type":"Annotation","annotationType":{"type":"Identifier","name":"ResponseBody","loc":{"start":{"line":805},"end":{"line":805}}},"arguments":[]}]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":822},"end":{"line":822}}},"typarams":[],"params":[{"type":"Identifier","name":"session","vartype":{"type":"Identifier","name":"HttpSession","loc":{"start":{"line":838},"end":{"line":838}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ws","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":869},"end":{"line":869}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":869},"end":{"line":869}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getWebSession","loc":{"start":{"line":885},"end":{"line":885}}},"arguments":[{"type":"Identifier","name":"session","loc":{"start":{"line":899},"end":{"line":899}}}],"loc":{"start":{"line":885},"end":{"line":898}}},"loc":{"start":{"line":869},"end":{"line":880}}},{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTitle","loc":{"start":{"line":924},"end":{"line":924}}},"arguments":[{"type":"Identifier","name":"ws","loc":{"start":{"line":939},"end":{"line":939}}}],"loc":{"start":{"line":924},"end":{"line":938}}},"loc":{"start":{"line":917},"end":{"line":917}}}],"loc":{"start":{"line":859},"end":{"line":948}}},"code":"\n@RequestMapping(value \u003d \"/lessontitle.mvc\", produces \u003d \"application/html\")\n@ResponseBody()\npublic String showPlan(HttpSession session) {\n    WebSession ws \u003d getWebSession(session);\n    return getLessonTitle(ws);\n}","loc":{"start":{"line":718},"end":{"line":829}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getLessonTitle"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":963},"end":{"line":963}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":985},"end":{"line":985}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"title","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1006},"end":{"line":1006}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1006},"end":{"line":1006}}},"init":{"type":"Literal","value":"","raw":"","loc":{"start":{"line":1021},"end":{"line":1021}}},"loc":{"start":{"line":1006},"end":{"line":1013}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"scr","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":1043},"end":{"line":1043}}},"property":{"type":"Identifier","name":"getCurrentScreen"},"loc":{"start":{"line":1043},"end":{"line":1044}}},"arguments":[],"loc":{"start":{"line":1043},"end":{"line":1061}}},"loc":{"start":{"line":1033},"end":{"line":1037}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"course","vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":1073},"end":{"line":1073}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":1073},"end":{"line":1073}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":1089},"end":{"line":1089}}},"property":{"type":"Identifier","name":"getCourse"},"loc":{"start":{"line":1089},"end":{"line":1090}}},"arguments":[],"loc":{"start":{"line":1089},"end":{"line":1100}}},"loc":{"start":{"line":1073},"end":{"line":1080}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":1117},"end":{"line":1117}}},"property":{"type":"Identifier","name":"isUser"},"loc":{"start":{"line":1117},"end":{"line":1118}}},"arguments":[],"loc":{"start":{"line":1117},"end":{"line":1125}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":1131},"end":{"line":1131}}},"property":{"type":"Identifier","name":"isChallenge"},"loc":{"start":{"line":1131},"end":{"line":1132}}},"arguments":[],"loc":{"start":{"line":1131},"end":{"line":1144}}},"loc":{"start":{"line":1117},"end":{"line":1128}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":1162},"end":{"line":1162}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":1162},"end":{"line":1162}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"course","loc":{"start":{"line":1186},"end":{"line":1186}}},"property":{"type":"Identifier","name":"getLesson"},"loc":{"start":{"line":1186},"end":{"line":1192}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":1203},"end":{"line":1203}}},{"type":"Identifier","name":"scr","loc":{"start":{"line":1206},"end":{"line":1206}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":1211},"end":{"line":1211}}},"property":{"type":"Identifier","name":"USER_ROLE"},"loc":{"start":{"line":1211},"end":{"line":1225}}}],"loc":{"start":{"line":1186},"end":{"line":1202}}},"loc":{"start":{"line":1162},"end":{"line":1177}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"title","loc":{"start":{"line":1250},"end":{"line":1250}}},"right":{"type":"ConditionalExpression","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":1258},"end":{"line":1258}}},"right":{"type":"Literal","loc":{"start":{"line":1268},"end":{"line":1268}}},"loc":{"start":{"line":1258},"end":{"line":1265}}},"alternate":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":1275},"end":{"line":1275}}},"property":{"type":"Identifier","name":"getTitle"},"loc":{"start":{"line":1275},"end":{"line":1281}}},"arguments":[],"loc":{"start":{"line":1275},"end":{"line":1290}}},"consequent":{"type":"Literal","value":"","raw":"","loc":{"start":{"line":1295},"end":{"line":1295}}},"loc":{"start":{"line":1258},"end":{"line":1273}}},"loc":{"start":{"line":1250},"end":{"line":1256}}},"loc":{"start":{"line":1250},"end":{"line":1250}}}],"loc":{"start":{"line":1148},"end":{"line":1307}}},"loc":{"start":{"line":1113},"end":{"line":1113}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"title","loc":{"start":{"line":1324},"end":{"line":1324}}},"loc":{"start":{"line":1317},"end":{"line":1317}}}],"loc":{"start":{"line":999},"end":{"line":1335}}},"code":"\nprivate String getLessonTitle(WebSession s) {\n    String title \u003d \"\";\n    int scr \u003d s.getCurrentScreen();\n    Course course \u003d s.getCourse();\n    if (s.isUser() || s.isChallenge()) {\n        AbstractLesson lesson \u003d course.getLesson(s, scr, AbstractLesson.USER_ROLE);\n        title \u003d lesson !\u003d null ? lesson.getTitle() : \"\";\n    }\n    return title;\n}","loc":{"start":{"line":955},"end":{"line":970}}}],"loc":{"start":{"line":386},"end":{"line":473}}}],"loc":{"start":{"line":0},"end":{"line":0}}}