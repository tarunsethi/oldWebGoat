{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1239},"end":{"line":1239}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1239},"end":{"line":1242}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1239},"end":{"line":1248}}},"property":{"type":"Identifier","name":"service"},"loc":{"start":{"line":1239},"end":{"line":1256}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":1274},"end":{"line":1274}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":1274},"end":{"line":1279}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":1274},"end":{"line":1287}}},"property":{"type":"Identifier","name":"HttpSession"},"loc":{"start":{"line":1274},"end":{"line":1292}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1313},"end":{"line":1313}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1313},"end":{"line":1316}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1313},"end":{"line":1322}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":1313},"end":{"line":1330}}},"property":{"type":"Identifier","name":"AbstractLesson"},"loc":{"start":{"line":1313},"end":{"line":1338}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1362},"end":{"line":1362}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1362},"end":{"line":1365}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1362},"end":{"line":1371}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":1362},"end":{"line":1379}}},"property":{"type":"Identifier","name":"Course"},"loc":{"start":{"line":1362},"end":{"line":1387}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1403},"end":{"line":1403}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1403},"end":{"line":1406}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1403},"end":{"line":1412}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":1403},"end":{"line":1420}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":1403},"end":{"line":1428}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1448},"end":{"line":1448}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":1448},"end":{"line":1451}}},"property":{"type":"Identifier","name":"stereotype"},"loc":{"start":{"line":1448},"end":{"line":1467}}},"property":{"type":"Identifier","name":"Controller"},"loc":{"start":{"line":1448},"end":{"line":1478}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1498},"end":{"line":1498}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":1498},"end":{"line":1501}}},"property":{"type":"Identifier","name":"web"},"loc":{"start":{"line":1498},"end":{"line":1517}}},"property":{"type":"Identifier","name":"bind"},"loc":{"start":{"line":1498},"end":{"line":1521}}},"property":{"type":"Identifier","name":"annotation"},"loc":{"start":{"line":1498},"end":{"line":1526}}},"property":{"type":"Identifier","name":"RequestMapping"},"loc":{"start":{"line":1498},"end":{"line":1537}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1561},"end":{"line":1561}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":1561},"end":{"line":1564}}},"property":{"type":"Identifier","name":"web"},"loc":{"start":{"line":1561},"end":{"line":1580}}},"property":{"type":"Identifier","name":"bind"},"loc":{"start":{"line":1561},"end":{"line":1584}}},"property":{"type":"Identifier","name":"annotation"},"loc":{"start":{"line":1561},"end":{"line":1589}}},"property":{"type":"Identifier","name":"ResponseBody"},"loc":{"start":{"line":1561},"end":{"line":1600}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"SolutionService"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Controller","loc":{"start":{"line":1701},"end":{"line":1701}}},"arguments":[]}]},"extending":{"type":"Identifier","name":"BaseService","loc":{"start":{"line":1749},"end":{"line":1749}}},"definitions":[{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"showSolution"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"RequestMapping","loc":{"start":{"line":1956},"end":{"line":1956}}},"arguments":[{"type":"AssignmentExpression","left":{"type":"Identifier","name":"value","loc":{"start":{"line":1971},"end":{"line":1971}}},"right":{"type":"Literal","value":"/solution.mvc","raw":"/solution.mvc","loc":{"start":{"line":1979},"end":{"line":1979}}},"loc":{"start":{"line":1971},"end":{"line":1977}}},{"type":"AssignmentExpression","left":{"type":"Identifier","name":"produces","loc":{"start":{"line":1996},"end":{"line":1996}}},"right":{"type":"Literal","value":"text/html","raw":"text/html","loc":{"start":{"line":2007},"end":{"line":2007}}},"loc":{"start":{"line":1996},"end":{"line":2005}}}]},{"type":"Annotation","annotationType":{"type":"Identifier","name":"ResponseBody","loc":{"start":{"line":2032},"end":{"line":2032}}},"arguments":[]}]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":2049},"end":{"line":2049}}},"typarams":[],"params":[{"type":"Identifier","name":"session","vartype":{"type":"Identifier","name":"HttpSession","loc":{"start":{"line":2069},"end":{"line":2069}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ws","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":2100},"end":{"line":2100}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":2100},"end":{"line":2100}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getWebSession","loc":{"start":{"line":2116},"end":{"line":2116}}},"arguments":[{"type":"Identifier","name":"session","loc":{"start":{"line":2130},"end":{"line":2130}}}],"loc":{"start":{"line":2116},"end":{"line":2129}}},"loc":{"start":{"line":2100},"end":{"line":2111}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"source","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2148},"end":{"line":2148}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2148},"end":{"line":2148}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getSolution","loc":{"start":{"line":2164},"end":{"line":2164}}},"arguments":[{"type":"Identifier","name":"ws","loc":{"start":{"line":2176},"end":{"line":2176}}}],"loc":{"start":{"line":2164},"end":{"line":2175}}},"loc":{"start":{"line":2148},"end":{"line":2155}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"source","loc":{"start":{"line":2196},"end":{"line":2196}}},"loc":{"start":{"line":2189},"end":{"line":2189}}}],"loc":{"start":{"line":2090},"end":{"line":2208}}},"code":"\n@RequestMapping(value \u003d \"/solution.mvc\", produces \u003d \"text/html\")\n@ResponseBody()\npublic String showSolution(HttpSession session) {\n    WebSession ws \u003d getWebSession(session);\n    String source \u003d getSolution(ws);\n    return source;\n}","loc":{"start":{"line":1955},"end":{"line":2056}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getSolution"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":2396},"end":{"line":2396}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":2415},"end":{"line":2415}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"source","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2440},"end":{"line":2440}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":2440},"end":{"line":2440}}},"init":{"type":"Literal","loc":{"start":{"line":2456},"end":{"line":2456}}},"loc":{"start":{"line":2440},"end":{"line":2447}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"scr","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":2480},"end":{"line":2480}}},"property":{"type":"Identifier","name":"getCurrentScreen"},"loc":{"start":{"line":2480},"end":{"line":2481}}},"arguments":[],"loc":{"start":{"line":2480},"end":{"line":2498}}},"loc":{"start":{"line":2470},"end":{"line":2474}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"course","vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":2510},"end":{"line":2510}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":2510},"end":{"line":2510}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":2526},"end":{"line":2526}}},"property":{"type":"Identifier","name":"getCourse"},"loc":{"start":{"line":2526},"end":{"line":2527}}},"arguments":[],"loc":{"start":{"line":2526},"end":{"line":2537}}},"loc":{"start":{"line":2510},"end":{"line":2517}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":2554},"end":{"line":2554}}},"property":{"type":"Identifier","name":"isUser"},"loc":{"start":{"line":2554},"end":{"line":2555}}},"arguments":[],"loc":{"start":{"line":2554},"end":{"line":2562}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":2568},"end":{"line":2568}}},"property":{"type":"Identifier","name":"isChallenge"},"loc":{"start":{"line":2568},"end":{"line":2569}}},"arguments":[],"loc":{"start":{"line":2568},"end":{"line":2581}}},"loc":{"start":{"line":2554},"end":{"line":2565}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":2600},"end":{"line":2600}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":2600},"end":{"line":2600}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"course","loc":{"start":{"line":2624},"end":{"line":2624}}},"property":{"type":"Identifier","name":"getLesson"},"loc":{"start":{"line":2624},"end":{"line":2630}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":2641},"end":{"line":2641}}},{"type":"Identifier","name":"scr","loc":{"start":{"line":2644},"end":{"line":2644}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":2649},"end":{"line":2649}}},"property":{"type":"Identifier","name":"USER_ROLE"},"loc":{"start":{"line":2649},"end":{"line":2663}}}],"loc":{"start":{"line":2624},"end":{"line":2640}}},"loc":{"start":{"line":2600},"end":{"line":2615}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":2693},"end":{"line":2693}}},"right":{"type":"Literal","loc":{"start":{"line":2703},"end":{"line":2703}}},"loc":{"start":{"line":2693},"end":{"line":2700}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"source","loc":{"start":{"line":2727},"end":{"line":2727}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":2736},"end":{"line":2736}}},"property":{"type":"Identifier","name":"getSolution"},"loc":{"start":{"line":2736},"end":{"line":2742}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":2755},"end":{"line":2755}}}],"loc":{"start":{"line":2736},"end":{"line":2754}}},"loc":{"start":{"line":2727},"end":{"line":2734}}},"loc":{"start":{"line":2727},"end":{"line":2727}}}],"loc":{"start":{"line":2709},"end":{"line":2771}}},"loc":{"start":{"line":2689},"end":{"line":2689}}}],"loc":{"start":{"line":2585},"end":{"line":2781}}},"loc":{"start":{"line":2550},"end":{"line":2550}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"source","loc":{"start":{"line":2795},"end":{"line":2795}}},"right":{"type":"Literal","loc":{"start":{"line":2805},"end":{"line":2805}}},"loc":{"start":{"line":2795},"end":{"line":2802}}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Solution  is not available. Contact ","raw":"Solution  is not available. Contact ","loc":{"start":{"line":2832},"end":{"line":2832}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":2893},"end":{"line":2893}}},"property":{"type":"Identifier","name":"getWebgoatContext"},"loc":{"start":{"line":2893},"end":{"line":2894}}},"arguments":[],"loc":{"start":{"line":2893},"end":{"line":2912}}},"property":{"type":"Identifier","name":"getFeedbackAddressHTML"},"loc":{"start":{"line":2893},"end":{"line":2914}}},"arguments":[],"loc":{"start":{"line":2893},"end":{"line":2937}}},"loc":{"start":{"line":2832},"end":{"line":2891}}},"loc":{"start":{"line":2825},"end":{"line":2825}}}],"loc":{"start":{"line":2811},"end":{"line":2949}}},"loc":{"start":{"line":2791},"end":{"line":2791}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"source","loc":{"start":{"line":2967},"end":{"line":2967}}},"loc":{"start":{"line":2959},"end":{"line":2959}}}],"loc":{"start":{"line":2429},"end":{"line":2980}}},"code":"\nprotected String getSolution(WebSession s) {\n    String source \u003d null;\n    int scr \u003d s.getCurrentScreen();\n    Course course \u003d s.getCourse();\n    if (s.isUser() || s.isChallenge()) {\n        AbstractLesson lesson \u003d course.getLesson(s, scr, AbstractLesson.USER_ROLE);\n        if (lesson !\u003d null) {\n            source \u003d lesson.getSolution(s);\n        }\n    }\n    if (source \u003d\u003d null) {\n        return \"Solution  is not available. Contact \" + s.getWebgoatContext().getFeedbackAddressHTML();\n    }\n    return (source);\n}","loc":{"start":{"line":2386},"end":{"line":2403}}}],"loc":{"start":{"line":1700},"end":{"line":1719}}}],"loc":{"start":{"line":1231},"end":{"line":1231}}}