{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":9},"end":{"line":12}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":9},"end":{"line":18}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":9},"end":{"line":26}}},"property":{"type":"Identifier","name":"admin"},"loc":{"start":{"line":9},"end":{"line":34}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":50},"end":{"line":50}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":50},"end":{"line":54}}},"property":{"type":"Identifier","name":"Connection"},"loc":{"start":{"line":50},"end":{"line":58}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":78},"end":{"line":78}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":78},"end":{"line":82}}},"property":{"type":"Identifier","name":"ResultSet"},"loc":{"start":{"line":78},"end":{"line":86}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":105},"end":{"line":105}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":105},"end":{"line":109}}},"property":{"type":"Identifier","name":"ResultSetMetaData"},"loc":{"start":{"line":105},"end":{"line":113}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":140},"end":{"line":140}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":140},"end":{"line":144}}},"property":{"type":"Identifier","name":"Statement"},"loc":{"start":{"line":140},"end":{"line":148}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":167},"end":{"line":167}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":167},"end":{"line":170}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":167},"end":{"line":177}}},"property":{"type":"Identifier","name":"Element"},"loc":{"start":{"line":167},"end":{"line":181}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":198},"end":{"line":198}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":198},"end":{"line":201}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":198},"end":{"line":208}}},"property":{"type":"Identifier","name":"ElementContainer"},"loc":{"start":{"line":198},"end":{"line":212}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":238},"end":{"line":238}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":238},"end":{"line":241}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":238},"end":{"line":247}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":238},"end":{"line":255}}},"property":{"type":"Identifier","name":"Category"},"loc":{"start":{"line":238},"end":{"line":263}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":281},"end":{"line":281}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":281},"end":{"line":284}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":281},"end":{"line":290}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":281},"end":{"line":298}}},"property":{"type":"Identifier","name":"LessonAdapter"},"loc":{"start":{"line":281},"end":{"line":306}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":329},"end":{"line":329}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":329},"end":{"line":332}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":329},"end":{"line":338}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":329},"end":{"line":346}}},"property":{"type":"Identifier","name":"DatabaseUtilities"},"loc":{"start":{"line":329},"end":{"line":354}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":381},"end":{"line":381}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":381},"end":{"line":384}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":381},"end":{"line":390}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":381},"end":{"line":398}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":381},"end":{"line":406}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"ProductsAdminScreen"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"LessonAdapter","loc":{"start":{"line":1821},"end":{"line":1821}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"QUERY","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1863},"end":{"line":1863}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1863},"end":{"line":1863}}},"init":{"type":"Literal","value":"SELECT * FROM product_system_data","raw":"SELECT * FROM product_system_data","loc":{"start":{"line":1878},"end":{"line":1878}}},"loc":{"start":{"line":1842},"end":{"line":1870}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"createContent"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":2007},"end":{"line":2007}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":2029},"end":{"line":2029}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ec","vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":2057},"end":{"line":2057}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":2057},"end":{"line":2057}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":2083},"end":{"line":2083}}},"arguments":[],"loc":{"start":{"line":2079},"end":{"line":2079}}},"loc":{"start":{"line":2057},"end":{"line":2074}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":2724},"end":{"line":2724}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":2759},"end":{"line":2759}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":2759},"end":{"line":2760}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Error generating ","raw":"Error generating ","loc":{"start":{"line":2772},"end":{"line":2772}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"getClass"},"loc":{"start":{"line":2794},"end":{"line":2798}}},"arguments":[],"loc":{"start":{"line":2794},"end":{"line":2807}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":2794},"end":{"line":2809}}},"arguments":[],"loc":{"start":{"line":2794},"end":{"line":2817}}},"loc":{"start":{"line":2772},"end":{"line":2792}}}],"loc":{"start":{"line":2759},"end":{"line":2771}}},"loc":{"start":{"line":2759},"end":{"line":2759}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":2834},"end":{"line":2834}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":2834},"end":{"line":2835}}},"arguments":[],"loc":{"start":{"line":2834},"end":{"line":2851}}},"loc":{"start":{"line":2834},"end":{"line":2834}}}],"loc":{"start":{"line":2745},"end":{"line":2863}}},"loc":{"start":{"line":2717},"end":{"line":2717}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"connection","vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":2138},"end":{"line":2138}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":2138},"end":{"line":2138}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"DatabaseUtilities","loc":{"start":{"line":2162},"end":{"line":2162}}},"property":{"type":"Identifier","name":"getConnection"},"loc":{"start":{"line":2162},"end":{"line":2179}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":2194},"end":{"line":2194}}}],"loc":{"start":{"line":2162},"end":{"line":2193}}},"loc":{"start":{"line":2138},"end":{"line":2149}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"statement","vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":2211},"end":{"line":2211}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":2211},"end":{"line":2211}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"connection","loc":{"start":{"line":2233},"end":{"line":2233}}},"property":{"type":"Identifier","name":"createStatement"},"loc":{"start":{"line":2233},"end":{"line":2243}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":2260},"end":{"line":2260}}},"property":{"type":"Identifier","name":"TYPE_SCROLL_INSENSITIVE"},"loc":{"start":{"line":2260},"end":{"line":2269}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":2359},"end":{"line":2359}}},"property":{"type":"Identifier","name":"CONCUR_READ_ONLY"},"loc":{"start":{"line":2359},"end":{"line":2368}}}],"loc":{"start":{"line":2233},"end":{"line":2259}}},"loc":{"start":{"line":2211},"end":{"line":2221}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"results","vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":2400},"end":{"line":2400}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":2400},"end":{"line":2400}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":2420},"end":{"line":2420}}},"property":{"type":"Identifier","name":"executeQuery"},"loc":{"start":{"line":2420},"end":{"line":2429}}},"arguments":[{"type":"Identifier","name":"QUERY","loc":{"start":{"line":2443},"end":{"line":2443}}}],"loc":{"start":{"line":2420},"end":{"line":2442}}},"loc":{"start":{"line":2400},"end":{"line":2410}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"results","loc":{"start":{"line":2468},"end":{"line":2468}}},"right":{"type":"Literal","loc":{"start":{"line":2479},"end":{"line":2479}}},"loc":{"start":{"line":2468},"end":{"line":2476}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"makeSuccess","loc":{"start":{"line":2515},"end":{"line":2515}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":2527},"end":{"line":2527}}}],"loc":{"start":{"line":2515},"end":{"line":2526}}},"loc":{"start":{"line":2515},"end":{"line":2515}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"resultsMetaData","vartype":{"type":"Identifier","name":"ResultSetMetaData","loc":{"start":{"line":2547},"end":{"line":2547}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ResultSetMetaData","loc":{"start":{"line":2547},"end":{"line":2547}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"results","loc":{"start":{"line":2583},"end":{"line":2583}}},"property":{"type":"Identifier","name":"getMetaData"},"loc":{"start":{"line":2583},"end":{"line":2590}}},"arguments":[],"loc":{"start":{"line":2583},"end":{"line":2602}}},"loc":{"start":{"line":2547},"end":{"line":2565}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":2622},"end":{"line":2622}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":2622},"end":{"line":2624}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"DatabaseUtilities","loc":{"start":{"line":2636},"end":{"line":2636}}},"property":{"type":"Identifier","name":"writeTable"},"loc":{"start":{"line":2636},"end":{"line":2653}}},"arguments":[{"type":"Identifier","name":"results","loc":{"start":{"line":2665},"end":{"line":2665}}},{"type":"Identifier","name":"resultsMetaData","loc":{"start":{"line":2674},"end":{"line":2674}}}],"loc":{"start":{"line":2636},"end":{"line":2664}}}],"loc":{"start":{"line":2622},"end":{"line":2635}}},"loc":{"start":{"line":2622},"end":{"line":2622}}}],"loc":{"start":{"line":2497},"end":{"line":2705}}},"loc":{"start":{"line":2464},"end":{"line":2464}}}],"loc":{"start":{"line":2124},"end":{"line":2715}}},"loc":{"start":{"line":2112},"end":{"line":2863}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"ec","loc":{"start":{"line":2882},"end":{"line":2882}}},"loc":{"start":{"line":2874},"end":{"line":2874}}}],"loc":{"start":{"line":2047},"end":{"line":2891}}},"code":"\nprotected Element createContent(WebSession s) {\n    ElementContainer ec \u003d new ElementContainer();\n    try {\n        Connection connection \u003d DatabaseUtilities.getConnection(s);\n        Statement statement \u003d connection.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);\n        ResultSet results \u003d statement.executeQuery(QUERY);\n        if (results !\u003d null) {\n            makeSuccess(s);\n            ResultSetMetaData resultsMetaData \u003d results.getMetaData();\n            ec.addElement(DatabaseUtilities.writeTable(results, resultsMetaData));\n        }\n    } catch (Exception e) {\n        s.setMessage(\"Error generating \" + this.getClass().getName());\n        e.printStackTrace();\n    }\n    return (ec);\n}","loc":{"start":{"line":1997},"end":{"line":2015}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultCategory"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Category","loc":{"start":{"line":3034},"end":{"line":3034}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"Category","loc":{"start":{"line":3085},"end":{"line":3085}}},"property":{"type":"Identifier","name":"ADMIN_FUNCTIONS"},"loc":{"start":{"line":3085},"end":{"line":3093}}},"loc":{"start":{"line":3078},"end":{"line":3078}}}],"loc":{"start":{"line":3068},"end":{"line":3115}}},"code":"\nprotected Category getDefaultCategory() {\n    return Category.ADMIN_FUNCTIONS;\n}","loc":{"start":{"line":3024},"end":{"line":3043}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getRole"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":3247},"end":{"line":3247}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"HACKED_ADMIN_ROLE","loc":{"start":{"line":3285},"end":{"line":3285}}},"loc":{"start":{"line":3278},"end":{"line":3278}}}],"loc":{"start":{"line":3268},"end":{"line":3308}}},"code":"\npublic String getRole() {\n    return HACKED_ADMIN_ROLE;\n}","loc":{"start":{"line":3240},"end":{"line":3254}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getTitle"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":3442},"end":{"line":3442}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Literal","value":"Product Information","raw":"Product Information","loc":{"start":{"line":3482},"end":{"line":3482}}},"loc":{"start":{"line":3474},"end":{"line":3474}}}],"loc":{"start":{"line":3464},"end":{"line":3510}}},"code":"\npublic String getTitle() {\n    return (\"Product Information\");\n}","loc":{"start":{"line":3435},"end":{"line":3449}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"DEFAULT_RANKING","vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":3538},"end":{"line":3538}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":3538},"end":{"line":3538}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":3568},"end":{"line":3568}}},"arguments":[{"type":"Literal","value":1000,"raw":1000,"loc":{"start":{"line":3576},"end":{"line":3576}}}],"loc":{"start":{"line":3564},"end":{"line":3564}}},"loc":{"start":{"line":3517},"end":{"line":3546}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultRanking"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":3705},"end":{"line":3705}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"DEFAULT_RANKING","loc":{"start":{"line":3754},"end":{"line":3754}}},"loc":{"start":{"line":3747},"end":{"line":3747}}}],"loc":{"start":{"line":3737},"end":{"line":3775}}},"code":"\nprotected Integer getDefaultRanking() {\n    return DEFAULT_RANKING;\n}","loc":{"start":{"line":3695},"end":{"line":3713}}}],"loc":{"start":{"line":1780},"end":{"line":1787}}}],"loc":{"start":{"line":1},"end":{"line":1}}}