{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":9},"end":{"line":12}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":9},"end":{"line":18}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":9},"end":{"line":26}}},"property":{"type":"Identifier","name":"admin"},"loc":{"start":{"line":9},"end":{"line":34}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":50},"end":{"line":50}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":50},"end":{"line":54}}},"property":{"type":"Identifier","name":"Connection"},"loc":{"start":{"line":50},"end":{"line":58}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":78},"end":{"line":78}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":78},"end":{"line":82}}},"property":{"type":"Identifier","name":"ResultSet"},"loc":{"start":{"line":78},"end":{"line":86}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":105},"end":{"line":105}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":105},"end":{"line":109}}},"property":{"type":"Identifier","name":"ResultSetMetaData"},"loc":{"start":{"line":105},"end":{"line":113}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":140},"end":{"line":140}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":140},"end":{"line":144}}},"property":{"type":"Identifier","name":"Statement"},"loc":{"start":{"line":140},"end":{"line":148}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":167},"end":{"line":167}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":167},"end":{"line":171}}},"property":{"type":"Identifier","name":"ArrayList"},"loc":{"start":{"line":167},"end":{"line":176}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":195},"end":{"line":195}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":195},"end":{"line":199}}},"property":{"type":"Identifier","name":"List"},"loc":{"start":{"line":195},"end":{"line":204}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":218},"end":{"line":218}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":218},"end":{"line":221}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":218},"end":{"line":227}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":218},"end":{"line":235}}},"property":{"type":"Identifier","name":"*"},"loc":{"start":{"line":218},"end":{"line":243}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":254},"end":{"line":254}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":254},"end":{"line":257}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":254},"end":{"line":264}}},"property":{"type":"Identifier","name":"Element"},"loc":{"start":{"line":254},"end":{"line":268}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":285},"end":{"line":285}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":285},"end":{"line":288}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":285},"end":{"line":295}}},"property":{"type":"Identifier","name":"ElementContainer"},"loc":{"start":{"line":285},"end":{"line":299}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":325},"end":{"line":325}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":325},"end":{"line":328}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":325},"end":{"line":335}}},"property":{"type":"Identifier","name":"StringElement"},"loc":{"start":{"line":325},"end":{"line":339}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":362},"end":{"line":362}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":362},"end":{"line":365}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":362},"end":{"line":372}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":362},"end":{"line":376}}},"property":{"type":"Identifier","name":"Input"},"loc":{"start":{"line":362},"end":{"line":381}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":396},"end":{"line":396}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":396},"end":{"line":399}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":396},"end":{"line":405}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":396},"end":{"line":413}}},"property":{"type":"Identifier","name":"*"},"loc":{"start":{"line":396},"end":{"line":421}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"ViewDatabase"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"LessonAdapter","loc":{"start":{"line":1820},"end":{"line":1820}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"SQL","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1862},"end":{"line":1862}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1862},"end":{"line":1862}}},"init":{"type":"Literal","value":"sql","raw":"sql","loc":{"start":{"line":1875},"end":{"line":1875}}},"loc":{"start":{"line":1841},"end":{"line":1869}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"createContent"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":1974},"end":{"line":1974}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":1996},"end":{"line":1996}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ec","vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":2024},"end":{"line":2024}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":2024},"end":{"line":2024}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":2050},"end":{"line":2050}}},"arguments":[],"loc":{"start":{"line":2046},"end":{"line":2046}}},"loc":{"start":{"line":2024},"end":{"line":2041}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":3220},"end":{"line":3220}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":3255},"end":{"line":3255}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":3255},"end":{"line":3256}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Error generating ","raw":"Error generating ","loc":{"start":{"line":3268},"end":{"line":3268}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"getClass"},"loc":{"start":{"line":3290},"end":{"line":3294}}},"arguments":[],"loc":{"start":{"line":3290},"end":{"line":3303}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":3290},"end":{"line":3305}}},"arguments":[],"loc":{"start":{"line":3290},"end":{"line":3313}}},"loc":{"start":{"line":3268},"end":{"line":3288}}}],"loc":{"start":{"line":3255},"end":{"line":3267}}},"loc":{"start":{"line":3255},"end":{"line":3255}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":3330},"end":{"line":3330}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":3330},"end":{"line":3331}}},"arguments":[],"loc":{"start":{"line":3330},"end":{"line":3347}}},"loc":{"start":{"line":3330},"end":{"line":3330}}}],"loc":{"start":{"line":3241},"end":{"line":3359}}},"loc":{"start":{"line":3213},"end":{"line":3213}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":2105},"end":{"line":2105}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":2105},"end":{"line":2107}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringElement","loc":{"start":{"line":2123},"end":{"line":2123}}},"arguments":[{"type":"Literal","value":"Enter a SQL statement: ","raw":"Enter a SQL statement: ","loc":{"start":{"line":2137},"end":{"line":2137}}}],"loc":{"start":{"line":2119},"end":{"line":2119}}}],"loc":{"start":{"line":2105},"end":{"line":2118}}},"loc":{"start":{"line":2105},"end":{"line":2105}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"sqlStatement","vartype":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":2179},"end":{"line":2179}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":2179},"end":{"line":2179}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":2211},"end":{"line":2211}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":2224},"end":{"line":2224}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":2224},"end":{"line":2225}}},"arguments":[],"loc":{"start":{"line":2224},"end":{"line":2235}}},"property":{"type":"Identifier","name":"getRawParameter"},"loc":{"start":{"line":2224},"end":{"line":2237}}},"arguments":[{"type":"Identifier","name":"SQL","loc":{"start":{"line":2254},"end":{"line":2254}}},{"type":"Literal","value":"","raw":"","loc":{"start":{"line":2259},"end":{"line":2259}}}],"loc":{"start":{"line":2224},"end":{"line":2253}}}],"loc":{"start":{"line":2207},"end":{"line":2207}}},"loc":{"start":{"line":2179},"end":{"line":2192}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"input","vartype":{"type":"Identifier","name":"Input","loc":{"start":{"line":2277},"end":{"line":2277}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Input","loc":{"start":{"line":2277},"end":{"line":2277}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Input","loc":{"start":{"line":2295},"end":{"line":2295}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"Input","loc":{"start":{"line":2301},"end":{"line":2301}}},"property":{"type":"Identifier","name":"TEXT"},"loc":{"start":{"line":2301},"end":{"line":2306}}},{"type":"Identifier","name":"SQL","loc":{"start":{"line":2313},"end":{"line":2313}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"sqlStatement","loc":{"start":{"line":2318},"end":{"line":2318}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":2318},"end":{"line":2330}}},"arguments":[],"loc":{"start":{"line":2318},"end":{"line":2339}}}],"loc":{"start":{"line":2291},"end":{"line":2291}}},"loc":{"start":{"line":2277},"end":{"line":2283}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":2356},"end":{"line":2356}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":2356},"end":{"line":2358}}},"arguments":[{"type":"Identifier","name":"input","loc":{"start":{"line":2370},"end":{"line":2370}}}],"loc":{"start":{"line":2356},"end":{"line":2369}}},"loc":{"start":{"line":2356},"end":{"line":2356}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"b","vartype":{"type":"Identifier","name":"Element","loc":{"start":{"line":2391},"end":{"line":2391}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Element","loc":{"start":{"line":2391},"end":{"line":2391}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ECSFactory","loc":{"start":{"line":2403},"end":{"line":2403}}},"property":{"type":"Identifier","name":"makeButton"},"loc":{"start":{"line":2403},"end":{"line":2413}}},"arguments":[{"type":"Literal","value":"Go!","raw":"Go!","loc":{"start":{"line":2425},"end":{"line":2425}}}],"loc":{"start":{"line":2403},"end":{"line":2424}}},"loc":{"start":{"line":2391},"end":{"line":2399}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":2445},"end":{"line":2445}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":2445},"end":{"line":2447}}},"arguments":[{"type":"Identifier","name":"b","loc":{"start":{"line":2459},"end":{"line":2459}}}],"loc":{"start":{"line":2445},"end":{"line":2458}}},"loc":{"start":{"line":2445},"end":{"line":2445}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"connection","vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":2476},"end":{"line":2476}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":2476},"end":{"line":2476}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"DatabaseUtilities","loc":{"start":{"line":2500},"end":{"line":2500}}},"property":{"type":"Identifier","name":"getConnection"},"loc":{"start":{"line":2500},"end":{"line":2517}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":2532},"end":{"line":2532}}}],"loc":{"start":{"line":2500},"end":{"line":2531}}},"loc":{"start":{"line":2476},"end":{"line":2487}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"GREATER_THAN","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"sqlStatement","loc":{"start":{"line":2553},"end":{"line":2553}}},"property":{"type":"Identifier","name":"length"},"loc":{"start":{"line":2553},"end":{"line":2565}}},"arguments":[],"loc":{"start":{"line":2553},"end":{"line":2572}}},"right":{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":2577},"end":{"line":2577}}},"loc":{"start":{"line":2553},"end":{"line":2575}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"statement","vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":2611},"end":{"line":2611}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":2611},"end":{"line":2611}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"connection","loc":{"start":{"line":2633},"end":{"line":2633}}},"property":{"type":"Identifier","name":"createStatement"},"loc":{"start":{"line":2633},"end":{"line":2643}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":2660},"end":{"line":2660}}},"property":{"type":"Identifier","name":"TYPE_SCROLL_INSENSITIVE"},"loc":{"start":{"line":2660},"end":{"line":2669}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":2763},"end":{"line":2763}}},"property":{"type":"Identifier","name":"CONCUR_READ_ONLY"},"loc":{"start":{"line":2763},"end":{"line":2772}}}],"loc":{"start":{"line":2633},"end":{"line":2659}}},"loc":{"start":{"line":2611},"end":{"line":2621}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"results","vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":2808},"end":{"line":2808}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":2808},"end":{"line":2808}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":2828},"end":{"line":2828}}},"property":{"type":"Identifier","name":"executeQuery"},"loc":{"start":{"line":2828},"end":{"line":2837}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"sqlStatement","loc":{"start":{"line":2851},"end":{"line":2851}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":2851},"end":{"line":2863}}},"arguments":[],"loc":{"start":{"line":2851},"end":{"line":2872}}}],"loc":{"start":{"line":2828},"end":{"line":2850}}},"loc":{"start":{"line":2808},"end":{"line":2818}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"results","loc":{"start":{"line":2899},"end":{"line":2899}}},"right":{"type":"Literal","loc":{"start":{"line":2910},"end":{"line":2910}}},"loc":{"start":{"line":2899},"end":{"line":2907}}},"right":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"results","loc":{"start":{"line":2920},"end":{"line":2920}}},"property":{"type":"Identifier","name":"first"},"loc":{"start":{"line":2920},"end":{"line":2927}}},"arguments":[],"loc":{"start":{"line":2920},"end":{"line":2933}}},"right":{"type":"Literal","value":1,"raw":1,"loc":{"start":{"line":2939},"end":{"line":2939}}},"loc":{"start":{"line":2920},"end":{"line":2936}}},"loc":{"start":{"line":2898},"end":{"line":2916}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"makeSuccess","loc":{"start":{"line":2984},"end":{"line":2984}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":2996},"end":{"line":2996}}}],"loc":{"start":{"line":2984},"end":{"line":2995}}},"loc":{"start":{"line":2984},"end":{"line":2984}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"resultsMetaData","vartype":{"type":"Identifier","name":"ResultSetMetaData","loc":{"start":{"line":3020},"end":{"line":3020}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ResultSetMetaData","loc":{"start":{"line":3020},"end":{"line":3020}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"results","loc":{"start":{"line":3056},"end":{"line":3056}}},"property":{"type":"Identifier","name":"getMetaData"},"loc":{"start":{"line":3056},"end":{"line":3063}}},"arguments":[],"loc":{"start":{"line":3056},"end":{"line":3075}}},"loc":{"start":{"line":3020},"end":{"line":3038}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":3099},"end":{"line":3099}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":3099},"end":{"line":3101}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"DatabaseUtilities","loc":{"start":{"line":3113},"end":{"line":3113}}},"property":{"type":"Identifier","name":"writeTable"},"loc":{"start":{"line":3113},"end":{"line":3130}}},"arguments":[{"type":"Identifier","name":"results","loc":{"start":{"line":3142},"end":{"line":3142}}},{"type":"Identifier","name":"resultsMetaData","loc":{"start":{"line":3151},"end":{"line":3151}}}],"loc":{"start":{"line":3113},"end":{"line":3141}}}],"loc":{"start":{"line":3099},"end":{"line":3112}}},"loc":{"start":{"line":3099},"end":{"line":3099}}}],"loc":{"start":{"line":2962},"end":{"line":3186}}},"loc":{"start":{"line":2894},"end":{"line":2894}}}],"loc":{"start":{"line":2592},"end":{"line":3201}}},"loc":{"start":{"line":2549},"end":{"line":2549}}}],"loc":{"start":{"line":2091},"end":{"line":3211}}},"loc":{"start":{"line":2079},"end":{"line":3359}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"ec","loc":{"start":{"line":3378},"end":{"line":3378}}},"loc":{"start":{"line":3370},"end":{"line":3370}}}],"loc":{"start":{"line":2014},"end":{"line":3387}}},"code":"\nprotected Element createContent(WebSession s) {\n    ElementContainer ec \u003d new ElementContainer();\n    try {\n        ec.addElement(new StringElement(\"Enter a SQL statement: \"));\n        StringBuffer sqlStatement \u003d new StringBuffer(s.getParser().getRawParameter(SQL, \"\"));\n        Input input \u003d new Input(Input.TEXT, SQL, sqlStatement.toString());\n        ec.addElement(input);\n        Element b \u003d ECSFactory.makeButton(\"Go!\");\n        ec.addElement(b);\n        Connection connection \u003d DatabaseUtilities.getConnection(s);\n        if (sqlStatement.length() \u003e 0) {\n            Statement statement \u003d connection.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);\n            ResultSet results \u003d statement.executeQuery(sqlStatement.toString());\n            if ((results !\u003d null) \u0026\u0026 (results.first() \u003d\u003d true)) {\n                makeSuccess(s);\n                ResultSetMetaData resultsMetaData \u003d results.getMetaData();\n                ec.addElement(DatabaseUtilities.writeTable(results, resultsMetaData));\n            }\n        }\n    } catch (Exception e) {\n        s.setMessage(\"Error generating \" + this.getClass().getName());\n        e.printStackTrace();\n    }\n    return (ec);\n}","loc":{"start":{"line":1964},"end":{"line":1982}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultCategory"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Category","loc":{"start":{"line":3525},"end":{"line":3525}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"Category","loc":{"start":{"line":3576},"end":{"line":3576}}},"property":{"type":"Identifier","name":"ADMIN_FUNCTIONS"},"loc":{"start":{"line":3576},"end":{"line":3584}}},"loc":{"start":{"line":3569},"end":{"line":3569}}}],"loc":{"start":{"line":3559},"end":{"line":3606}}},"code":"\nprotected Category getDefaultCategory() {\n    return Category.ADMIN_FUNCTIONS;\n}","loc":{"start":{"line":3515},"end":{"line":3534}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"DEFAULT_RANKING","vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":3634},"end":{"line":3634}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":3634},"end":{"line":3634}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":3664},"end":{"line":3664}}},"arguments":[{"type":"Literal","value":1000,"raw":1000,"loc":{"start":{"line":3672},"end":{"line":3672}}}],"loc":{"start":{"line":3660},"end":{"line":3660}}},"loc":{"start":{"line":3613},"end":{"line":3642}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultRanking"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":3801},"end":{"line":3801}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"DEFAULT_RANKING","loc":{"start":{"line":3850},"end":{"line":3850}}},"loc":{"start":{"line":3843},"end":{"line":3843}}}],"loc":{"start":{"line":3833},"end":{"line":3871}}},"code":"\nprotected Integer getDefaultRanking() {\n    return DEFAULT_RANKING;\n}","loc":{"start":{"line":3791},"end":{"line":3809}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getHints"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":3993},"end":{"line":3993}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":4015},"end":{"line":4015}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"hints","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":4043},"end":{"line":4043}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":4043},"end":{"line":4043}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":4068},"end":{"line":4068}}},"arguments":[],"loc":{"start":{"line":4064},"end":{"line":4064}}},"loc":{"start":{"line":4043},"end":{"line":4056}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":4097},"end":{"line":4097}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":4097},"end":{"line":4102}}},"arguments":[{"type":"Literal","value":"There are no hints defined","raw":"There are no hints defined","loc":{"start":{"line":4107},"end":{"line":4107}}}],"loc":{"start":{"line":4097},"end":{"line":4106}}},"loc":{"start":{"line":4097},"end":{"line":4097}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"hints","loc":{"start":{"line":4154},"end":{"line":4154}}},"loc":{"start":{"line":4147},"end":{"line":4147}}}],"loc":{"start":{"line":4033},"end":{"line":4165}}},"code":"\nprotected List\u003cString\u003e getHints(WebSession s) {\n    List\u003cString\u003e hints \u003d new ArrayList\u003cString\u003e();\n    hints.add(\"There are no hints defined\");\n    return hints;\n}","loc":{"start":{"line":3983},"end":{"line":4006}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getInstructions"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":4289},"end":{"line":4289}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":4312},"end":{"line":4312}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"instructions","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":4340},"end":{"line":4340}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":4340},"end":{"line":4340}}},"init":{"type":"Literal","value":"Please post a message to to the WebGoat forum. Your messages will be available for everyone to read.","raw":"Please post a message to to the WebGoat forum. Your messages will be available for everyone to read.","loc":{"start":{"line":4362},"end":{"line":4362}}},"loc":{"start":{"line":4340},"end":{"line":4347}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"instructions","loc":{"start":{"line":4483},"end":{"line":4483}}},"loc":{"start":{"line":4475},"end":{"line":4475}}}],"loc":{"start":{"line":4330},"end":{"line":4502}}},"code":"\npublic String getInstructions(WebSession s) {\n    String instructions \u003d \"Please post a message to to the WebGoat forum. Your messages will be available for everyone to read.\";\n    return (instructions);\n}","loc":{"start":{"line":4282},"end":{"line":4296}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getRole"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":4627},"end":{"line":4627}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"HACKED_ADMIN_ROLE","loc":{"start":{"line":4665},"end":{"line":4665}}},"loc":{"start":{"line":4658},"end":{"line":4658}}}],"loc":{"start":{"line":4648},"end":{"line":4688}}},"code":"\npublic String getRole() {\n    return HACKED_ADMIN_ROLE;\n}","loc":{"start":{"line":4620},"end":{"line":4634}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getTitle"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":4817},"end":{"line":4817}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Literal","value":"Adhoc Query","raw":"Adhoc Query","loc":{"start":{"line":4857},"end":{"line":4857}}},"loc":{"start":{"line":4849},"end":{"line":4849}}}],"loc":{"start":{"line":4839},"end":{"line":4877}}},"code":"\npublic String getTitle() {\n    return (\"Adhoc Query\");\n}","loc":{"start":{"line":4810},"end":{"line":4824}}}],"loc":{"start":{"line":1786},"end":{"line":1793}}}],"loc":{"start":{"line":1},"end":{"line":1}}}