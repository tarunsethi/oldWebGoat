{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":9},"end":{"line":12}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":9},"end":{"line":18}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":9},"end":{"line":26}}},"property":{"type":"Identifier","name":"admin"},"loc":{"start":{"line":9},"end":{"line":34}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":50},"end":{"line":50}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":50},"end":{"line":54}}},"property":{"type":"Identifier","name":"Connection"},"loc":{"start":{"line":50},"end":{"line":58}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":78},"end":{"line":78}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":78},"end":{"line":82}}},"property":{"type":"Identifier","name":"ResultSet"},"loc":{"start":{"line":78},"end":{"line":86}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":105},"end":{"line":105}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":105},"end":{"line":109}}},"property":{"type":"Identifier","name":"ResultSetMetaData"},"loc":{"start":{"line":105},"end":{"line":113}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":140},"end":{"line":140}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":140},"end":{"line":144}}},"property":{"type":"Identifier","name":"Statement"},"loc":{"start":{"line":140},"end":{"line":148}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":167},"end":{"line":167}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":167},"end":{"line":170}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":167},"end":{"line":177}}},"property":{"type":"Identifier","name":"Element"},"loc":{"start":{"line":167},"end":{"line":181}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":198},"end":{"line":198}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":198},"end":{"line":201}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":198},"end":{"line":208}}},"property":{"type":"Identifier","name":"ElementContainer"},"loc":{"start":{"line":198},"end":{"line":212}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":238},"end":{"line":238}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":238},"end":{"line":241}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":238},"end":{"line":247}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":238},"end":{"line":255}}},"property":{"type":"Identifier","name":"Category"},"loc":{"start":{"line":238},"end":{"line":263}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":281},"end":{"line":281}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":281},"end":{"line":284}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":281},"end":{"line":290}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":281},"end":{"line":298}}},"property":{"type":"Identifier","name":"LessonAdapter"},"loc":{"start":{"line":281},"end":{"line":306}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":329},"end":{"line":329}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":329},"end":{"line":332}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":329},"end":{"line":338}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":329},"end":{"line":346}}},"property":{"type":"Identifier","name":"DatabaseUtilities"},"loc":{"start":{"line":329},"end":{"line":354}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":381},"end":{"line":381}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":381},"end":{"line":384}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":381},"end":{"line":390}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":381},"end":{"line":398}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":381},"end":{"line":406}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"UserAdminScreen"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"LessonAdapter","loc":{"start":{"line":1811},"end":{"line":1811}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"QUERY","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1853},"end":{"line":1853}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1853},"end":{"line":1853}}},"init":{"type":"Literal","value":"SELECT * FROM user_system_data","raw":"SELECT * FROM user_system_data","loc":{"start":{"line":1868},"end":{"line":1868}}},"loc":{"start":{"line":1832},"end":{"line":1860}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"createContent"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":1994},"end":{"line":1994}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":2016},"end":{"line":2016}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ec","vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":2044},"end":{"line":2044}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":2044},"end":{"line":2044}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":2070},"end":{"line":2070}}},"arguments":[],"loc":{"start":{"line":2066},"end":{"line":2066}}},"loc":{"start":{"line":2044},"end":{"line":2061}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":2711},"end":{"line":2711}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":2746},"end":{"line":2746}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":2746},"end":{"line":2747}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Error generating ","raw":"Error generating ","loc":{"start":{"line":2759},"end":{"line":2759}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"getClass"},"loc":{"start":{"line":2781},"end":{"line":2785}}},"arguments":[],"loc":{"start":{"line":2781},"end":{"line":2794}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":2781},"end":{"line":2796}}},"arguments":[],"loc":{"start":{"line":2781},"end":{"line":2804}}},"loc":{"start":{"line":2759},"end":{"line":2779}}}],"loc":{"start":{"line":2746},"end":{"line":2758}}},"loc":{"start":{"line":2746},"end":{"line":2746}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":2821},"end":{"line":2821}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":2821},"end":{"line":2822}}},"arguments":[],"loc":{"start":{"line":2821},"end":{"line":2838}}},"loc":{"start":{"line":2821},"end":{"line":2821}}}],"loc":{"start":{"line":2732},"end":{"line":2850}}},"loc":{"start":{"line":2704},"end":{"line":2704}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"connection","vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":2125},"end":{"line":2125}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":2125},"end":{"line":2125}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"DatabaseUtilities","loc":{"start":{"line":2149},"end":{"line":2149}}},"property":{"type":"Identifier","name":"getConnection"},"loc":{"start":{"line":2149},"end":{"line":2166}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":2181},"end":{"line":2181}}}],"loc":{"start":{"line":2149},"end":{"line":2180}}},"loc":{"start":{"line":2125},"end":{"line":2136}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"statement","vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":2198},"end":{"line":2198}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":2198},"end":{"line":2198}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"connection","loc":{"start":{"line":2220},"end":{"line":2220}}},"property":{"type":"Identifier","name":"createStatement"},"loc":{"start":{"line":2220},"end":{"line":2230}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":2247},"end":{"line":2247}}},"property":{"type":"Identifier","name":"TYPE_SCROLL_INSENSITIVE"},"loc":{"start":{"line":2247},"end":{"line":2256}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":2346},"end":{"line":2346}}},"property":{"type":"Identifier","name":"CONCUR_READ_ONLY"},"loc":{"start":{"line":2346},"end":{"line":2355}}}],"loc":{"start":{"line":2220},"end":{"line":2246}}},"loc":{"start":{"line":2198},"end":{"line":2208}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"results","vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":2387},"end":{"line":2387}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":2387},"end":{"line":2387}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":2407},"end":{"line":2407}}},"property":{"type":"Identifier","name":"executeQuery"},"loc":{"start":{"line":2407},"end":{"line":2416}}},"arguments":[{"type":"Identifier","name":"QUERY","loc":{"start":{"line":2430},"end":{"line":2430}}}],"loc":{"start":{"line":2407},"end":{"line":2429}}},"loc":{"start":{"line":2387},"end":{"line":2397}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"results","loc":{"start":{"line":2455},"end":{"line":2455}}},"right":{"type":"Literal","loc":{"start":{"line":2466},"end":{"line":2466}}},"loc":{"start":{"line":2455},"end":{"line":2463}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"makeSuccess","loc":{"start":{"line":2502},"end":{"line":2502}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":2514},"end":{"line":2514}}}],"loc":{"start":{"line":2502},"end":{"line":2513}}},"loc":{"start":{"line":2502},"end":{"line":2502}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"resultsMetaData","vartype":{"type":"Identifier","name":"ResultSetMetaData","loc":{"start":{"line":2534},"end":{"line":2534}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ResultSetMetaData","loc":{"start":{"line":2534},"end":{"line":2534}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"results","loc":{"start":{"line":2570},"end":{"line":2570}}},"property":{"type":"Identifier","name":"getMetaData"},"loc":{"start":{"line":2570},"end":{"line":2577}}},"arguments":[],"loc":{"start":{"line":2570},"end":{"line":2589}}},"loc":{"start":{"line":2534},"end":{"line":2552}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":2609},"end":{"line":2609}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":2609},"end":{"line":2611}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"DatabaseUtilities","loc":{"start":{"line":2623},"end":{"line":2623}}},"property":{"type":"Identifier","name":"writeTable"},"loc":{"start":{"line":2623},"end":{"line":2640}}},"arguments":[{"type":"Identifier","name":"results","loc":{"start":{"line":2652},"end":{"line":2652}}},{"type":"Identifier","name":"resultsMetaData","loc":{"start":{"line":2661},"end":{"line":2661}}}],"loc":{"start":{"line":2623},"end":{"line":2651}}}],"loc":{"start":{"line":2609},"end":{"line":2622}}},"loc":{"start":{"line":2609},"end":{"line":2609}}}],"loc":{"start":{"line":2484},"end":{"line":2692}}},"loc":{"start":{"line":2451},"end":{"line":2451}}}],"loc":{"start":{"line":2111},"end":{"line":2702}}},"loc":{"start":{"line":2099},"end":{"line":2850}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"ec","loc":{"start":{"line":2869},"end":{"line":2869}}},"loc":{"start":{"line":2861},"end":{"line":2861}}}],"loc":{"start":{"line":2034},"end":{"line":2878}}},"code":"\nprotected Element createContent(WebSession s) {\n    ElementContainer ec \u003d new ElementContainer();\n    try {\n        Connection connection \u003d DatabaseUtilities.getConnection(s);\n        Statement statement \u003d connection.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);\n        ResultSet results \u003d statement.executeQuery(QUERY);\n        if (results !\u003d null) {\n            makeSuccess(s);\n            ResultSetMetaData resultsMetaData \u003d results.getMetaData();\n            ec.addElement(DatabaseUtilities.writeTable(results, resultsMetaData));\n        }\n    } catch (Exception e) {\n        s.setMessage(\"Error generating \" + this.getClass().getName());\n        e.printStackTrace();\n    }\n    return (ec);\n}","loc":{"start":{"line":1984},"end":{"line":2002}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultCategory"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Category","loc":{"start":{"line":3017},"end":{"line":3017}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"Category","loc":{"start":{"line":3068},"end":{"line":3068}}},"property":{"type":"Identifier","name":"ADMIN_FUNCTIONS"},"loc":{"start":{"line":3068},"end":{"line":3076}}},"loc":{"start":{"line":3061},"end":{"line":3061}}}],"loc":{"start":{"line":3051},"end":{"line":3098}}},"code":"\nprotected Category getDefaultCategory() {\n    return Category.ADMIN_FUNCTIONS;\n}","loc":{"start":{"line":3007},"end":{"line":3026}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"DEFAULT_RANKING","vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":3126},"end":{"line":3126}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":3126},"end":{"line":3126}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":3156},"end":{"line":3156}}},"arguments":[{"type":"Literal","value":1000,"raw":1000,"loc":{"start":{"line":3164},"end":{"line":3164}}}],"loc":{"start":{"line":3152},"end":{"line":3152}}},"loc":{"start":{"line":3105},"end":{"line":3134}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultRanking"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":3293},"end":{"line":3293}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"DEFAULT_RANKING","loc":{"start":{"line":3342},"end":{"line":3342}}},"loc":{"start":{"line":3335},"end":{"line":3335}}}],"loc":{"start":{"line":3325},"end":{"line":3363}}},"code":"\nprotected Integer getDefaultRanking() {\n    return DEFAULT_RANKING;\n}","loc":{"start":{"line":3283},"end":{"line":3301}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getRole"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":3491},"end":{"line":3491}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"HACKED_ADMIN_ROLE","loc":{"start":{"line":3529},"end":{"line":3529}}},"loc":{"start":{"line":3522},"end":{"line":3522}}}],"loc":{"start":{"line":3512},"end":{"line":3552}}},"code":"\npublic String getRole() {\n    return HACKED_ADMIN_ROLE;\n}","loc":{"start":{"line":3484},"end":{"line":3498}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getTitle"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":3682},"end":{"line":3682}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Literal","value":"User Information","raw":"User Information","loc":{"start":{"line":3722},"end":{"line":3722}}},"loc":{"start":{"line":3714},"end":{"line":3714}}}],"loc":{"start":{"line":3704},"end":{"line":3747}}},"code":"\npublic String getTitle() {\n    return (\"User Information\");\n}","loc":{"start":{"line":3675},"end":{"line":3689}}}],"loc":{"start":{"line":1774},"end":{"line":1781}}}],"loc":{"start":{"line":1},"end":{"line":1}}}