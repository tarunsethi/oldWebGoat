{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":9},"end":{"line":12}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":9},"end":{"line":18}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":9},"end":{"line":26}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":41},"end":{"line":41}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":41},"end":{"line":45}}},"property":{"type":"Identifier","name":"BitSet"},"loc":{"start":{"line":41},"end":{"line":50}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"ThreadWatcher"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"myInterrupted","vartype":{"type":"Identifier","name":"BitSet","loc":{"start":{"line":1467},"end":{"line":1467}}}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"vartype":{"type":"Identifier","name":"BitSet","loc":{"start":{"line":1467},"end":{"line":1467}}},"loc":{"start":{"line":1459},"end":{"line":1474}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"myProcess","vartype":{"type":"Identifier","name":"Process","loc":{"start":{"line":1499},"end":{"line":1499}}}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"vartype":{"type":"Identifier","name":"Process","loc":{"start":{"line":1499},"end":{"line":1499}}},"loc":{"start":{"line":1491},"end":{"line":1507}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"myTimeout","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"vartype":{"type":"PrimitiveType"},"loc":{"start":{"line":1520},"end":{"line":1532}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"\u003cinit\u003e"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"typarams":[],"params":[{"type":"Identifier","name":"p","vartype":{"type":"Identifier","name":"Process","loc":{"start":{"line":1812},"end":{"line":1812}}}},{"type":"Identifier","name":"interrupted","vartype":{"type":"Identifier","name":"BitSet","loc":{"start":{"line":1823},"end":{"line":1823}}}},{"type":"Identifier","name":"timeout","vartype":{"type":"PrimitiveType"}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"myProcess","loc":{"start":{"line":1861},"end":{"line":1861}}},"right":{"type":"Identifier","name":"p","loc":{"start":{"line":1873},"end":{"line":1873}}},"loc":{"start":{"line":1861},"end":{"line":1871}}},"loc":{"start":{"line":1861},"end":{"line":1861}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"myTimeout","loc":{"start":{"line":1932},"end":{"line":1932}}},"right":{"type":"Identifier","name":"timeout","loc":{"start":{"line":1944},"end":{"line":1944}}},"loc":{"start":{"line":1932},"end":{"line":1942}}},"loc":{"start":{"line":1932},"end":{"line":1932}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"myInterrupted","loc":{"start":{"line":1955},"end":{"line":1955}}},"right":{"type":"Identifier","name":"interrupted","loc":{"start":{"line":1971},"end":{"line":1971}}},"loc":{"start":{"line":1955},"end":{"line":1969}}},"loc":{"start":{"line":1955},"end":{"line":1955}}}],"loc":{"start":{"line":1857},"end":{"line":1985}}},"code":"\npublic \u003cinit\u003e(Process p, BitSet interrupted, int timeout) {\n    myProcess \u003d p;\n    myTimeout \u003d timeout;\n    myInterrupted \u003d interrupted;\n}","loc":{"start":{"line":1791},"end":{"line":1798}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"interrupt"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"myInterrupted","loc":{"start":{"line":2148},"end":{"line":2148}}},"property":{"type":"Identifier","name":"set"},"loc":{"start":{"line":2148},"end":{"line":2161}}},"arguments":[{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":2166},"end":{"line":2166}}}],"loc":{"start":{"line":2148},"end":{"line":2165}}},"loc":{"start":{"line":2148},"end":{"line":2148}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"myProcess","loc":{"start":{"line":2225},"end":{"line":2225}}},"property":{"type":"Identifier","name":"destroy"},"loc":{"start":{"line":2225},"end":{"line":2234}}},"arguments":[],"loc":{"start":{"line":2225},"end":{"line":2242}}},"loc":{"start":{"line":2225},"end":{"line":2225}}}],"loc":{"start":{"line":2144},"end":{"line":2561}}},"code":"\npublic void interrupt() {\n    myInterrupted.set(0);\n    myProcess.destroy();\n}","loc":{"start":{"line":2119},"end":{"line":2131}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"run"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"InterruptedException","loc":{"start":{"line":2701},"end":{"line":2701}}}},"body":{"type":"BlockStatement","body":[],"loc":{"start":{"line":2727},"end":{"line":2791}}},"loc":{"start":{"line":2694},"end":{"line":2694}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Thread","loc":{"start":{"line":2665},"end":{"line":2665}}},"property":{"type":"Identifier","name":"sleep"},"loc":{"start":{"line":2665},"end":{"line":2671}}},"arguments":[{"type":"Identifier","name":"myTimeout","loc":{"start":{"line":2678},"end":{"line":2678}}}],"loc":{"start":{"line":2665},"end":{"line":2677}}},"loc":{"start":{"line":2665},"end":{"line":2665}}}],"loc":{"start":{"line":2660},"end":{"line":2692}}},"loc":{"start":{"line":2654},"end":{"line":2791}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"interrupt","loc":{"start":{"line":2796},"end":{"line":2796}}},"arguments":[],"loc":{"start":{"line":2796},"end":{"line":2805}}},"loc":{"start":{"line":2796},"end":{"line":2796}}}],"loc":{"start":{"line":2650},"end":{"line":2810}}},"code":"\npublic void run() {\n    try {\n        Thread.sleep(myTimeout);\n    } catch (InterruptedException e) {\n    }\n    interrupt();\n}","loc":{"start":{"line":2631},"end":{"line":2643}}}],"loc":{"start":{"line":1375},"end":{"line":1382}}}],"loc":{"start":{"line":1},"end":{"line":1}}}