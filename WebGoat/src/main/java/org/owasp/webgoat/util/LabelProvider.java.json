{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":9},"end":{"line":12}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":9},"end":{"line":18}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":9},"end":{"line":26}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":41},"end":{"line":41}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":41},"end":{"line":44}}},"property":{"type":"Identifier","name":"context"},"loc":{"start":{"line":41},"end":{"line":60}}},"property":{"type":"Identifier","name":"support"},"loc":{"start":{"line":41},"end":{"line":68}}},"property":{"type":"Identifier","name":"ReloadableResourceBundleMessageSource"},"loc":{"start":{"line":41},"end":{"line":76}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":123},"end":{"line":123}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":123},"end":{"line":126}}},"property":{"type":"Identifier","name":"core"},"loc":{"start":{"line":123},"end":{"line":142}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":123},"end":{"line":147}}},"property":{"type":"Identifier","name":"Resource"},"loc":{"start":{"line":123},"end":{"line":150}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":168},"end":{"line":168}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":168},"end":{"line":171}}},"property":{"type":"Identifier","name":"core"},"loc":{"start":{"line":168},"end":{"line":187}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":168},"end":{"line":192}}},"property":{"type":"Identifier","name":"ResourceLoader"},"loc":{"start":{"line":168},"end":{"line":195}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":219},"end":{"line":219}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":219},"end":{"line":222}}},"property":{"type":"Identifier","name":"core"},"loc":{"start":{"line":219},"end":{"line":238}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":219},"end":{"line":243}}},"property":{"type":"Identifier","name":"UrlResource"},"loc":{"start":{"line":219},"end":{"line":246}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":267},"end":{"line":267}}},"property":{"type":"Identifier","name":"springframework"},"loc":{"start":{"line":267},"end":{"line":270}}},"property":{"type":"Identifier","name":"stereotype"},"loc":{"start":{"line":267},"end":{"line":286}}},"property":{"type":"Identifier","name":"Component"},"loc":{"start":{"line":267},"end":{"line":297}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":317},"end":{"line":317}}},"property":{"type":"Identifier","name":"inject"},"loc":{"start":{"line":317},"end":{"line":322}}},"property":{"type":"Identifier","name":"Singleton"},"loc":{"start":{"line":317},"end":{"line":329}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":348},"end":{"line":348}}},"property":{"type":"Identifier","name":"net"},"loc":{"start":{"line":348},"end":{"line":352}}},"property":{"type":"Identifier","name":"MalformedURLException"},"loc":{"start":{"line":348},"end":{"line":356}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":387},"end":{"line":387}}},"property":{"type":"Identifier","name":"nio"},"loc":{"start":{"line":387},"end":{"line":391}}},"property":{"type":"Identifier","name":"file"},"loc":{"start":{"line":387},"end":{"line":395}}},"property":{"type":"Identifier","name":"Path"},"loc":{"start":{"line":387},"end":{"line":400}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":414},"end":{"line":414}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":414},"end":{"line":418}}},"property":{"type":"Identifier","name":"Arrays"},"loc":{"start":{"line":414},"end":{"line":423}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":439},"end":{"line":439}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":439},"end":{"line":443}}},"property":{"type":"Identifier","name":"List"},"loc":{"start":{"line":439},"end":{"line":448}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":462},"end":{"line":462}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":462},"end":{"line":466}}},"property":{"type":"Identifier","name":"Locale"},"loc":{"start":{"line":462},"end":{"line":471}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"LabelProvider"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Component","loc":{"start":{"line":1738},"end":{"line":1738}}},"arguments":[]},{"type":"Annotation","annotationType":{"type":"Identifier","name":"Singleton","loc":{"start":{"line":1749},"end":{"line":1749}}},"arguments":[]}]},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"DEFAULT_LANGUAGE","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1893},"end":{"line":1893}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1893},"end":{"line":1893}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"Locale","loc":{"start":{"line":1919},"end":{"line":1919}}},"property":{"type":"Identifier","name":"ENGLISH"},"loc":{"start":{"line":1919},"end":{"line":1925}}},"property":{"type":"Identifier","name":"getLanguage"},"loc":{"start":{"line":1919},"end":{"line":1933}}},"arguments":[],"loc":{"start":{"line":1919},"end":{"line":1945}}},"loc":{"start":{"line":1873},"end":{"line":1900}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"SUPPORTED","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":1975},"end":{"line":1975}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":1975},"end":{"line":1975}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Arrays","loc":{"start":{"line":2000},"end":{"line":2000}}},"property":{"type":"Identifier","name":"asList"},"loc":{"start":{"line":2000},"end":{"line":2006}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"Locale","loc":{"start":{"line":2014},"end":{"line":2014}}},"property":{"type":"Identifier","name":"GERMAN"},"loc":{"start":{"line":2014},"end":{"line":2020}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"Locale","loc":{"start":{"line":2029},"end":{"line":2029}}},"property":{"type":"Identifier","name":"FRENCH"},"loc":{"start":{"line":2029},"end":{"line":2035}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"Locale","loc":{"start":{"line":2044},"end":{"line":2044}}},"property":{"type":"Identifier","name":"ENGLISH"},"loc":{"start":{"line":2044},"end":{"line":2050}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Locale","loc":{"start":{"line":2072},"end":{"line":2072}}},"property":{"type":"Identifier","name":"forLanguageTag"},"loc":{"start":{"line":2072},"end":{"line":2078}}},"arguments":[{"type":"Literal","value":"ru","raw":"ru","loc":{"start":{"line":2094},"end":{"line":2094}}}],"loc":{"start":{"line":2072},"end":{"line":2093}}}],"loc":{"start":{"line":2000},"end":{"line":2013}}},"loc":{"start":{"line":1954},"end":{"line":1988}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"labels","vartype":{"type":"Identifier","name":"ReloadableResourceBundleMessageSource","loc":{"start":{"line":2120},"end":{"line":2120}}}},"modifiers":{"type":"Modifiers","modifiers":["private","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"ReloadableResourceBundleMessageSource","loc":{"start":{"line":2120},"end":{"line":2120}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ReloadableResourceBundleMessageSource","loc":{"start":{"line":2171},"end":{"line":2171}}},"arguments":[],"loc":{"start":{"line":2167},"end":{"line":2167}}},"loc":{"start":{"line":2106},"end":{"line":2158}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"pluginLabels","vartype":{"type":"Identifier","name":"ReloadableResourceBundleMessageSource","loc":{"start":{"line":2237},"end":{"line":2237}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"ReloadableResourceBundleMessageSource","loc":{"start":{"line":2237},"end":{"line":2237}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ReloadableResourceBundleMessageSource","loc":{"start":{"line":2294},"end":{"line":2294}}},"arguments":[],"loc":{"start":{"line":2290},"end":{"line":2290}}},"loc":{"start":{"line":2216},"end":{"line":2275}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"\u003cinit\u003e"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"labels","loc":{"start":{"line":2434},"end":{"line":2434}}},"property":{"type":"Identifier","name":"setBasename"},"loc":{"start":{"line":2434},"end":{"line":2440}}},"arguments":[{"type":"Literal","value":"classpath:/i18n/WebGoatLabels","raw":"classpath:/i18n/WebGoatLabels","loc":{"start":{"line":2453},"end":{"line":2453}}}],"loc":{"start":{"line":2434},"end":{"line":2452}}},"loc":{"start":{"line":2434},"end":{"line":2434}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"labels","loc":{"start":{"line":2495},"end":{"line":2495}}},"property":{"type":"Identifier","name":"setFallbackToSystemLocale"},"loc":{"start":{"line":2495},"end":{"line":2501}}},"arguments":[{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":2528},"end":{"line":2528}}}],"loc":{"start":{"line":2495},"end":{"line":2527}}},"loc":{"start":{"line":2495},"end":{"line":2495}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"labels","loc":{"start":{"line":2544},"end":{"line":2544}}},"property":{"type":"Identifier","name":"setUseCodeAsDefaultMessage"},"loc":{"start":{"line":2544},"end":{"line":2550}}},"arguments":[{"type":"Literal","value":1,"raw":1,"loc":{"start":{"line":2578},"end":{"line":2578}}}],"loc":{"start":{"line":2544},"end":{"line":2577}}},"loc":{"start":{"line":2544},"end":{"line":2544}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"pluginLabels","loc":{"start":{"line":2593},"end":{"line":2593}}},"property":{"type":"Identifier","name":"setParentMessageSource"},"loc":{"start":{"line":2593},"end":{"line":2605}}},"arguments":[{"type":"Identifier","name":"labels","loc":{"start":{"line":2629},"end":{"line":2629}}}],"loc":{"start":{"line":2593},"end":{"line":2628}}},"loc":{"start":{"line":2593},"end":{"line":2593}}}],"loc":{"start":{"line":2424},"end":{"line":2642}}},"code":"\npublic \u003cinit\u003e() {\n    labels.setBasename(\"classpath:/i18n/WebGoatLabels\");\n    labels.setFallbackToSystemLocale(false);\n    labels.setUseCodeAsDefaultMessage(true);\n    pluginLabels.setParentMessageSource(labels);\n}","loc":{"start":{"line":2401},"end":{"line":2408}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"updatePluginResources"},"modifiers":{"type":"Modifiers","modifiers":["public","static"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"propertyFile","vartype":{"type":"Identifier","name":"Path","loc":{"start":{"line":2820},"end":{"line":2820}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"pluginLabels","loc":{"start":{"line":2849},"end":{"line":2849}}},"property":{"type":"Identifier","name":"setBasename"},"loc":{"start":{"line":2849},"end":{"line":2861}}},"arguments":[{"type":"Literal","value":"WebGoatLabels","raw":"WebGoatLabels","loc":{"start":{"line":2874},"end":{"line":2874}}}],"loc":{"start":{"line":2849},"end":{"line":2873}}},"loc":{"start":{"line":2849},"end":{"line":2849}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"pluginLabels","loc":{"start":{"line":2900},"end":{"line":2900}}},"property":{"type":"Identifier","name":"setFallbackToSystemLocale"},"loc":{"start":{"line":2900},"end":{"line":2912}}},"arguments":[{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":2939},"end":{"line":2939}}}],"loc":{"start":{"line":2900},"end":{"line":2938}}},"loc":{"start":{"line":2900},"end":{"line":2900}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"pluginLabels","loc":{"start":{"line":2955},"end":{"line":2955}}},"property":{"type":"Identifier","name":"setUseCodeAsDefaultMessage"},"loc":{"start":{"line":2955},"end":{"line":2967}}},"arguments":[{"type":"Literal","value":1,"raw":1,"loc":{"start":{"line":2995},"end":{"line":2995}}}],"loc":{"start":{"line":2955},"end":{"line":2994}}},"loc":{"start":{"line":2955},"end":{"line":2955}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"pluginLabels","loc":{"start":{"line":3010},"end":{"line":3010}}},"property":{"type":"Identifier","name":"setResourceLoader"},"loc":{"start":{"line":3010},"end":{"line":3022}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ResourceLoader","loc":{"start":{"line":3045},"end":{"line":3045}}},"arguments":[],"loc":{"start":{"line":3041},"end":{"line":3041}}}],"loc":{"start":{"line":3010},"end":{"line":3040}}},"loc":{"start":{"line":3010},"end":{"line":3010}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"pluginLabels","loc":{"start":{"line":3546},"end":{"line":3546}}},"property":{"type":"Identifier","name":"clearCache"},"loc":{"start":{"line":3546},"end":{"line":3558}}},"arguments":[],"loc":{"start":{"line":3546},"end":{"line":3569}}},"loc":{"start":{"line":3546},"end":{"line":3546}}}],"loc":{"start":{"line":2839},"end":{"line":3577}}},"code":"\npublic static void updatePluginResources(final Path propertyFile) {\n    pluginLabels.setBasename(\"WebGoatLabels\");\n    pluginLabels.setFallbackToSystemLocale(false);\n    pluginLabels.setUseCodeAsDefaultMessage(true);\n    pluginLabels.setResourceLoader(new ResourceLoader(){\n        \n        @Override()\n        public Resource getResource(String location) {\n            try {\n                return new UrlResource(propertyFile.toUri());\n            } catch (MalformedURLException e) {\n                throw new RuntimeException(e);\n            }\n        }\n        \n        @Override()\n        public ClassLoader getClassLoader() {\n            return Thread.currentThread().getContextClassLoader();\n        }\n    });\n    pluginLabels.clearCache();\n}","loc":{"start":{"line":2773},"end":{"line":2792}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"get"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":3796},"end":{"line":3796}}},"typarams":[],"params":[{"type":"Identifier","name":"locale","vartype":{"type":"Identifier","name":"Locale","loc":{"start":{"line":3807},"end":{"line":3807}}}},{"type":"Identifier","name":"strName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":3822},"end":{"line":3822}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"pluginLabels","loc":{"start":{"line":3855},"end":{"line":3855}}},"property":{"type":"Identifier","name":"getMessage"},"loc":{"start":{"line":3855},"end":{"line":3867}}},"arguments":[{"type":"Identifier","name":"strName","loc":{"start":{"line":3879},"end":{"line":3879}}},{"type":"Literal","loc":{"start":{"line":3888},"end":{"line":3888}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"useLocaleOrFallbackToEnglish","loc":{"start":{"line":3894},"end":{"line":3894}}},"arguments":[{"type":"Identifier","name":"locale","loc":{"start":{"line":3923},"end":{"line":3923}}}],"loc":{"start":{"line":3894},"end":{"line":3922}}}],"loc":{"start":{"line":3855},"end":{"line":3878}}},"loc":{"start":{"line":3848},"end":{"line":3848}}}],"loc":{"start":{"line":3838},"end":{"line":3937}}},"code":"\npublic String get(Locale locale, String strName) {\n    return pluginLabels.getMessage(strName, null, useLocaleOrFallbackToEnglish(locale));\n}","loc":{"start":{"line":3789},"end":{"line":3803}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"useLocaleOrFallbackToEnglish"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"Identifier","name":"Locale","loc":{"start":{"line":3952},"end":{"line":3952}}},"typarams":[],"params":[{"type":"Identifier","name":"locale","vartype":{"type":"Identifier","name":"Locale","loc":{"start":{"line":3988},"end":{"line":3988}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"ConditionalExpression","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"SUPPORTED","loc":{"start":{"line":4020},"end":{"line":4020}}},"property":{"type":"Identifier","name":"contains"},"loc":{"start":{"line":4020},"end":{"line":4029}}},"arguments":[{"type":"Identifier","name":"locale","loc":{"start":{"line":4039},"end":{"line":4039}}}],"loc":{"start":{"line":4020},"end":{"line":4038}}},"alternate":{"type":"MemberExpression","object":{"type":"Identifier","name":"Locale","loc":{"start":{"line":4049},"end":{"line":4049}}},"property":{"type":"Identifier","name":"ENGLISH"},"loc":{"start":{"line":4049},"end":{"line":4055}}},"consequent":{"type":"Identifier","name":"locale","loc":{"start":{"line":4066},"end":{"line":4066}}},"loc":{"start":{"line":4020},"end":{"line":4047}}},"loc":{"start":{"line":4013},"end":{"line":4013}}}],"loc":{"start":{"line":4003},"end":{"line":4078}}},"code":"\nprivate Locale useLocaleOrFallbackToEnglish(Locale locale) {\n    return SUPPORTED.contains(locale) ? Locale.ENGLISH : locale;\n}","loc":{"start":{"line":3944},"end":{"line":3959}}}],"loc":{"start":{"line":1737},"end":{"line":1766}}}],"loc":{"start":{"line":1},"end":{"line":1}}}