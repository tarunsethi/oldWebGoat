{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":8},"end":{"line":11}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":8},"end":{"line":17}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":8},"end":{"line":25}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":40},"end":{"line":40}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":40},"end":{"line":44}}},"property":{"type":"Identifier","name":"HashMap"},"loc":{"start":{"line":40},"end":{"line":49}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":66},"end":{"line":66}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":66},"end":{"line":70}}},"property":{"type":"Identifier","name":"Locale"},"loc":{"start":{"line":66},"end":{"line":75}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":91},"end":{"line":91}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":91},"end":{"line":95}}},"property":{"type":"Identifier","name":"ResourceBundle"},"loc":{"start":{"line":91},"end":{"line":100}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":125},"end":{"line":125}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":125},"end":{"line":128}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":125},"end":{"line":134}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":125},"end":{"line":142}}},"property":{"type":"Identifier","name":"WebgoatContext"},"loc":{"start":{"line":125},"end":{"line":150}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"WebGoatI18N"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Deprecated","loc":{"start":{"line":169},"end":{"line":169}}},"arguments":[]}]},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"labels","vartype":{"type":"Identifier","name":"HashMap","loc":{"start":{"line":285},"end":{"line":285}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static"],"annotations":[]},"vartype":{"type":"Identifier","name":"HashMap","loc":{"start":{"line":285},"end":{"line":285}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"HashMap","loc":{"start":{"line":330},"end":{"line":330}}},"arguments":[],"loc":{"start":{"line":326},"end":{"line":326}}},"loc":{"start":{"line":270},"end":{"line":317}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"currentLocale","vartype":{"type":"Identifier","name":"Locale","loc":{"start":{"line":381},"end":{"line":381}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static"],"annotations":[]},"vartype":{"type":"Identifier","name":"Locale","loc":{"start":{"line":381},"end":{"line":381}}},"loc":{"start":{"line":366},"end":{"line":388}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"localeController","vartype":{"type":"Identifier","name":"WebGoatResourceBundleController","loc":{"start":{"line":419},"end":{"line":419}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static"],"annotations":[]},"vartype":{"type":"Identifier","name":"WebGoatResourceBundleController","loc":{"start":{"line":419},"end":{"line":419}}},"loc":{"start":{"line":404},"end":{"line":451}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"\u003cinit\u003e"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"typarams":[],"params":[{"type":"Identifier","name":"context","vartype":{"type":"Identifier","name":"WebgoatContext","loc":{"start":{"line":623},"end":{"line":623}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"currentLocale","loc":{"start":{"line":652},"end":{"line":652}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Locale","loc":{"start":{"line":672},"end":{"line":672}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"context","loc":{"start":{"line":679},"end":{"line":679}}},"property":{"type":"Identifier","name":"getDefaultLanguage"},"loc":{"start":{"line":679},"end":{"line":686}}},"arguments":[],"loc":{"start":{"line":679},"end":{"line":705}}}],"loc":{"start":{"line":668},"end":{"line":668}}},"loc":{"start":{"line":652},"end":{"line":666}}},"loc":{"start":{"line":652},"end":{"line":652}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"localeController","loc":{"start":{"line":712},"end":{"line":712}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"WebGoatResourceBundleController","loc":{"start":{"line":735},"end":{"line":735}}},"arguments":[{"type":"Identifier","name":"currentLocale","loc":{"start":{"line":767},"end":{"line":767}}}],"loc":{"start":{"line":731},"end":{"line":731}}},"loc":{"start":{"line":712},"end":{"line":729}}},"loc":{"start":{"line":712},"end":{"line":712}}}],"loc":{"start":{"line":648},"end":{"line":784}}},"code":"\npublic \u003cinit\u003e(WebgoatContext context) {\n    currentLocale \u003d new Locale(context.getDefaultLanguage());\n    localeController \u003d new WebGoatResourceBundleController(currentLocale);\n}","loc":{"start":{"line":604},"end":{"line":611}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"loadLanguage"},"modifiers":{"type":"Modifiers","modifiers":["public","static"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Deprecated","loc":{"start":{"line":884},"end":{"line":884}}},"arguments":[]}]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"language","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":928},"end":{"line":928}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[],"loc":{"start":{"line":946},"end":{"line":965}}},"code":"\n@Deprecated()\npublic static void loadLanguage(String language) {\n}","loc":{"start":{"line":883},"end":{"line":915}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"setCurrentLocale"},"modifiers":{"type":"Modifiers","modifiers":["public","static"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"locale","vartype":{"type":"Identifier","name":"Locale","loc":{"start":{"line":1133},"end":{"line":1133}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"currentLocale","loc":{"start":{"line":1158},"end":{"line":1158}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":1158},"end":{"line":1171}}},"arguments":[{"type":"Identifier","name":"locale","loc":{"start":{"line":1179},"end":{"line":1179}}}],"loc":{"start":{"line":1158},"end":{"line":1178}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":1157},"end":{"line":1157}}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"labels","loc":{"start":{"line":1200},"end":{"line":1200}}},"property":{"type":"Identifier","name":"containsKey"},"loc":{"start":{"line":1200},"end":{"line":1206}}},"arguments":[{"type":"Identifier","name":"locale","loc":{"start":{"line":1219},"end":{"line":1219}}}],"loc":{"start":{"line":1200},"end":{"line":1218}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":1199},"end":{"line":1199}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"resBundle","vartype":{"type":"Identifier","name":"ResourceBundle","loc":{"start":{"line":1237},"end":{"line":1237}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ResourceBundle","loc":{"start":{"line":1237},"end":{"line":1237}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ResourceBundle","loc":{"start":{"line":1264},"end":{"line":1264}}},"property":{"type":"Identifier","name":"getBundle"},"loc":{"start":{"line":1264},"end":{"line":1278}}},"arguments":[{"type":"Literal","value":"WebGoatLabels","raw":"WebGoatLabels","loc":{"start":{"line":1289},"end":{"line":1289}}},{"type":"Identifier","name":"locale","loc":{"start":{"line":1306},"end":{"line":1306}}},{"type":"Identifier","name":"localeController","loc":{"start":{"line":1314},"end":{"line":1314}}}],"loc":{"start":{"line":1264},"end":{"line":1288}}},"loc":{"start":{"line":1237},"end":{"line":1252}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"labels","loc":{"start":{"line":1337},"end":{"line":1337}}},"property":{"type":"Identifier","name":"put"},"loc":{"start":{"line":1337},"end":{"line":1343}}},"arguments":[{"type":"Identifier","name":"locale","loc":{"start":{"line":1348},"end":{"line":1348}}},{"type":"Identifier","name":"resBundle","loc":{"start":{"line":1356},"end":{"line":1356}}}],"loc":{"start":{"line":1337},"end":{"line":1347}}},"loc":{"start":{"line":1337},"end":{"line":1337}}}],"loc":{"start":{"line":1231},"end":{"line":1371}}},"loc":{"start":{"line":1195},"end":{"line":1195}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":1376},"end":{"line":1376}}},"property":{"type":"Identifier","name":"currentLocale"},"loc":{"start":{"line":1376},"end":{"line":1387}}},"right":{"type":"Identifier","name":"locale","loc":{"start":{"line":1404},"end":{"line":1404}}},"loc":{"start":{"line":1376},"end":{"line":1402}}},"loc":{"start":{"line":1376},"end":{"line":1376}}}],"loc":{"start":{"line":1190},"end":{"line":1414}}},"loc":{"start":{"line":1153},"end":{"line":1153}}}],"loc":{"start":{"line":1149},"end":{"line":1417}}},"code":"\npublic static void setCurrentLocale(Locale locale) {\n    if (!currentLocale.equals(locale)) {\n        if (!labels.containsKey(locale)) {\n            ResourceBundle resBundle \u003d ResourceBundle.getBundle(\"WebGoatLabels\", locale, localeController);\n            labels.put(locale, resBundle);\n        }\n        WebGoatI18N.currentLocale \u003d locale;\n    }\n}","loc":{"start":{"line":1097},"end":{"line":1116}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"get"},"modifiers":{"type":"Modifiers","modifiers":["public","static"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":1566},"end":{"line":1566}}},"typarams":[],"params":[{"type":"Identifier","name":"strName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1577},"end":{"line":1577}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"labels","loc":{"start":{"line":1605},"end":{"line":1605}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":1605},"end":{"line":1611}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":1616},"end":{"line":1616}}},"property":{"type":"Identifier","name":"currentLocale"},"loc":{"start":{"line":1616},"end":{"line":1627}}}],"loc":{"start":{"line":1605},"end":{"line":1615}}},"property":{"type":"Identifier","name":"getString"},"loc":{"start":{"line":1605},"end":{"line":1642}}},"arguments":[{"type":"Identifier","name":"strName","loc":{"start":{"line":1653},"end":{"line":1653}}}],"loc":{"start":{"line":1605},"end":{"line":1652}}},"loc":{"start":{"line":1598},"end":{"line":1598}}}],"loc":{"start":{"line":1594},"end":{"line":1664}}},"code":"\npublic static String get(String strName) {\n    return labels.get(WebGoatI18N.currentLocale).getString(strName);\n}","loc":{"start":{"line":1552},"end":{"line":1573}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"WebGoatResourceBundleController"},"modifiers":{"type":"Modifiers","modifiers":["private","static"],"annotations":[]},"extending":{"type":"MemberExpression","object":{"type":"Identifier","name":"ResourceBundle","loc":{"start":{"line":1729},"end":{"line":1729}}},"property":{"type":"Identifier","name":"Control"},"loc":{"start":{"line":1729},"end":{"line":1743}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fallbackLocale","vartype":{"type":"Identifier","name":"Locale","loc":{"start":{"line":1765},"end":{"line":1765}}}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"vartype":{"type":"Identifier","name":"Locale","loc":{"start":{"line":1765},"end":{"line":1765}}},"loc":{"start":{"line":1757},"end":{"line":1772}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"\u003cinit\u003e"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"typarams":[],"params":[{"type":"Identifier","name":"l","vartype":{"type":"Identifier","name":"Locale","loc":{"start":{"line":1830},"end":{"line":1830}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"fallbackLocale","loc":{"start":{"line":1847},"end":{"line":1847}}},"right":{"type":"Identifier","name":"l","loc":{"start":{"line":1864},"end":{"line":1864}}},"loc":{"start":{"line":1847},"end":{"line":1862}}},"loc":{"start":{"line":1847},"end":{"line":1847}}}],"loc":{"start":{"line":1842},"end":{"line":1869}}},"code":"\npublic \u003cinit\u003e(Locale l) {\n    fallbackLocale \u003d l;\n}","loc":{"start":{"line":1791},"end":{"line":1798}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getFallbackLocale"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Override","loc":{"start":{"line":1876},"end":{"line":1876}}},"arguments":[]}]},"restype":{"type":"Identifier","name":"Locale","loc":{"start":{"line":1894},"end":{"line":1894}}},"typarams":[],"params":[{"type":"Identifier","name":"baseName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1919},"end":{"line":1919}}}},{"type":"Identifier","name":"locale","vartype":{"type":"Identifier","name":"Locale","loc":{"start":{"line":1936},"end":{"line":1936}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fallbackLocale","loc":{"start":{"line":1963},"end":{"line":1963}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":1963},"end":{"line":1977}}},"arguments":[{"type":"Identifier","name":"locale","loc":{"start":{"line":1985},"end":{"line":1985}}}],"loc":{"start":{"line":1963},"end":{"line":1984}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":1961},"end":{"line":1961}}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"fallbackLocale","loc":{"start":{"line":2007},"end":{"line":2007}}},"loc":{"start":{"line":2000},"end":{"line":2000}}}],"loc":{"start":{"line":1994},"end":{"line":2026}}},"loc":{"start":{"line":1958},"end":{"line":1958}}},{"type":"ReturnStatement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"Locale","loc":{"start":{"line":2038},"end":{"line":2038}}},"property":{"type":"Identifier","name":"ROOT"},"loc":{"start":{"line":2038},"end":{"line":2044}}},"loc":{"start":{"line":2031},"end":{"line":2031}}}],"loc":{"start":{"line":1953},"end":{"line":2053}}},"code":"\n@Override()\npublic Locale getFallbackLocale(String baseName, Locale locale) {\n    if (!fallbackLocale.equals(locale)) {\n        return fallbackLocale;\n    }\n    return Locale.ROOT;\n}","loc":{"start":{"line":1875},"end":{"line":1901}}}],"loc":{"start":{"line":1668},"end":{"line":1683}}}],"loc":{"start":{"line":168},"end":{"line":248}}}],"loc":{"start":{"line":0},"end":{"line":0}}}