{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":9},"end":{"line":12}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":9},"end":{"line":18}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":9},"end":{"line":26}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":44},"end":{"line":44}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":44},"end":{"line":48}}},"property":{"type":"Identifier","name":"Hashtable"},"loc":{"start":{"line":44},"end":{"line":53}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":72},"end":{"line":72}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":72},"end":{"line":76}}},"property":{"type":"Identifier","name":"Map"},"loc":{"start":{"line":72},"end":{"line":81}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"Authorization"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"permissions","vartype":{"type":"Identifier","name":"Map","loc":{"start":{"line":1369},"end":{"line":1369}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Map","loc":{"start":{"line":1369},"end":{"line":1369}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Hashtable","loc":{"start":{"line":1409},"end":{"line":1409}}},"arguments":[],"loc":{"start":{"line":1405},"end":{"line":1405}}},"loc":{"start":{"line":1369},"end":{"line":1391}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"\u003cinit\u003e"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[],"loc":{"start":{"line":1518},"end":{"line":1521}}},"code":"\npublic \u003cinit\u003e() {\n}","loc":{"start":{"line":1494},"end":{"line":1501}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"setPermission"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"userId","vartype":{"type":"PrimitiveType"}},{"type":"Identifier","name":"functionId","vartype":{"type":"PrimitiveType"}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"permissions","loc":{"start":{"line":1678},"end":{"line":1678}}},"property":{"type":"Identifier","name":"put"},"loc":{"start":{"line":1678},"end":{"line":1689}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":1698},"end":{"line":1698}}},"arguments":[{"type":"Identifier","name":"userId","loc":{"start":{"line":1706},"end":{"line":1706}}}],"loc":{"start":{"line":1694},"end":{"line":1694}}},{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":1719},"end":{"line":1719}}},"arguments":[{"type":"Identifier","name":"functionId","loc":{"start":{"line":1727},"end":{"line":1727}}}],"loc":{"start":{"line":1715},"end":{"line":1715}}}],"loc":{"start":{"line":1678},"end":{"line":1693}}},"loc":{"start":{"line":1678},"end":{"line":1678}}}],"loc":{"start":{"line":1674},"end":{"line":1742}}},"code":"\npublic void setPermission(int userId, int functionId) {\n    permissions.put(new Integer(userId), new Integer(functionId));\n}","loc":{"start":{"line":1619},"end":{"line":1631}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"isAllowed"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"userId","vartype":{"type":"PrimitiveType"}},{"type":"Identifier","name":"functionId","vartype":{"type":"PrimitiveType"}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"permissions","loc":{"start":{"line":1925},"end":{"line":1925}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":1925},"end":{"line":1936}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":1945},"end":{"line":1945}}},"arguments":[{"type":"Identifier","name":"userId","loc":{"start":{"line":1953},"end":{"line":1953}}}],"loc":{"start":{"line":1941},"end":{"line":1941}}}],"loc":{"start":{"line":1925},"end":{"line":1940}}},"right":{"type":"Literal","loc":{"start":{"line":1965},"end":{"line":1965}}},"loc":{"start":{"line":1925},"end":{"line":1962}}},"loc":{"start":{"line":1917},"end":{"line":1917}}}],"loc":{"start":{"line":1913},"end":{"line":1973}}},"code":"\npublic boolean isAllowed(int userId, int functionId) {\n    return (permissions.get(new Integer(userId)) !\u003d null);\n}","loc":{"start":{"line":1859},"end":{"line":1874}}}],"loc":{"start":{"line":1338},"end":{"line":1345}}}],"loc":{"start":{"line":1},"end":{"line":1}}}