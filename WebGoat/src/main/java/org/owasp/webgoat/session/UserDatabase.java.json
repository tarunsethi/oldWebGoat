{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":8},"end":{"line":11}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":8},"end":{"line":17}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":8},"end":{"line":25}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":43},"end":{"line":43}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":43},"end":{"line":47}}},"property":{"type":"Identifier","name":"*"},"loc":{"start":{"line":43},"end":{"line":51}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":62},"end":{"line":62}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":62},"end":{"line":66}}},"property":{"type":"Identifier","name":"ArrayList"},"loc":{"start":{"line":62},"end":{"line":71}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":90},"end":{"line":90}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":90},"end":{"line":94}}},"property":{"type":"Identifier","name":"Iterator"},"loc":{"start":{"line":90},"end":{"line":99}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":117},"end":{"line":117}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":117},"end":{"line":121}}},"property":{"type":"Identifier","name":"File"},"loc":{"start":{"line":117},"end":{"line":124}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"UserDatabase"},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"userDB","vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":165},"end":{"line":165}}}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":165},"end":{"line":165}}},"loc":{"start":{"line":157},"end":{"line":176}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"USER_DB_URI","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":202},"end":{"line":202}}}},"modifiers":{"type":"Modifiers","modifiers":["private","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":202},"end":{"line":202}}},"init":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"jdbc:h2:","raw":"jdbc:h2:","loc":{"start":{"line":223},"end":{"line":223}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":236},"end":{"line":236}}},"property":{"type":"Identifier","name":"getProperty"},"loc":{"start":{"line":236},"end":{"line":242}}},"arguments":[{"type":"Literal","value":"user.dir","raw":"user.dir","loc":{"start":{"line":255},"end":{"line":255}}}],"loc":{"start":{"line":236},"end":{"line":254}}},"loc":{"start":{"line":223},"end":{"line":234}}},"right":{"type":"MemberExpression","object":{"type":"Identifier","name":"File","loc":{"start":{"line":269},"end":{"line":269}}},"property":{"type":"Identifier","name":"separator"},"loc":{"start":{"line":269},"end":{"line":273}}},"loc":{"start":{"line":223},"end":{"line":267}}},"right":{"type":"Literal","value":"UserDatabase","raw":"UserDatabase","loc":{"start":{"line":286},"end":{"line":286}}},"loc":{"start":{"line":223},"end":{"line":284}}},"loc":{"start":{"line":188},"end":{"line":209}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"CREATE_USERS_TABLE","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":321},"end":{"line":321}}}},"modifiers":{"type":"Modifiers","modifiers":["private","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":321},"end":{"line":321}}},"init":{"type":"Literal","value":"CREATE TABLE IF NOT EXISTS users (id INTEGER PRIMARY KEY AUTO_INCREMENT, username VARCHAR(255) NOT NULL UNIQUE);","raw":"CREATE TABLE IF NOT EXISTS users (id INTEGER PRIMARY KEY AUTO_INCREMENT, username VARCHAR(255) NOT NULL UNIQUE);","loc":{"start":{"line":349},"end":{"line":349}}},"loc":{"start":{"line":307},"end":{"line":328}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"CREATE_ROLES_TABLE","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":483},"end":{"line":483}}}},"modifiers":{"type":"Modifiers","modifiers":["private","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":483},"end":{"line":483}}},"init":{"type":"Literal","value":"CREATE TABLE IF NOT EXISTS roles (id INTEGER PRIMARY KEY AUTO_INCREMENT, rolename VARCHAR(255) NOT NULL UNIQUE);","raw":"CREATE TABLE IF NOT EXISTS roles (id INTEGER PRIMARY KEY AUTO_INCREMENT, rolename VARCHAR(255) NOT NULL UNIQUE);","loc":{"start":{"line":511},"end":{"line":511}}},"loc":{"start":{"line":469},"end":{"line":490}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"CREATE_USER_ROLES_TABLE","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":645},"end":{"line":645}}}},"modifiers":{"type":"Modifiers","modifiers":["private","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":645},"end":{"line":645}}},"init":{"type":"Literal","value":"CREATE TABLE IF NOT EXISTS user_roles (id INTEGER PRIMARY KEY AUTO_INCREMENT, user_id INTEGER NOT NULL, role_id INTEGER NOT NULL, FOREIGN KEY (user_id) REFERENCES users(id), FOREIGN KEY (role_id) REFERENCES roles(id));","raw":"CREATE TABLE IF NOT EXISTS user_roles (id INTEGER PRIMARY KEY AUTO_INCREMENT, user_id INTEGER NOT NULL, role_id INTEGER NOT NULL, FOREIGN KEY (user_id) REFERENCES users(id), FOREIGN KEY (role_id) REFERENCES roles(id));","loc":{"start":{"line":678},"end":{"line":678}}},"loc":{"start":{"line":631},"end":{"line":652}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ADD_DEFAULT_USERS","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":918},"end":{"line":918}}}},"modifiers":{"type":"Modifiers","modifiers":["private","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":918},"end":{"line":918}}},"init":{"type":"Literal","value":"INSERT INTO users (username) VALUES (\u0027webgoat\u0027),(\u0027basic\u0027),(\u0027guest\u0027);","raw":"INSERT INTO users (username) VALUES (\u0027webgoat\u0027),(\u0027basic\u0027),(\u0027guest\u0027);","loc":{"start":{"line":945},"end":{"line":945}}},"loc":{"start":{"line":904},"end":{"line":925}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ADD_DEFAULT_ROLES","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1035},"end":{"line":1035}}}},"modifiers":{"type":"Modifiers","modifiers":["private","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1035},"end":{"line":1035}}},"init":{"type":"Literal","value":"INSERT INTO roles (rolename) VALUES (\u0027webgoat_basic\u0027),(\u0027webgoat_admin\u0027),(\u0027webgoat_user\u0027);","raw":"INSERT INTO roles (rolename) VALUES (\u0027webgoat_basic\u0027),(\u0027webgoat_admin\u0027),(\u0027webgoat_user\u0027);","loc":{"start":{"line":1062},"end":{"line":1062}}},"loc":{"start":{"line":1021},"end":{"line":1042}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ADD_ROLE_TO_USER","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1173},"end":{"line":1173}}}},"modifiers":{"type":"Modifiers","modifiers":["private","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1173},"end":{"line":1173}}},"init":{"type":"Literal","value":"INSERT INTO user_roles (user_id, role_id) SELECT users.id, roles.id FROM users, roles WHERE users.username \u003d ? AND roles.rolename \u003d ?;","raw":"INSERT INTO user_roles (user_id, role_id) SELECT users.id, roles.id FROM users, roles WHERE users.username \u003d ? AND roles.rolename \u003d ?;","loc":{"start":{"line":1199},"end":{"line":1199}}},"loc":{"start":{"line":1159},"end":{"line":1180}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"QUERY_ALL_USERS","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1356},"end":{"line":1356}}}},"modifiers":{"type":"Modifiers","modifiers":["private","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1356},"end":{"line":1356}}},"init":{"type":"Literal","value":"SELECT username FROM users;","raw":"SELECT username FROM users;","loc":{"start":{"line":1381},"end":{"line":1381}}},"loc":{"start":{"line":1342},"end":{"line":1363}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"QUERY_ALL_ROLES_FOR_USERNAME","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1430},"end":{"line":1430}}}},"modifiers":{"type":"Modifiers","modifiers":["private","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1430},"end":{"line":1430}}},"init":{"type":"Literal","value":"SELECT rolename FROM roles, user_roles, users WHERE roles.id \u003d user_roles.role_id AND user_roles.user_id \u003d users.id AND users.username \u003d ?;","raw":"SELECT rolename FROM roles, user_roles, users WHERE roles.id \u003d user_roles.role_id AND user_roles.user_id \u003d users.id AND users.username \u003d ?;","loc":{"start":{"line":1468},"end":{"line":1468}}},"loc":{"start":{"line":1416},"end":{"line":1437}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"QUERY_TABLE_COUNT","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1629},"end":{"line":1629}}}},"modifiers":{"type":"Modifiers","modifiers":["private","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1629},"end":{"line":1629}}},"init":{"type":"Literal","value":"SELECT count(id) AS count FROM table;","raw":"SELECT count(id) AS count FROM table;","loc":{"start":{"line":1656},"end":{"line":1656}}},"loc":{"start":{"line":1615},"end":{"line":1636}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"DELETE_ALL_ROLES_FOR_USER","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1716},"end":{"line":1716}}}},"modifiers":{"type":"Modifiers","modifiers":["private","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1716},"end":{"line":1716}}},"init":{"type":"Literal","value":"DELETE FROM user_roles WHERE user_id IN (SELECT id FROM users WHERE username \u003d ?);","raw":"DELETE FROM user_roles WHERE user_id IN (SELECT id FROM users WHERE username \u003d ?);","loc":{"start":{"line":1751},"end":{"line":1751}}},"loc":{"start":{"line":1702},"end":{"line":1723}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"DELETE_USER","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1855},"end":{"line":1855}}}},"modifiers":{"type":"Modifiers","modifiers":["private","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":1855},"end":{"line":1855}}},"init":{"type":"Literal","value":"DELETE FROM users WHERE username \u003d ?;","raw":"DELETE FROM users WHERE username \u003d ?;","loc":{"start":{"line":1876},"end":{"line":1876}}},"loc":{"start":{"line":1841},"end":{"line":1862}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"\u003cinit\u003e"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"createDefaultTables","loc":{"start":{"line":2014},"end":{"line":2014}}},"arguments":[],"loc":{"start":{"line":2014},"end":{"line":2033}}},"loc":{"start":{"line":2014},"end":{"line":2014}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"LESS_THAN_EQUAL","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getTableCount","loc":{"start":{"line":2049},"end":{"line":2049}}},"arguments":[{"type":"Literal","value":"users","raw":"users","loc":{"start":{"line":2063},"end":{"line":2063}}}],"loc":{"start":{"line":2049},"end":{"line":2062}}},"right":{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":2075},"end":{"line":2075}}},"loc":{"start":{"line":2049},"end":{"line":2072}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"createDefaultUsers","loc":{"start":{"line":2092},"end":{"line":2092}}},"arguments":[],"loc":{"start":{"line":2092},"end":{"line":2110}}},"loc":{"start":{"line":2092},"end":{"line":2092}}}],"loc":{"start":{"line":2078},"end":{"line":2122}}},"loc":{"start":{"line":2045},"end":{"line":2045}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"LESS_THAN_EQUAL","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getTableCount","loc":{"start":{"line":2136},"end":{"line":2136}}},"arguments":[{"type":"Literal","value":"roles","raw":"roles","loc":{"start":{"line":2150},"end":{"line":2150}}}],"loc":{"start":{"line":2136},"end":{"line":2149}}},"right":{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":2162},"end":{"line":2162}}},"loc":{"start":{"line":2136},"end":{"line":2159}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"createDefaultRoles","loc":{"start":{"line":2179},"end":{"line":2179}}},"arguments":[],"loc":{"start":{"line":2179},"end":{"line":2197}}},"loc":{"start":{"line":2179},"end":{"line":2179}}}],"loc":{"start":{"line":2165},"end":{"line":2209}}},"loc":{"start":{"line":2132},"end":{"line":2132}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"LESS_THAN_EQUAL","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getTableCount","loc":{"start":{"line":2223},"end":{"line":2223}}},"arguments":[{"type":"Literal","value":"user_roles","raw":"user_roles","loc":{"start":{"line":2237},"end":{"line":2237}}}],"loc":{"start":{"line":2223},"end":{"line":2236}}},"right":{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":2254},"end":{"line":2254}}},"loc":{"start":{"line":2223},"end":{"line":2251}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"addDefaultRolesToDefaultUsers","loc":{"start":{"line":2271},"end":{"line":2271}}},"arguments":[],"loc":{"start":{"line":2271},"end":{"line":2300}}},"loc":{"start":{"line":2271},"end":{"line":2271}}}],"loc":{"start":{"line":2257},"end":{"line":2312}}},"loc":{"start":{"line":2219},"end":{"line":2219}}}],"loc":{"start":{"line":2004},"end":{"line":2318}}},"code":"\npublic \u003cinit\u003e() {\n    createDefaultTables();\n    if (getTableCount(\"users\") \u003c\u003d 0) {\n        createDefaultUsers();\n    }\n    if (getTableCount(\"roles\") \u003c\u003d 0) {\n        createDefaultRoles();\n    }\n    if (getTableCount(\"user_roles\") \u003c\u003d 0) {\n        addDefaultRolesToDefaultUsers();\n    }\n}","loc":{"start":{"line":1982},"end":{"line":1989}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"open"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"SQLException","loc":{"start":{"line":2654},"end":{"line":2654}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":2684},"end":{"line":2684}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":2684},"end":{"line":2685}}},"arguments":[],"loc":{"start":{"line":2684},"end":{"line":2701}}},"loc":{"start":{"line":2684},"end":{"line":2684}}},{"type":"ReturnStatement","argument":{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":2724},"end":{"line":2724}}},"loc":{"start":{"line":2717},"end":{"line":2717}}}],"loc":{"start":{"line":2670},"end":{"line":2739}}},"loc":{"start":{"line":2647},"end":{"line":2647}}},{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"ClassNotFoundException","loc":{"start":{"line":2748},"end":{"line":2748}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":2788},"end":{"line":2788}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":2788},"end":{"line":2789}}},"arguments":[],"loc":{"start":{"line":2788},"end":{"line":2805}}},"loc":{"start":{"line":2788},"end":{"line":2788}}},{"type":"ReturnStatement","argument":{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":2828},"end":{"line":2828}}},"loc":{"start":{"line":2821},"end":{"line":2821}}}],"loc":{"start":{"line":2774},"end":{"line":2843}}},"loc":{"start":{"line":2741},"end":{"line":2741}}}],"block":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"userDB","loc":{"start":{"line":2448},"end":{"line":2448}}},"right":{"type":"Literal","loc":{"start":{"line":2458},"end":{"line":2458}}},"loc":{"start":{"line":2448},"end":{"line":2455}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"userDB","loc":{"start":{"line":2466},"end":{"line":2466}}},"property":{"type":"Identifier","name":"isClosed"},"loc":{"start":{"line":2466},"end":{"line":2472}}},"arguments":[],"loc":{"start":{"line":2466},"end":{"line":2481}}},"loc":{"start":{"line":2448},"end":{"line":2463}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Class","loc":{"start":{"line":2503},"end":{"line":2503}}},"property":{"type":"Identifier","name":"forName"},"loc":{"start":{"line":2503},"end":{"line":2508}}},"arguments":[{"type":"Literal","value":"org.h2.Driver","raw":"org.h2.Driver","loc":{"start":{"line":2517},"end":{"line":2517}}}],"loc":{"start":{"line":2503},"end":{"line":2516}}},"loc":{"start":{"line":2503},"end":{"line":2503}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"userDB","loc":{"start":{"line":2551},"end":{"line":2551}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"DriverManager","loc":{"start":{"line":2560},"end":{"line":2560}}},"property":{"type":"Identifier","name":"getConnection"},"loc":{"start":{"line":2560},"end":{"line":2573}}},"arguments":[{"type":"Identifier","name":"USER_DB_URI","loc":{"start":{"line":2588},"end":{"line":2588}}},{"type":"Literal","value":"webgoat_admin","raw":"webgoat_admin","loc":{"start":{"line":2601},"end":{"line":2601}}},{"type":"Literal","value":"","raw":"","loc":{"start":{"line":2618},"end":{"line":2618}}}],"loc":{"start":{"line":2560},"end":{"line":2587}}},"loc":{"start":{"line":2551},"end":{"line":2558}}},"loc":{"start":{"line":2551},"end":{"line":2551}}}],"loc":{"start":{"line":2485},"end":{"line":2635}}},"loc":{"start":{"line":2444},"end":{"line":2444}}}],"loc":{"start":{"line":2430},"end":{"line":2645}}},"loc":{"start":{"line":2426},"end":{"line":2843}}},{"type":"ReturnStatement","argument":{"type":"Literal","value":1,"raw":1,"loc":{"start":{"line":2860},"end":{"line":2860}}},"loc":{"start":{"line":2853},"end":{"line":2853}}}],"loc":{"start":{"line":2416},"end":{"line":2870}}},"code":"\npublic boolean open() {\n    try {\n        if (userDB \u003d\u003d null || userDB.isClosed()) {\n            Class.forName(\"org.h2.Driver\");\n            userDB \u003d DriverManager.getConnection(USER_DB_URI, \"webgoat_admin\", \"\");\n        }\n    } catch (SQLException e) {\n        e.printStackTrace();\n        return false;\n    } catch (ClassNotFoundException e) {\n        e.printStackTrace();\n        return false;\n    }\n    return true;\n}","loc":{"start":{"line":2394},"end":{"line":2409}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"close"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"SQLException","loc":{"start":{"line":3089},"end":{"line":3089}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":3119},"end":{"line":3119}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":3119},"end":{"line":3120}}},"arguments":[],"loc":{"start":{"line":3119},"end":{"line":3136}}},"loc":{"start":{"line":3119},"end":{"line":3119}}},{"type":"ReturnStatement","argument":{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":3159},"end":{"line":3159}}},"loc":{"start":{"line":3152},"end":{"line":3152}}}],"loc":{"start":{"line":3105},"end":{"line":3174}}},"loc":{"start":{"line":3082},"end":{"line":3082}}}],"block":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"userDB","loc":{"start":{"line":3002},"end":{"line":3002}}},"right":{"type":"Literal","loc":{"start":{"line":3012},"end":{"line":3012}}},"loc":{"start":{"line":3002},"end":{"line":3009}}},"right":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"userDB","loc":{"start":{"line":3021},"end":{"line":3021}}},"property":{"type":"Identifier","name":"isClosed"},"loc":{"start":{"line":3021},"end":{"line":3027}}},"arguments":[],"loc":{"start":{"line":3021},"end":{"line":3036}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":3020},"end":{"line":3020}}},"loc":{"start":{"line":3002},"end":{"line":3017}}},"consequent":{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"userDB","loc":{"start":{"line":3056},"end":{"line":3056}}},"property":{"type":"Identifier","name":"close"},"loc":{"start":{"line":3056},"end":{"line":3062}}},"arguments":[],"loc":{"start":{"line":3056},"end":{"line":3068}}},"loc":{"start":{"line":3056},"end":{"line":3056}}},"loc":{"start":{"line":2998},"end":{"line":2998}}}],"loc":{"start":{"line":2984},"end":{"line":3080}}},"loc":{"start":{"line":2980},"end":{"line":3174}}},{"type":"ReturnStatement","argument":{"type":"Literal","value":1,"raw":1,"loc":{"start":{"line":3191},"end":{"line":3191}}},"loc":{"start":{"line":3184},"end":{"line":3184}}}],"loc":{"start":{"line":2970},"end":{"line":3201}}},"code":"\npublic boolean close() {\n    try {\n        if (userDB !\u003d null \u0026\u0026 !userDB.isClosed()) userDB.close();\n    } catch (SQLException e) {\n        e.printStackTrace();\n        return false;\n    }\n    return true;\n}","loc":{"start":{"line":2947},"end":{"line":2962}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getTableCount"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"tableName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":3366},"end":{"line":3366}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"count","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":3406},"end":{"line":3406}}},"loc":{"start":{"line":3394},"end":{"line":3398}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"SQLException","loc":{"start":{"line":3817},"end":{"line":3817}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":3847},"end":{"line":3847}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":3847},"end":{"line":3848}}},"arguments":[],"loc":{"start":{"line":3847},"end":{"line":3864}}},"loc":{"start":{"line":3847},"end":{"line":3847}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"count","loc":{"start":{"line":3880},"end":{"line":3880}}},"right":{"type":"Literal","value":-1,"raw":-1,"loc":{"start":{"line":3888},"end":{"line":3888}}},"loc":{"start":{"line":3880},"end":{"line":3886}}},"loc":{"start":{"line":3880},"end":{"line":3880}}}],"loc":{"start":{"line":3833},"end":{"line":3900}}},"loc":{"start":{"line":3810},"end":{"line":3810}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"open","loc":{"start":{"line":3435},"end":{"line":3435}}},"arguments":[],"loc":{"start":{"line":3435},"end":{"line":3439}}},"loc":{"start":{"line":3435},"end":{"line":3435}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"statement","vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":3455},"end":{"line":3455}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":3455},"end":{"line":3455}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"userDB","loc":{"start":{"line":3477},"end":{"line":3477}}},"property":{"type":"Identifier","name":"createStatement"},"loc":{"start":{"line":3477},"end":{"line":3483}}},"arguments":[],"loc":{"start":{"line":3477},"end":{"line":3499}}},"loc":{"start":{"line":3455},"end":{"line":3465}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"countResult","vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":3515},"end":{"line":3515}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":3515},"end":{"line":3515}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":3539},"end":{"line":3539}}},"property":{"type":"Identifier","name":"executeQuery"},"loc":{"start":{"line":3539},"end":{"line":3548}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"QUERY_TABLE_COUNT","loc":{"start":{"line":3562},"end":{"line":3562}}},"property":{"type":"Identifier","name":"replace"},"loc":{"start":{"line":3562},"end":{"line":3579}}},"arguments":[{"type":"Literal","value":"table","raw":"table","loc":{"start":{"line":3588},"end":{"line":3588}}},{"type":"Identifier","name":"tableName","loc":{"start":{"line":3597},"end":{"line":3597}}}],"loc":{"start":{"line":3562},"end":{"line":3587}}}],"loc":{"start":{"line":3539},"end":{"line":3561}}},"loc":{"start":{"line":3515},"end":{"line":3525}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"countResult","loc":{"start":{"line":3626},"end":{"line":3626}}},"property":{"type":"Identifier","name":"next"},"loc":{"start":{"line":3626},"end":{"line":3637}}},"arguments":[],"loc":{"start":{"line":3626},"end":{"line":3642}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"count","loc":{"start":{"line":3664},"end":{"line":3664}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"countResult","loc":{"start":{"line":3672},"end":{"line":3672}}},"property":{"type":"Identifier","name":"getInt"},"loc":{"start":{"line":3672},"end":{"line":3683}}},"arguments":[{"type":"Literal","value":"count","raw":"count","loc":{"start":{"line":3691},"end":{"line":3691}}}],"loc":{"start":{"line":3672},"end":{"line":3690}}},"loc":{"start":{"line":3664},"end":{"line":3670}}},"loc":{"start":{"line":3664},"end":{"line":3664}}}],"loc":{"start":{"line":3646},"end":{"line":3713}}},"loc":{"start":{"line":3622},"end":{"line":3622}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"countResult","loc":{"start":{"line":3727},"end":{"line":3727}}},"property":{"type":"Identifier","name":"close"},"loc":{"start":{"line":3727},"end":{"line":3738}}},"arguments":[],"loc":{"start":{"line":3727},"end":{"line":3744}}},"loc":{"start":{"line":3727},"end":{"line":3727}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":3760},"end":{"line":3760}}},"property":{"type":"Identifier","name":"close"},"loc":{"start":{"line":3760},"end":{"line":3769}}},"arguments":[],"loc":{"start":{"line":3760},"end":{"line":3775}}},"loc":{"start":{"line":3760},"end":{"line":3760}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"close","loc":{"start":{"line":3791},"end":{"line":3791}}},"arguments":[],"loc":{"start":{"line":3791},"end":{"line":3796}}},"loc":{"start":{"line":3791},"end":{"line":3791}}}],"loc":{"start":{"line":3421},"end":{"line":3808}}},"loc":{"start":{"line":3417},"end":{"line":3900}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"count","loc":{"start":{"line":3917},"end":{"line":3917}}},"loc":{"start":{"line":3910},"end":{"line":3910}}}],"loc":{"start":{"line":3384},"end":{"line":3928}}},"code":"\npublic int getTableCount(String tableName) {\n    int count \u003d 0;\n    try {\n        open();\n        Statement statement \u003d userDB.createStatement();\n        ResultSet countResult \u003d statement.executeQuery(QUERY_TABLE_COUNT.replace(\"table\", tableName));\n        if (countResult.next()) {\n            count \u003d countResult.getInt(\"count\");\n        }\n        countResult.close();\n        statement.close();\n        close();\n    } catch (SQLException e) {\n        e.printStackTrace();\n        count \u003d -1;\n    }\n    return count;\n}","loc":{"start":{"line":3341},"end":{"line":3352}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getUsers"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"Iterator","loc":{"start":{"line":4041},"end":{"line":4041}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"users","vartype":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":4077},"end":{"line":4077}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":4077},"end":{"line":4077}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":4105},"end":{"line":4105}}},"arguments":[],"loc":{"start":{"line":4101},"end":{"line":4101}}},"loc":{"start":{"line":4077},"end":{"line":4093}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"currentUser","vartype":{"type":"Identifier","name":"User","loc":{"start":{"line":4132},"end":{"line":4132}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"User","loc":{"start":{"line":4132},"end":{"line":4132}}},"loc":{"start":{"line":4132},"end":{"line":4137}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"userResults","vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":4158},"end":{"line":4158}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":4158},"end":{"line":4158}}},"loc":{"start":{"line":4158},"end":{"line":4168}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"roleResults","vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":4158},"end":{"line":4158}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":4158},"end":{"line":4158}}},"loc":{"start":{"line":4158},"end":{"line":4181}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"SQLException","loc":{"start":{"line":5001},"end":{"line":5001}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":5031},"end":{"line":5031}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":5031},"end":{"line":5032}}},"arguments":[],"loc":{"start":{"line":5031},"end":{"line":5048}}},"loc":{"start":{"line":5031},"end":{"line":5031}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"users","loc":{"start":{"line":5064},"end":{"line":5064}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":5076},"end":{"line":5076}}},"arguments":[],"loc":{"start":{"line":5072},"end":{"line":5072}}},"loc":{"start":{"line":5064},"end":{"line":5070}}},"loc":{"start":{"line":5064},"end":{"line":5064}}}],"loc":{"start":{"line":5017},"end":{"line":5103}}},"loc":{"start":{"line":4994},"end":{"line":4994}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"open","loc":{"start":{"line":4221},"end":{"line":4221}}},"arguments":[],"loc":{"start":{"line":4221},"end":{"line":4225}}},"loc":{"start":{"line":4221},"end":{"line":4221}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"statement","vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":4241},"end":{"line":4241}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":4241},"end":{"line":4241}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"userDB","loc":{"start":{"line":4263},"end":{"line":4263}}},"property":{"type":"Identifier","name":"createStatement"},"loc":{"start":{"line":4263},"end":{"line":4269}}},"arguments":[],"loc":{"start":{"line":4263},"end":{"line":4285}}},"loc":{"start":{"line":4241},"end":{"line":4251}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"rolesForUsers","vartype":{"type":"Identifier","name":"PreparedStatement","loc":{"start":{"line":4301},"end":{"line":4301}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"PreparedStatement","loc":{"start":{"line":4301},"end":{"line":4301}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"userDB","loc":{"start":{"line":4335},"end":{"line":4335}}},"property":{"type":"Identifier","name":"prepareStatement"},"loc":{"start":{"line":4335},"end":{"line":4341}}},"arguments":[{"type":"Identifier","name":"QUERY_ALL_ROLES_FOR_USERNAME","loc":{"start":{"line":4359},"end":{"line":4359}}}],"loc":{"start":{"line":4335},"end":{"line":4358}}},"loc":{"start":{"line":4301},"end":{"line":4319}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"userResults","loc":{"start":{"line":4403},"end":{"line":4403}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":4417},"end":{"line":4417}}},"property":{"type":"Identifier","name":"executeQuery"},"loc":{"start":{"line":4417},"end":{"line":4426}}},"arguments":[{"type":"Identifier","name":"QUERY_ALL_USERS","loc":{"start":{"line":4440},"end":{"line":4440}}}],"loc":{"start":{"line":4417},"end":{"line":4439}}},"loc":{"start":{"line":4403},"end":{"line":4415}}},"loc":{"start":{"line":4403},"end":{"line":4403}}},{"type":"WhileStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"userResults","loc":{"start":{"line":4477},"end":{"line":4477}}},"property":{"type":"Identifier","name":"next"},"loc":{"start":{"line":4477},"end":{"line":4488}}},"arguments":[],"loc":{"start":{"line":4477},"end":{"line":4493}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"currentUser","loc":{"start":{"line":4515},"end":{"line":4515}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"User","loc":{"start":{"line":4533},"end":{"line":4533}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"userResults","loc":{"start":{"line":4538},"end":{"line":4538}}},"property":{"type":"Identifier","name":"getString"},"loc":{"start":{"line":4538},"end":{"line":4549}}},"arguments":[{"type":"Literal","value":"username","raw":"username","loc":{"start":{"line":4560},"end":{"line":4560}}}],"loc":{"start":{"line":4538},"end":{"line":4559}}}],"loc":{"start":{"line":4529},"end":{"line":4529}}},"loc":{"start":{"line":4515},"end":{"line":4527}}},"loc":{"start":{"line":4515},"end":{"line":4515}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"rolesForUsers","loc":{"start":{"line":4590},"end":{"line":4590}}},"property":{"type":"Identifier","name":"setString"},"loc":{"start":{"line":4590},"end":{"line":4603}}},"arguments":[{"type":"Literal","value":1,"raw":1,"loc":{"start":{"line":4614},"end":{"line":4614}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"currentUser","loc":{"start":{"line":4617},"end":{"line":4617}}},"property":{"type":"Identifier","name":"getUsername"},"loc":{"start":{"line":4617},"end":{"line":4628}}},"arguments":[],"loc":{"start":{"line":4617},"end":{"line":4640}}}],"loc":{"start":{"line":4590},"end":{"line":4613}}},"loc":{"start":{"line":4590},"end":{"line":4590}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"roleResults","loc":{"start":{"line":4661},"end":{"line":4661}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"rolesForUsers","loc":{"start":{"line":4675},"end":{"line":4675}}},"property":{"type":"Identifier","name":"executeQuery"},"loc":{"start":{"line":4675},"end":{"line":4688}}},"arguments":[],"loc":{"start":{"line":4675},"end":{"line":4701}}},"loc":{"start":{"line":4661},"end":{"line":4673}}},"loc":{"start":{"line":4661},"end":{"line":4661}}},{"type":"WhileStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"roleResults","loc":{"start":{"line":4728},"end":{"line":4728}}},"property":{"type":"Identifier","name":"next"},"loc":{"start":{"line":4728},"end":{"line":4739}}},"arguments":[],"loc":{"start":{"line":4728},"end":{"line":4744}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"currentUser","loc":{"start":{"line":4770},"end":{"line":4770}}},"property":{"type":"Identifier","name":"addRole"},"loc":{"start":{"line":4770},"end":{"line":4781}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"roleResults","loc":{"start":{"line":4790},"end":{"line":4790}}},"property":{"type":"Identifier","name":"getString"},"loc":{"start":{"line":4790},"end":{"line":4801}}},"arguments":[{"type":"Literal","value":"rolename","raw":"rolename","loc":{"start":{"line":4812},"end":{"line":4812}}}],"loc":{"start":{"line":4790},"end":{"line":4811}}}],"loc":{"start":{"line":4770},"end":{"line":4789}}},"loc":{"start":{"line":4770},"end":{"line":4770}}}],"loc":{"start":{"line":4748},"end":{"line":4842}}},"loc":{"start":{"line":4721},"end":{"line":4721}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"roleResults","loc":{"start":{"line":4860},"end":{"line":4860}}},"property":{"type":"Identifier","name":"close"},"loc":{"start":{"line":4860},"end":{"line":4871}}},"arguments":[],"loc":{"start":{"line":4860},"end":{"line":4877}}},"loc":{"start":{"line":4860},"end":{"line":4860}}}],"loc":{"start":{"line":4497},"end":{"line":4893}}},"loc":{"start":{"line":4470},"end":{"line":4470}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"rolesForUsers","loc":{"start":{"line":4907},"end":{"line":4907}}},"property":{"type":"Identifier","name":"close"},"loc":{"start":{"line":4907},"end":{"line":4920}}},"arguments":[],"loc":{"start":{"line":4907},"end":{"line":4926}}},"loc":{"start":{"line":4907},"end":{"line":4907}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"userResults","loc":{"start":{"line":4942},"end":{"line":4942}}},"property":{"type":"Identifier","name":"close"},"loc":{"start":{"line":4942},"end":{"line":4953}}},"arguments":[],"loc":{"start":{"line":4942},"end":{"line":4959}}},"loc":{"start":{"line":4942},"end":{"line":4942}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"close","loc":{"start":{"line":4975},"end":{"line":4975}}},"arguments":[],"loc":{"start":{"line":4975},"end":{"line":4980}}},"loc":{"start":{"line":4975},"end":{"line":4975}}}],"loc":{"start":{"line":4207},"end":{"line":4992}}},"loc":{"start":{"line":4203},"end":{"line":5103}}},{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"users","loc":{"start":{"line":5121},"end":{"line":5121}}},"property":{"type":"Identifier","name":"iterator"},"loc":{"start":{"line":5121},"end":{"line":5126}}},"arguments":[],"loc":{"start":{"line":5121},"end":{"line":5135}}},"loc":{"start":{"line":5114},"end":{"line":5114}}}],"loc":{"start":{"line":4067},"end":{"line":5143}}},"code":"\npublic Iterator\u003cUser\u003e getUsers() {\n    ArrayList\u003cUser\u003e users \u003d new ArrayList\u003cUser\u003e();\n    User currentUser;\n    ResultSet userResults;\n    ResultSet roleResults;\n    try {\n        open();\n        Statement statement \u003d userDB.createStatement();\n        PreparedStatement rolesForUsers \u003d userDB.prepareStatement(QUERY_ALL_ROLES_FOR_USERNAME);\n        userResults \u003d statement.executeQuery(QUERY_ALL_USERS);\n        while (userResults.next()) {\n            currentUser \u003d new User(userResults.getString(\"username\"));\n            rolesForUsers.setString(1, currentUser.getUsername());\n            roleResults \u003d rolesForUsers.executeQuery();\n            while (roleResults.next()) {\n                currentUser.addRole(roleResults.getString(\"rolename\"));\n            }\n            roleResults.close();\n        }\n        rolesForUsers.close();\n        userResults.close();\n        close();\n    } catch (SQLException e) {\n        e.printStackTrace();\n        users \u003d new ArrayList\u003cUser\u003e();\n    }\n    return users.iterator();\n}","loc":{"start":{"line":4034},"end":{"line":4056}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"addRoleToUser"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"username","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":5373},"end":{"line":5373}}}},{"type":"Identifier","name":"rolename","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":5390},"end":{"line":5390}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"SQLException","loc":{"start":{"line":5722},"end":{"line":5722}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":5752},"end":{"line":5752}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":5752},"end":{"line":5753}}},"arguments":[],"loc":{"start":{"line":5752},"end":{"line":5769}}},"loc":{"start":{"line":5752},"end":{"line":5752}}},{"type":"ReturnStatement","argument":{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":5792},"end":{"line":5792}}},"loc":{"start":{"line":5785},"end":{"line":5785}}}],"loc":{"start":{"line":5738},"end":{"line":5807}}},"loc":{"start":{"line":5715},"end":{"line":5715}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"open","loc":{"start":{"line":5435},"end":{"line":5435}}},"arguments":[],"loc":{"start":{"line":5435},"end":{"line":5439}}},"loc":{"start":{"line":5435},"end":{"line":5435}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"statement","vartype":{"type":"Identifier","name":"PreparedStatement","loc":{"start":{"line":5455},"end":{"line":5455}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"PreparedStatement","loc":{"start":{"line":5455},"end":{"line":5455}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"userDB","loc":{"start":{"line":5485},"end":{"line":5485}}},"property":{"type":"Identifier","name":"prepareStatement"},"loc":{"start":{"line":5485},"end":{"line":5491}}},"arguments":[{"type":"Identifier","name":"ADD_ROLE_TO_USER","loc":{"start":{"line":5509},"end":{"line":5509}}}],"loc":{"start":{"line":5485},"end":{"line":5508}}},"loc":{"start":{"line":5455},"end":{"line":5473}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":5540},"end":{"line":5540}}},"property":{"type":"Identifier","name":"setString"},"loc":{"start":{"line":5540},"end":{"line":5549}}},"arguments":[{"type":"Literal","value":1,"raw":1,"loc":{"start":{"line":5560},"end":{"line":5560}}},{"type":"Identifier","name":"username","loc":{"start":{"line":5563},"end":{"line":5563}}}],"loc":{"start":{"line":5540},"end":{"line":5559}}},"loc":{"start":{"line":5540},"end":{"line":5540}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":5586},"end":{"line":5586}}},"property":{"type":"Identifier","name":"setString"},"loc":{"start":{"line":5586},"end":{"line":5595}}},"arguments":[{"type":"Literal","value":2,"raw":2,"loc":{"start":{"line":5606},"end":{"line":5606}}},{"type":"Identifier","name":"rolename","loc":{"start":{"line":5609},"end":{"line":5609}}}],"loc":{"start":{"line":5586},"end":{"line":5605}}},"loc":{"start":{"line":5586},"end":{"line":5586}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":5632},"end":{"line":5632}}},"property":{"type":"Identifier","name":"execute"},"loc":{"start":{"line":5632},"end":{"line":5641}}},"arguments":[],"loc":{"start":{"line":5632},"end":{"line":5649}}},"loc":{"start":{"line":5632},"end":{"line":5632}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":5665},"end":{"line":5665}}},"property":{"type":"Identifier","name":"close"},"loc":{"start":{"line":5665},"end":{"line":5674}}},"arguments":[],"loc":{"start":{"line":5665},"end":{"line":5680}}},"loc":{"start":{"line":5665},"end":{"line":5665}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"close","loc":{"start":{"line":5696},"end":{"line":5696}}},"arguments":[],"loc":{"start":{"line":5696},"end":{"line":5701}}},"loc":{"start":{"line":5696},"end":{"line":5696}}}],"loc":{"start":{"line":5421},"end":{"line":5713}}},"loc":{"start":{"line":5417},"end":{"line":5807}}},{"type":"ReturnStatement","argument":{"type":"Literal","value":1,"raw":1,"loc":{"start":{"line":5824},"end":{"line":5824}}},"loc":{"start":{"line":5817},"end":{"line":5817}}}],"loc":{"start":{"line":5407},"end":{"line":5834}}},"code":"\npublic boolean addRoleToUser(String username, String rolename) {\n    try {\n        open();\n        PreparedStatement statement \u003d userDB.prepareStatement(ADD_ROLE_TO_USER);\n        statement.setString(1, username);\n        statement.setString(2, rolename);\n        statement.execute();\n        statement.close();\n        close();\n    } catch (SQLException e) {\n        e.printStackTrace();\n        return false;\n    }\n    return true;\n}","loc":{"start":{"line":5344},"end":{"line":5359}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"removeUser"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"user","vartype":{"type":"Identifier","name":"User","loc":{"start":{"line":6010},"end":{"line":6010}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"removeUser","loc":{"start":{"line":6038},"end":{"line":6038}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"user","loc":{"start":{"line":6049},"end":{"line":6049}}},"property":{"type":"Identifier","name":"getUsername"},"loc":{"start":{"line":6049},"end":{"line":6053}}},"arguments":[],"loc":{"start":{"line":6049},"end":{"line":6065}}}],"loc":{"start":{"line":6038},"end":{"line":6048}}},"loc":{"start":{"line":6031},"end":{"line":6031}}}],"loc":{"start":{"line":6021},"end":{"line":6074}}},"code":"\npublic boolean removeUser(User user) {\n    return removeUser(user.getUsername());\n}","loc":{"start":{"line":5984},"end":{"line":5999}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"removeUser"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"username","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":6240},"end":{"line":6240}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"SQLException","loc":{"start":{"line":6758},"end":{"line":6758}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":6788},"end":{"line":6788}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":6788},"end":{"line":6789}}},"arguments":[],"loc":{"start":{"line":6788},"end":{"line":6805}}},"loc":{"start":{"line":6788},"end":{"line":6788}}},{"type":"ReturnStatement","argument":{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":6828},"end":{"line":6828}}},"loc":{"start":{"line":6821},"end":{"line":6821}}}],"loc":{"start":{"line":6774},"end":{"line":6843}}},"loc":{"start":{"line":6751},"end":{"line":6751}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"open","loc":{"start":{"line":6285},"end":{"line":6285}}},"arguments":[],"loc":{"start":{"line":6285},"end":{"line":6289}}},"loc":{"start":{"line":6285},"end":{"line":6285}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"deleteUserRoles","vartype":{"type":"Identifier","name":"PreparedStatement","loc":{"start":{"line":6306},"end":{"line":6306}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"PreparedStatement","loc":{"start":{"line":6306},"end":{"line":6306}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"userDB","loc":{"start":{"line":6342},"end":{"line":6342}}},"property":{"type":"Identifier","name":"prepareStatement"},"loc":{"start":{"line":6342},"end":{"line":6348}}},"arguments":[{"type":"Identifier","name":"DELETE_ALL_ROLES_FOR_USER","loc":{"start":{"line":6366},"end":{"line":6366}}}],"loc":{"start":{"line":6342},"end":{"line":6365}}},"loc":{"start":{"line":6306},"end":{"line":6324}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"deleteUser","vartype":{"type":"Identifier","name":"PreparedStatement","loc":{"start":{"line":6406},"end":{"line":6406}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"PreparedStatement","loc":{"start":{"line":6406},"end":{"line":6406}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"userDB","loc":{"start":{"line":6437},"end":{"line":6437}}},"property":{"type":"Identifier","name":"prepareStatement"},"loc":{"start":{"line":6437},"end":{"line":6443}}},"arguments":[{"type":"Identifier","name":"DELETE_USER","loc":{"start":{"line":6461},"end":{"line":6461}}}],"loc":{"start":{"line":6437},"end":{"line":6460}}},"loc":{"start":{"line":6406},"end":{"line":6424}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"deleteUserRoles","loc":{"start":{"line":6488},"end":{"line":6488}}},"property":{"type":"Identifier","name":"setString"},"loc":{"start":{"line":6488},"end":{"line":6503}}},"arguments":[{"type":"Literal","value":1,"raw":1,"loc":{"start":{"line":6514},"end":{"line":6514}}},{"type":"Identifier","name":"username","loc":{"start":{"line":6517},"end":{"line":6517}}}],"loc":{"start":{"line":6488},"end":{"line":6513}}},"loc":{"start":{"line":6488},"end":{"line":6488}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"deleteUser","loc":{"start":{"line":6540},"end":{"line":6540}}},"property":{"type":"Identifier","name":"setString"},"loc":{"start":{"line":6540},"end":{"line":6550}}},"arguments":[{"type":"Literal","value":1,"raw":1,"loc":{"start":{"line":6561},"end":{"line":6561}}},{"type":"Identifier","name":"username","loc":{"start":{"line":6564},"end":{"line":6564}}}],"loc":{"start":{"line":6540},"end":{"line":6560}}},"loc":{"start":{"line":6540},"end":{"line":6540}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"deleteUserRoles","loc":{"start":{"line":6588},"end":{"line":6588}}},"property":{"type":"Identifier","name":"execute"},"loc":{"start":{"line":6588},"end":{"line":6603}}},"arguments":[],"loc":{"start":{"line":6588},"end":{"line":6611}}},"loc":{"start":{"line":6588},"end":{"line":6588}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"deleteUser","loc":{"start":{"line":6627},"end":{"line":6627}}},"property":{"type":"Identifier","name":"execute"},"loc":{"start":{"line":6627},"end":{"line":6637}}},"arguments":[],"loc":{"start":{"line":6627},"end":{"line":6645}}},"loc":{"start":{"line":6627},"end":{"line":6627}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"deleteUserRoles","loc":{"start":{"line":6662},"end":{"line":6662}}},"property":{"type":"Identifier","name":"close"},"loc":{"start":{"line":6662},"end":{"line":6677}}},"arguments":[],"loc":{"start":{"line":6662},"end":{"line":6683}}},"loc":{"start":{"line":6662},"end":{"line":6662}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"deleteUser","loc":{"start":{"line":6699},"end":{"line":6699}}},"property":{"type":"Identifier","name":"close"},"loc":{"start":{"line":6699},"end":{"line":6709}}},"arguments":[],"loc":{"start":{"line":6699},"end":{"line":6715}}},"loc":{"start":{"line":6699},"end":{"line":6699}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"close","loc":{"start":{"line":6732},"end":{"line":6732}}},"arguments":[],"loc":{"start":{"line":6732},"end":{"line":6737}}},"loc":{"start":{"line":6732},"end":{"line":6732}}}],"loc":{"start":{"line":6271},"end":{"line":6749}}},"loc":{"start":{"line":6267},"end":{"line":6843}}},{"type":"ReturnStatement","argument":{"type":"Literal","value":1,"raw":1,"loc":{"start":{"line":6860},"end":{"line":6860}}},"loc":{"start":{"line":6853},"end":{"line":6853}}}],"loc":{"start":{"line":6257},"end":{"line":6870}}},"code":"\npublic boolean removeUser(String username) {\n    try {\n        open();\n        PreparedStatement deleteUserRoles \u003d userDB.prepareStatement(DELETE_ALL_ROLES_FOR_USER);\n        PreparedStatement deleteUser \u003d userDB.prepareStatement(DELETE_USER);\n        deleteUserRoles.setString(1, username);\n        deleteUser.setString(1, username);\n        deleteUserRoles.execute();\n        deleteUser.execute();\n        deleteUserRoles.close();\n        deleteUser.close();\n        close();\n    } catch (SQLException e) {\n        e.printStackTrace();\n        return false;\n    }\n    return true;\n}","loc":{"start":{"line":6214},"end":{"line":6229}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"createDefaultTables"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"SQLException","loc":{"start":{"line":7309},"end":{"line":7309}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":7339},"end":{"line":7339}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":7339},"end":{"line":7340}}},"arguments":[],"loc":{"start":{"line":7339},"end":{"line":7356}}},"loc":{"start":{"line":7339},"end":{"line":7339}}},{"type":"ReturnStatement","argument":{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":7379},"end":{"line":7379}}},"loc":{"start":{"line":7372},"end":{"line":7372}}}],"loc":{"start":{"line":7325},"end":{"line":7394}}},"loc":{"start":{"line":7302},"end":{"line":7302}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"open","loc":{"start":{"line":7014},"end":{"line":7014}}},"arguments":[],"loc":{"start":{"line":7014},"end":{"line":7018}}},"loc":{"start":{"line":7014},"end":{"line":7014}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"statement","vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":7034},"end":{"line":7034}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":7034},"end":{"line":7034}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"userDB","loc":{"start":{"line":7056},"end":{"line":7056}}},"property":{"type":"Identifier","name":"createStatement"},"loc":{"start":{"line":7056},"end":{"line":7062}}},"arguments":[],"loc":{"start":{"line":7056},"end":{"line":7078}}},"loc":{"start":{"line":7034},"end":{"line":7044}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":7094},"end":{"line":7094}}},"property":{"type":"Identifier","name":"execute"},"loc":{"start":{"line":7094},"end":{"line":7103}}},"arguments":[{"type":"Identifier","name":"CREATE_USERS_TABLE","loc":{"start":{"line":7112},"end":{"line":7112}}}],"loc":{"start":{"line":7094},"end":{"line":7111}}},"loc":{"start":{"line":7094},"end":{"line":7094}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":7145},"end":{"line":7145}}},"property":{"type":"Identifier","name":"execute"},"loc":{"start":{"line":7145},"end":{"line":7154}}},"arguments":[{"type":"Identifier","name":"CREATE_ROLES_TABLE","loc":{"start":{"line":7163},"end":{"line":7163}}}],"loc":{"start":{"line":7145},"end":{"line":7162}}},"loc":{"start":{"line":7145},"end":{"line":7145}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":7196},"end":{"line":7196}}},"property":{"type":"Identifier","name":"execute"},"loc":{"start":{"line":7196},"end":{"line":7205}}},"arguments":[{"type":"Identifier","name":"CREATE_USER_ROLES_TABLE","loc":{"start":{"line":7214},"end":{"line":7214}}}],"loc":{"start":{"line":7196},"end":{"line":7213}}},"loc":{"start":{"line":7196},"end":{"line":7196}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":7252},"end":{"line":7252}}},"property":{"type":"Identifier","name":"close"},"loc":{"start":{"line":7252},"end":{"line":7261}}},"arguments":[],"loc":{"start":{"line":7252},"end":{"line":7267}}},"loc":{"start":{"line":7252},"end":{"line":7252}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"close","loc":{"start":{"line":7283},"end":{"line":7283}}},"arguments":[],"loc":{"start":{"line":7283},"end":{"line":7288}}},"loc":{"start":{"line":7283},"end":{"line":7283}}}],"loc":{"start":{"line":7000},"end":{"line":7300}}},"loc":{"start":{"line":6996},"end":{"line":7394}}},{"type":"ReturnStatement","argument":{"type":"Literal","value":1,"raw":1,"loc":{"start":{"line":7411},"end":{"line":7411}}},"loc":{"start":{"line":7404},"end":{"line":7404}}}],"loc":{"start":{"line":6986},"end":{"line":7421}}},"code":"\nprivate boolean createDefaultTables() {\n    try {\n        open();\n        Statement statement \u003d userDB.createStatement();\n        statement.execute(CREATE_USERS_TABLE);\n        statement.execute(CREATE_ROLES_TABLE);\n        statement.execute(CREATE_USER_ROLES_TABLE);\n        statement.close();\n        close();\n    } catch (SQLException e) {\n        e.printStackTrace();\n        return false;\n    }\n    return true;\n}","loc":{"start":{"line":6948},"end":{"line":6964}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"createDefaultUsers"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"SQLException","loc":{"start":{"line":7680},"end":{"line":7680}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":7710},"end":{"line":7710}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":7710},"end":{"line":7711}}},"arguments":[],"loc":{"start":{"line":7710},"end":{"line":7727}}},"loc":{"start":{"line":7710},"end":{"line":7710}}},{"type":"ReturnStatement","argument":{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":7750},"end":{"line":7750}}},"loc":{"start":{"line":7743},"end":{"line":7743}}}],"loc":{"start":{"line":7696},"end":{"line":7765}}},"loc":{"start":{"line":7673},"end":{"line":7673}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"open","loc":{"start":{"line":7493},"end":{"line":7493}}},"arguments":[],"loc":{"start":{"line":7493},"end":{"line":7497}}},"loc":{"start":{"line":7493},"end":{"line":7493}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"statement","vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":7513},"end":{"line":7513}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":7513},"end":{"line":7513}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"userDB","loc":{"start":{"line":7535},"end":{"line":7535}}},"property":{"type":"Identifier","name":"createStatement"},"loc":{"start":{"line":7535},"end":{"line":7541}}},"arguments":[],"loc":{"start":{"line":7535},"end":{"line":7557}}},"loc":{"start":{"line":7513},"end":{"line":7523}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":7573},"end":{"line":7573}}},"property":{"type":"Identifier","name":"execute"},"loc":{"start":{"line":7573},"end":{"line":7582}}},"arguments":[{"type":"Identifier","name":"ADD_DEFAULT_USERS","loc":{"start":{"line":7591},"end":{"line":7591}}}],"loc":{"start":{"line":7573},"end":{"line":7590}}},"loc":{"start":{"line":7573},"end":{"line":7573}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":7623},"end":{"line":7623}}},"property":{"type":"Identifier","name":"close"},"loc":{"start":{"line":7623},"end":{"line":7632}}},"arguments":[],"loc":{"start":{"line":7623},"end":{"line":7638}}},"loc":{"start":{"line":7623},"end":{"line":7623}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"close","loc":{"start":{"line":7654},"end":{"line":7654}}},"arguments":[],"loc":{"start":{"line":7654},"end":{"line":7659}}},"loc":{"start":{"line":7654},"end":{"line":7654}}}],"loc":{"start":{"line":7479},"end":{"line":7671}}},"loc":{"start":{"line":7475},"end":{"line":7765}}},{"type":"ReturnStatement","argument":{"type":"Literal","value":1,"raw":1,"loc":{"start":{"line":7782},"end":{"line":7782}}},"loc":{"start":{"line":7775},"end":{"line":7775}}}],"loc":{"start":{"line":7465},"end":{"line":7792}}},"code":"\nprivate boolean createDefaultUsers() {\n    try {\n        open();\n        Statement statement \u003d userDB.createStatement();\n        statement.execute(ADD_DEFAULT_USERS);\n        statement.close();\n        close();\n    } catch (SQLException e) {\n        e.printStackTrace();\n        return false;\n    }\n    return true;\n}","loc":{"start":{"line":7428},"end":{"line":7444}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"createDefaultRoles"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"SQLException","loc":{"start":{"line":8051},"end":{"line":8051}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":8081},"end":{"line":8081}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":8081},"end":{"line":8082}}},"arguments":[],"loc":{"start":{"line":8081},"end":{"line":8098}}},"loc":{"start":{"line":8081},"end":{"line":8081}}},{"type":"ReturnStatement","argument":{"type":"Literal","value":0,"raw":0,"loc":{"start":{"line":8121},"end":{"line":8121}}},"loc":{"start":{"line":8114},"end":{"line":8114}}}],"loc":{"start":{"line":8067},"end":{"line":8136}}},"loc":{"start":{"line":8044},"end":{"line":8044}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"open","loc":{"start":{"line":7864},"end":{"line":7864}}},"arguments":[],"loc":{"start":{"line":7864},"end":{"line":7868}}},"loc":{"start":{"line":7864},"end":{"line":7864}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"statement","vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":7884},"end":{"line":7884}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":7884},"end":{"line":7884}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"userDB","loc":{"start":{"line":7906},"end":{"line":7906}}},"property":{"type":"Identifier","name":"createStatement"},"loc":{"start":{"line":7906},"end":{"line":7912}}},"arguments":[],"loc":{"start":{"line":7906},"end":{"line":7928}}},"loc":{"start":{"line":7884},"end":{"line":7894}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":7944},"end":{"line":7944}}},"property":{"type":"Identifier","name":"execute"},"loc":{"start":{"line":7944},"end":{"line":7953}}},"arguments":[{"type":"Identifier","name":"ADD_DEFAULT_ROLES","loc":{"start":{"line":7962},"end":{"line":7962}}}],"loc":{"start":{"line":7944},"end":{"line":7961}}},"loc":{"start":{"line":7944},"end":{"line":7944}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":7994},"end":{"line":7994}}},"property":{"type":"Identifier","name":"close"},"loc":{"start":{"line":7994},"end":{"line":8003}}},"arguments":[],"loc":{"start":{"line":7994},"end":{"line":8009}}},"loc":{"start":{"line":7994},"end":{"line":7994}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"close","loc":{"start":{"line":8025},"end":{"line":8025}}},"arguments":[],"loc":{"start":{"line":8025},"end":{"line":8030}}},"loc":{"start":{"line":8025},"end":{"line":8025}}}],"loc":{"start":{"line":7850},"end":{"line":8042}}},"loc":{"start":{"line":7846},"end":{"line":8136}}},{"type":"ReturnStatement","argument":{"type":"Literal","value":1,"raw":1,"loc":{"start":{"line":8153},"end":{"line":8153}}},"loc":{"start":{"line":8146},"end":{"line":8146}}}],"loc":{"start":{"line":7836},"end":{"line":8163}}},"code":"\nprivate boolean createDefaultRoles() {\n    try {\n        open();\n        Statement statement \u003d userDB.createStatement();\n        statement.execute(ADD_DEFAULT_ROLES);\n        statement.close();\n        close();\n    } catch (SQLException e) {\n        e.printStackTrace();\n        return false;\n    }\n    return true;\n}","loc":{"start":{"line":7799},"end":{"line":7815}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"addDefaultRolesToDefaultUsers"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"addRoleToUser","loc":{"start":{"line":8225},"end":{"line":8225}}},"arguments":[{"type":"Literal","value":"webgoat","raw":"webgoat","loc":{"start":{"line":8239},"end":{"line":8239}}},{"type":"Literal","value":"webgoat_admin","raw":"webgoat_admin","loc":{"start":{"line":8250},"end":{"line":8250}}}],"loc":{"start":{"line":8225},"end":{"line":8238}}},"loc":{"start":{"line":8225},"end":{"line":8225}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"addRoleToUser","loc":{"start":{"line":8276},"end":{"line":8276}}},"arguments":[{"type":"Literal","value":"basic","raw":"basic","loc":{"start":{"line":8290},"end":{"line":8290}}},{"type":"Literal","value":"webgoat_user","raw":"webgoat_user","loc":{"start":{"line":8299},"end":{"line":8299}}}],"loc":{"start":{"line":8276},"end":{"line":8289}}},"loc":{"start":{"line":8276},"end":{"line":8276}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"addRoleToUser","loc":{"start":{"line":8324},"end":{"line":8324}}},"arguments":[{"type":"Literal","value":"basic","raw":"basic","loc":{"start":{"line":8338},"end":{"line":8338}}},{"type":"Literal","value":"webgoat_basic","raw":"webgoat_basic","loc":{"start":{"line":8347},"end":{"line":8347}}}],"loc":{"start":{"line":8324},"end":{"line":8337}}},"loc":{"start":{"line":8324},"end":{"line":8324}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"addRoleToUser","loc":{"start":{"line":8373},"end":{"line":8373}}},"arguments":[{"type":"Literal","value":"guest","raw":"guest","loc":{"start":{"line":8387},"end":{"line":8387}}},{"type":"Literal","value":"webgoat_user","raw":"webgoat_user","loc":{"start":{"line":8396},"end":{"line":8396}}}],"loc":{"start":{"line":8373},"end":{"line":8386}}},"loc":{"start":{"line":8373},"end":{"line":8373}}}],"loc":{"start":{"line":8215},"end":{"line":8417}}},"code":"\nprivate void addDefaultRolesToDefaultUsers() {\n    addRoleToUser(\"webgoat\", \"webgoat_admin\");\n    addRoleToUser(\"basic\", \"webgoat_user\");\n    addRoleToUser(\"basic\", \"webgoat_basic\");\n    addRoleToUser(\"guest\", \"webgoat_user\");\n}","loc":{"start":{"line":8170},"end":{"line":8183}}}],"loc":{"start":{"line":132},"end":{"line":132}}}],"loc":{"start":{"line":0},"end":{"line":0}}}